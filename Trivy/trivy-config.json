{
  "SchemaVersion": 2,
  "ArtifactName": "/Users/anand/work/Git-Projects/terragoat",
  "ArtifactType": "filesystem",
  "Metadata": {
    "ImageConfig": {
      "architecture": "",
      "created": "0001-01-01T00:00:00Z",
      "os": "",
      "rootfs": {
        "type": "",
        "diff_ids": null
      },
      "config": {}
    }
  },
  "Results": [
    {
      "Target": "terraform/aws/db-app.tf",
      "Class": "config",
      "Type": "terraform",
      "MisconfSummary": {
        "Successes": 2,
        "Failures": 14,
        "Exceptions": 0
      },
      "Misconfigurations": [
        {
          "Type": "Terraform Security Check",
          "ID": "AVD-AWS-0028",
          "Title": "aws_instance should activate session tokens for Instance Metadata Service.",
          "Description": "\nIMDS v2 (Instance Metadata Service) introduced session authentication tokens which improve security when talking to IMDS.\nBy default \u003ccode\u003eaws_instance\u003c/code\u003e resource sets IMDS session auth tokens to be optional. \nTo fully protect IMDS you need to enable session tokens by using \u003ccode\u003emetadata_options\u003c/code\u003e block and its \u003ccode\u003ehttp_tokens\u003c/code\u003e variable set to \u003ccode\u003erequired\u003c/code\u003e.\n",
          "Message": "Instance does not require IMDS access to require a token",
          "Query": "data..",
          "Resolution": "Enable HTTP token requirement for IMDS",
          "Severity": "HIGH",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0028",
          "References": [
            "https://aws.amazon.com/blogs/security/defense-in-depth-open-firewalls-reverse-proxies-ssrf-vulnerabilities-ec2-instance-metadata-service",
            "https://avd.aquasec.com/misconfig/avd-aws-0028"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "aws_instance.db_app",
            "Provider": "AWS",
            "Service": "ec2",
            "StartLine": 242,
            "EndLine": 412,
            "Code": {
              "Lines": [
                {
                  "Number": 242,
                  "Content": "resource \"aws_instance\" \"db_app\" {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 243,
                  "Content": "  # ec2 have plain text secrets in user data",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 244,
                  "Content": "  ami                  = data.aws_ami.amazon-linux-2.id",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 245,
                  "Content": "  instance_type        = \"t2.nano\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 246,
                  "Content": "  iam_instance_profile = aws_iam_instance_profile.ec2profile.name",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 247,
                  "Content": "",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 248,
                  "Content": "  vpc_security_group_ids = [",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 249,
                  "Content": "  \"${aws_security_group.web-node.id}\"]",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 250,
                  "Content": "  subnet_id = \"${aws_subnet.web_subnet.id}\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 251,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "AVD-AWS-0057",
          "Title": "IAM policy should avoid use of wildcards and instead apply the principle of least privilege",
          "Description": "You should use the principle of least privilege when defining your IAM policies. This means you should specify each exact permission required without using wildcards, as this could cause the granting of access to certain undesired actions, resources and principals.",
          "Message": "IAM policy document uses sensitive action 's3:*' on wildcarded resource '*'",
          "Query": "data..",
          "Resolution": "Specify the exact permissions required, and to which resources they should apply instead of using wildcards.",
          "Severity": "HIGH",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0057",
          "References": [
            "https://docs.aws.amazon.com/IAM/latest/UserGuide/best-practices.html",
            "https://avd.aquasec.com/misconfig/avd-aws-0057"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "aws_iam_role_policy.ec2policy",
            "Provider": "AWS",
            "Service": "iam",
            "StartLine": 220,
            "EndLine": 220,
            "Code": {
              "Lines": [
                {
                  "Number": 205,
                  "Content": "resource \"aws_iam_role_policy\" \"ec2policy\" {",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 206,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 220,
                  "Content": "      \"Resource\": \"*\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": true,
                  "LastCause": true
                },
                {
                  "Number": 224,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 225,
                  "Content": "}",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "AVD-AWS-0057",
          "Title": "IAM policy should avoid use of wildcards and instead apply the principle of least privilege",
          "Description": "You should use the principle of least privilege when defining your IAM policies. This means you should specify each exact permission required without using wildcards, as this could cause the granting of access to certain undesired actions, resources and principals.",
          "Message": "IAM policy document uses wildcarded action 's3:*'",
          "Query": "data..",
          "Resolution": "Specify the exact permissions required, and to which resources they should apply instead of using wildcards.",
          "Severity": "HIGH",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0057",
          "References": [
            "https://docs.aws.amazon.com/IAM/latest/UserGuide/best-practices.html",
            "https://avd.aquasec.com/misconfig/avd-aws-0057"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "aws_iam_role_policy.ec2policy",
            "Provider": "AWS",
            "Service": "iam",
            "StartLine": 214,
            "EndLine": 218,
            "Code": {
              "Lines": [
                {
                  "Number": 205,
                  "Content": "resource \"aws_iam_role_policy\" \"ec2policy\" {",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 206,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 214,
                  "Content": "      \"Action\": [",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 215,
                  "Content": "        \"s3:*\",",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 216,
                  "Content": "        \"ec2:*\",",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 217,
                  "Content": "        \"rds:*\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 218,
                  "Content": "      ],",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 224,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 225,
                  "Content": "}",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "AVD-AWS-0057",
          "Title": "IAM policy should avoid use of wildcards and instead apply the principle of least privilege",
          "Description": "You should use the principle of least privilege when defining your IAM policies. This means you should specify each exact permission required without using wildcards, as this could cause the granting of access to certain undesired actions, resources and principals.",
          "Message": "IAM policy document uses wildcarded action 's3:*'",
          "Query": "data..",
          "Resolution": "Specify the exact permissions required, and to which resources they should apply instead of using wildcards.",
          "Severity": "HIGH",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0057",
          "References": [
            "https://docs.aws.amazon.com/IAM/latest/UserGuide/best-practices.html",
            "https://avd.aquasec.com/misconfig/avd-aws-0057"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "aws_iam_role_policy.ec2policy",
            "Provider": "AWS",
            "Service": "iam",
            "StartLine": 214,
            "EndLine": 218,
            "Code": {
              "Lines": [
                {
                  "Number": 205,
                  "Content": "resource \"aws_iam_role_policy\" \"ec2policy\" {",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 206,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 214,
                  "Content": "      \"Action\": [",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 215,
                  "Content": "        \"s3:*\",",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 216,
                  "Content": "        \"ec2:*\",",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 217,
                  "Content": "        \"rds:*\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 218,
                  "Content": "      ],",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 224,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 225,
                  "Content": "}",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "AVD-AWS-0057",
          "Title": "IAM policy should avoid use of wildcards and instead apply the principle of least privilege",
          "Description": "You should use the principle of least privilege when defining your IAM policies. This means you should specify each exact permission required without using wildcards, as this could cause the granting of access to certain undesired actions, resources and principals.",
          "Message": "IAM policy document uses wildcarded action 's3:*'",
          "Query": "data..",
          "Resolution": "Specify the exact permissions required, and to which resources they should apply instead of using wildcards.",
          "Severity": "HIGH",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0057",
          "References": [
            "https://docs.aws.amazon.com/IAM/latest/UserGuide/best-practices.html",
            "https://avd.aquasec.com/misconfig/avd-aws-0057"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "aws_iam_role_policy.ec2policy",
            "Provider": "AWS",
            "Service": "iam",
            "StartLine": 214,
            "EndLine": 218,
            "Code": {
              "Lines": [
                {
                  "Number": 205,
                  "Content": "resource \"aws_iam_role_policy\" \"ec2policy\" {",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 206,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 214,
                  "Content": "      \"Action\": [",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 215,
                  "Content": "        \"s3:*\",",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 216,
                  "Content": "        \"ec2:*\",",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 217,
                  "Content": "        \"rds:*\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 218,
                  "Content": "      ],",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 224,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 225,
                  "Content": "}",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "AVD-AWS-0077",
          "Title": "RDS Cluster and RDS instance should have backup retention longer than default 1 day",
          "Description": "RDS backup retention for clusters defaults to 1 day, this may not be enough to identify and respond to an issue. Backup retention periods should be set to a period that is a balance on cost and limiting risk.",
          "Message": "Instance has very low backup retention period.",
          "Query": "data..",
          "Resolution": "Explicitly set the retention period to greater than the default",
          "Severity": "MEDIUM",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0077",
          "References": [
            "https://docs.aws.amazon.com/AmazonRDS/latest/UserGuide/USER_WorkingWithAutomatedBackups.html#USER_WorkingWithAutomatedBackups.BackupRetention",
            "https://avd.aquasec.com/misconfig/avd-aws-0077"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "aws_db_instance.default",
            "Provider": "AWS",
            "Service": "rds",
            "StartLine": 17,
            "EndLine": 17,
            "Code": {
              "Lines": [
                {
                  "Number": 1,
                  "Content": "resource \"aws_db_instance\" \"default\" {",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 2,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 17,
                  "Content": "  backup_retention_period = 0",
                  "IsCause": true,
                  "Annotation": "0",
                  "Truncated": false,
                  "FirstCause": true,
                  "LastCause": true
                },
                {
                  "Number": 40,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 41,
                  "Content": "}",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "AVD-AWS-0080",
          "Title": "RDS encryption has not been enabled at a DB Instance level.",
          "Description": "Encryption should be enabled for an RDS Database instances. \n\nWhen enabling encryption by setting the kms_key_id.",
          "Message": "Instance does not have storage encryption enabled.",
          "Query": "data..",
          "Resolution": "Enable encryption for RDS instances",
          "Severity": "HIGH",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0080",
          "References": [
            "https://docs.aws.amazon.com/AmazonRDS/latest/UserGuide/Overview.Encryption.html",
            "https://avd.aquasec.com/misconfig/avd-aws-0080"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "aws_db_instance.default",
            "Provider": "AWS",
            "Service": "rds",
            "StartLine": 18,
            "EndLine": 18,
            "Code": {
              "Lines": [
                {
                  "Number": 1,
                  "Content": "resource \"aws_db_instance\" \"default\" {",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 2,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 18,
                  "Content": "  storage_encrypted       = false",
                  "IsCause": true,
                  "Annotation": "false",
                  "Truncated": false,
                  "FirstCause": true,
                  "LastCause": true
                },
                {
                  "Number": 40,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 41,
                  "Content": "}",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "AVD-AWS-0082",
          "Title": "A database resource is marked as publicly accessible.",
          "Description": "Database resources should not publicly available. You should limit all access to the minimum that is required for your application to function.",
          "Message": "Instance is exposed publicly.",
          "Query": "data..",
          "Resolution": "Set the database to not be publicly accessible",
          "Severity": "CRITICAL",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0082",
          "References": [
            "https://docs.aws.amazon.com/AmazonRDS/latest/UserGuide/USER_VPC.WorkingWithRDSInstanceinaVPC.html#USER_VPC.Hiding",
            "https://avd.aquasec.com/misconfig/avd-aws-0082"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "aws_db_instance.default",
            "Provider": "AWS",
            "Service": "rds",
            "StartLine": 21,
            "EndLine": 21,
            "Code": {
              "Lines": [
                {
                  "Number": 1,
                  "Content": "resource \"aws_db_instance\" \"default\" {",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 2,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 21,
                  "Content": "  publicly_accessible     = true",
                  "IsCause": true,
                  "Annotation": "true",
                  "Truncated": false,
                  "FirstCause": true,
                  "LastCause": true
                },
                {
                  "Number": 40,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 41,
                  "Content": "}",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "AVD-AWS-0099",
          "Title": "Missing description for security group.",
          "Description": "Security groups should include a description for auditing purposes.\n\nSimplifies auditing, debugging, and managing security groups.",
          "Message": "Security group explicitly uses the default description.",
          "Query": "data..",
          "Resolution": "Add descriptions for all security groups",
          "Severity": "LOW",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0099",
          "References": [
            "https://www.cloudconformity.com/knowledge-base/aws/EC2/security-group-rules-description.html",
            "https://avd.aquasec.com/misconfig/avd-aws-0099"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "aws_security_group.default",
            "Provider": "AWS",
            "Service": "vpc",
            "StartLine": 116,
            "EndLine": 133,
            "Code": {
              "Lines": [
                {
                  "Number": 116,
                  "Content": "resource \"aws_security_group\" \"default\" {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 117,
                  "Content": "  name   = \"${local.resource_prefix.value}-rds-sg\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 118,
                  "Content": "  vpc_id = aws_vpc.web_vpc.id",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 119,
                  "Content": "",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 120,
                  "Content": "  tags = merge({",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 121,
                  "Content": "    Name        = \"${local.resource_prefix.value}-rds-sg\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 122,
                  "Content": "    Environment = local.resource_prefix.value",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 123,
                  "Content": "    }, {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 124,
                  "Content": "    git_commit           = \"d68d2897add9bc2203a5ed0632a5cdd8ff8cefb0\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 125,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "AVD-AWS-0104",
          "Title": "An egress security group rule allows traffic to /0.",
          "Description": "Opening up ports to connect out to the public internet is generally to be avoided. You should restrict access to IP addresses or ranges that are explicitly required where possible.",
          "Message": "Security group rule allows egress to multiple public internet addresses.",
          "Query": "data..",
          "Resolution": "Set a more restrictive cidr range",
          "Severity": "CRITICAL",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0104",
          "References": [
            "https://docs.aws.amazon.com/whitepapers/latest/building-scalable-secure-multi-vpc-network-infrastructure/centralized-egress-to-internet.html",
            "https://avd.aquasec.com/misconfig/avd-aws-0104"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "aws_security_group_rule.egress",
            "Provider": "AWS",
            "Service": "vpc",
            "StartLine": 149,
            "EndLine": 149,
            "Code": {
              "Lines": [
                {
                  "Number": 144,
                  "Content": "resource \"aws_security_group_rule\" \"egress\" {",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 145,
                  "Content": "  type              = \"egress\"",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 146,
                  "Content": "  from_port         = 0",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 147,
                  "Content": "  to_port           = 0",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 148,
                  "Content": "  protocol          = \"-1\"",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 149,
                  "Content": "  cidr_blocks       = [\"0.0.0.0/0\"]",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": true,
                  "LastCause": true
                },
                {
                  "Number": 150,
                  "Content": "  security_group_id = \"${aws_security_group.default.id}\"",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 151,
                  "Content": "}",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "AVD-AWS-0124",
          "Title": "Missing description for security group rule.",
          "Description": "Security group rules should include a description for auditing purposes.\n\nSimplifies auditing, debugging, and managing security groups.",
          "Message": "Security group rule does not have a description.",
          "Query": "data..",
          "Resolution": "Add descriptions for all security groups rules",
          "Severity": "LOW",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0124",
          "References": [
            "https://www.cloudconformity.com/knowledge-base/aws/EC2/security-group-rules-description.html",
            "https://avd.aquasec.com/misconfig/avd-aws-0124"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "aws_security_group_rule.egress",
            "Provider": "AWS",
            "Service": "vpc",
            "StartLine": 144,
            "EndLine": 151,
            "Code": {
              "Lines": [
                {
                  "Number": 144,
                  "Content": "resource \"aws_security_group_rule\" \"egress\" {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 145,
                  "Content": "  type              = \"egress\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 146,
                  "Content": "  from_port         = 0",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 147,
                  "Content": "  to_port           = 0",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 148,
                  "Content": "  protocol          = \"-1\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 149,
                  "Content": "  cidr_blocks       = [\"0.0.0.0/0\"]",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 150,
                  "Content": "  security_group_id = \"${aws_security_group.default.id}\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 151,
                  "Content": "}",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": true
                }
              ]
            }
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "AVD-AWS-0124",
          "Title": "Missing description for security group rule.",
          "Description": "Security group rules should include a description for auditing purposes.\n\nSimplifies auditing, debugging, and managing security groups.",
          "Message": "Security group rule does not have a description.",
          "Query": "data..",
          "Resolution": "Add descriptions for all security groups rules",
          "Severity": "LOW",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0124",
          "References": [
            "https://www.cloudconformity.com/knowledge-base/aws/EC2/security-group-rules-description.html",
            "https://avd.aquasec.com/misconfig/avd-aws-0124"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "aws_security_group_rule.ingress",
            "Provider": "AWS",
            "Service": "vpc",
            "StartLine": 135,
            "EndLine": 142,
            "Code": {
              "Lines": [
                {
                  "Number": 135,
                  "Content": "resource \"aws_security_group_rule\" \"ingress\" {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 136,
                  "Content": "  type              = \"ingress\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 137,
                  "Content": "  from_port         = \"3306\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 138,
                  "Content": "  to_port           = \"3306\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 139,
                  "Content": "  protocol          = \"tcp\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 140,
                  "Content": "  cidr_blocks       = [\"${aws_vpc.web_vpc.cidr_block}\"]",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 141,
                  "Content": "  security_group_id = aws_security_group.default.id",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 142,
                  "Content": "}",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": true
                }
              ]
            }
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "AVD-AWS-0131",
          "Title": "Instance with unencrypted block device.",
          "Description": "Block devices should be encrypted to ensure sensitive data is held securely at rest.",
          "Message": "Root block device is not encrypted.",
          "Query": "data..",
          "Resolution": "Turn on encryption for all block devices",
          "Severity": "HIGH",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0131",
          "References": [
            "https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/RootDeviceStorage.html",
            "https://avd.aquasec.com/misconfig/avd-aws-0131"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "aws_instance.db_app",
            "Provider": "AWS",
            "Service": "ec2",
            "StartLine": 242,
            "EndLine": 412,
            "Code": {
              "Lines": [
                {
                  "Number": 242,
                  "Content": "resource \"aws_instance\" \"db_app\" {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 243,
                  "Content": "  # ec2 have plain text secrets in user data",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 244,
                  "Content": "  ami                  = data.aws_ami.amazon-linux-2.id",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 245,
                  "Content": "  instance_type        = \"t2.nano\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 246,
                  "Content": "  iam_instance_profile = aws_iam_instance_profile.ec2profile.name",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 247,
                  "Content": "",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 248,
                  "Content": "  vpc_security_group_ids = [",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 249,
                  "Content": "  \"${aws_security_group.web-node.id}\"]",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 250,
                  "Content": "  subnet_id = \"${aws_subnet.web_subnet.id}\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 251,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "AVD-AWS-0133",
          "Title": "Enable Performance Insights to detect potential problems",
          "Description": "Enabling Performance insights allows for greater depth in monitoring data.\n\t\t\nFor example, information about active sessions could help diagose a compromise or assist in the investigation",
          "Message": "Instance does not have performance insights enabled.",
          "Query": "data..",
          "Resolution": "Enable performance insights",
          "Severity": "LOW",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0133",
          "References": [
            "https://aws.amazon.com/rds/performance-insights/",
            "https://avd.aquasec.com/misconfig/avd-aws-0133"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "aws_db_instance.default",
            "Provider": "AWS",
            "Service": "rds",
            "StartLine": 1,
            "EndLine": 41,
            "Code": {
              "Lines": [
                {
                  "Number": 1,
                  "Content": "resource \"aws_db_instance\" \"default\" {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 2,
                  "Content": "  name                   = var.dbname",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 3,
                  "Content": "  engine                 = \"mysql\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 4,
                  "Content": "  option_group_name      = aws_db_option_group.default.name",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 5,
                  "Content": "  parameter_group_name   = aws_db_parameter_group.default.name",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 6,
                  "Content": "  db_subnet_group_name   = aws_db_subnet_group.default.name",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 7,
                  "Content": "  vpc_security_group_ids = [\"${aws_security_group.default.id}\"]",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 8,
                  "Content": "",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 9,
                  "Content": "  identifier              = \"rds-${local.resource_prefix.value}\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 10,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        }
      ]
    },
    {
      "Target": "terraform/aws/ec2.tf",
      "Class": "config",
      "Type": "terraform",
      "MisconfSummary": {
        "Successes": 2,
        "Failures": 20,
        "Exceptions": 0
      },
      "Misconfigurations": [
        {
          "Type": "Terraform Security Check",
          "ID": "AVD-AWS-0026",
          "Title": "EBS volumes must be encrypted",
          "Description": "By enabling encryption on EBS volumes you protect the volume, the disk I/O and any derived snapshots from compromise if intercepted.",
          "Message": "EBS volume is not encrypted.",
          "Query": "data..",
          "Resolution": "Enable encryption of EBS volumes",
          "Severity": "HIGH",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0026",
          "References": [
            "https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/EBSEncryption.html",
            "https://avd.aquasec.com/misconfig/avd-aws-0026"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "aws_ebs_volume.web_host_storage",
            "Provider": "AWS",
            "Service": "ebs",
            "StartLine": 34,
            "EndLine": 51,
            "Code": {
              "Lines": [
                {
                  "Number": 34,
                  "Content": "resource \"aws_ebs_volume\" \"web_host_storage\" {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 35,
                  "Content": "  # unencrypted volume",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 36,
                  "Content": "  availability_zone = \"${var.region}a\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 37,
                  "Content": "  #encrypted         = false  # Setting this causes the volume to be recreated on apply ",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 38,
                  "Content": "  size = 1",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 39,
                  "Content": "  tags = merge({",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 40,
                  "Content": "    Name = \"${local.resource_prefix.value}-ebs\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 41,
                  "Content": "    }, {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 42,
                  "Content": "    git_commit           = \"d3439f0f2af62f6fa3521e14d6c27819ef8f12e1\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 43,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "AVD-AWS-0027",
          "Title": "EBS volume encryption should use Customer Managed Keys",
          "Description": "Encryption using AWS keys provides protection for your EBS volume. To increase control of the encryption and manage factors like rotation use customer managed keys.",
          "Message": "EBS volume does not use a customer-managed KMS key.",
          "Query": "data..",
          "Resolution": "Enable encryption using customer managed keys",
          "Severity": "LOW",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0027",
          "References": [
            "https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/EBSEncryption.html",
            "https://avd.aquasec.com/misconfig/avd-aws-0027"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "aws_ebs_volume.web_host_storage",
            "Provider": "AWS",
            "Service": "ebs",
            "StartLine": 34,
            "EndLine": 51,
            "Code": {
              "Lines": [
                {
                  "Number": 34,
                  "Content": "resource \"aws_ebs_volume\" \"web_host_storage\" {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 35,
                  "Content": "  # unencrypted volume",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 36,
                  "Content": "  availability_zone = \"${var.region}a\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 37,
                  "Content": "  #encrypted         = false  # Setting this causes the volume to be recreated on apply ",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 38,
                  "Content": "  size = 1",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 39,
                  "Content": "  tags = merge({",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 40,
                  "Content": "    Name = \"${local.resource_prefix.value}-ebs\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 41,
                  "Content": "    }, {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 42,
                  "Content": "    git_commit           = \"d3439f0f2af62f6fa3521e14d6c27819ef8f12e1\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 43,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "AVD-AWS-0028",
          "Title": "aws_instance should activate session tokens for Instance Metadata Service.",
          "Description": "\nIMDS v2 (Instance Metadata Service) introduced session authentication tokens which improve security when talking to IMDS.\nBy default \u003ccode\u003eaws_instance\u003c/code\u003e resource sets IMDS session auth tokens to be optional. \nTo fully protect IMDS you need to enable session tokens by using \u003ccode\u003emetadata_options\u003c/code\u003e block and its \u003ccode\u003ehttp_tokens\u003c/code\u003e variable set to \u003ccode\u003erequired\u003c/code\u003e.\n",
          "Message": "Instance does not require IMDS access to require a token",
          "Query": "data..",
          "Resolution": "Enable HTTP token requirement for IMDS",
          "Severity": "HIGH",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0028",
          "References": [
            "https://aws.amazon.com/blogs/security/defense-in-depth-open-firewalls-reverse-proxies-ssrf-vulnerabilities-ec2-instance-metadata-service",
            "https://avd.aquasec.com/misconfig/avd-aws-0028"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "aws_instance.web_host",
            "Provider": "AWS",
            "Service": "ec2",
            "StartLine": 1,
            "EndLine": 32,
            "Code": {
              "Lines": [
                {
                  "Number": 1,
                  "Content": "resource \"aws_instance\" \"web_host\" {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 2,
                  "Content": "  # ec2 have plain text secrets in user data",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 3,
                  "Content": "  ami           = \"${var.ami}\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 4,
                  "Content": "  instance_type = \"t2.nano\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 5,
                  "Content": "",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 6,
                  "Content": "  vpc_security_group_ids = [",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 7,
                  "Content": "  \"${aws_security_group.web-node.id}\"]",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 8,
                  "Content": "  subnet_id = \"${aws_subnet.web_subnet.id}\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 9,
                  "Content": "  user_data = \u003c\u003cEOF",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 10,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "AVD-AWS-0029",
          "Title": "User data for EC2 instances must not contain sensitive AWS keys",
          "Description": "EC2 instance data is used to pass start up information into the EC2 instance. This userdata must not contain access key credentials. Instead use an IAM Instance Profile assigned to the instance to grant access to other AWS Services.",
          "Message": "Sensitive data found in instance user data: Check for AWS Access Key Id",
          "Query": "data..",
          "Resolution": "Remove sensitive data from the EC2 instance user-data",
          "Severity": "CRITICAL",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0029",
          "References": [
            "https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/instancedata-add-user-data.html",
            "https://avd.aquasec.com/misconfig/avd-aws-0029"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "aws_instance.web_host",
            "Provider": "AWS",
            "Service": "ec2",
            "StartLine": 9,
            "EndLine": 19,
            "Code": {
              "Lines": [
                {
                  "Number": 1,
                  "Content": "resource \"aws_instance\" \"web_host\" {",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 2,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 9,
                  "Content": "  user_data = \u003c\u003cEOF",
                  "IsCause": true,
                  "Annotation": "\"#! /bin/bash\\nsudo apt-get update\\nsudo apt-get install -y apache2\\nsudo systemctl start apache2\\nsudo systemctl enable apache2\\nexport AWS_ACCESS_KEY_ID=AKIAIOSFODNN7EXAMAAA\\nexport AWS_SECRET_ACCESS_KEY=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\\nexport AWS_DEFAULT_REGION=us-west-2\\necho \\\"\u003ch1\u003eDeployed via Terraform\u003c/h1\u003e\\\" | sudo tee /var/www/html/index.html\\n\"",
                  "Truncated": false,
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 10,
                  "Content": "#! /bin/bash",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 11,
                  "Content": "sudo apt-get update",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 12,
                  "Content": "sudo apt-get install -y apache2",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 13,
                  "Content": "sudo systemctl start apache2",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 14,
                  "Content": "sudo systemctl enable apache2",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 15,
                  "Content": "export AWS_ACCESS_KEY_ID=AKIAIOSFODNN7EXAMAAA",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 16,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "AVD-AWS-0086",
          "Title": "S3 Access block should block public ACL",
          "Description": "\nS3 buckets should block public ACLs on buckets and any objects they contain. By blocking, PUTs with fail if the object has any public ACL a.\n",
          "Message": "No public access block so not blocking public acls",
          "Query": "data..",
          "Resolution": "Enable blocking any PUT calls with a public ACL specified",
          "Severity": "HIGH",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0086",
          "References": [
            "https://docs.aws.amazon.com/AmazonS3/latest/userguide/access-control-block-public-access.html",
            "https://avd.aquasec.com/misconfig/avd-aws-0086"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "aws_s3_bucket.flowbucket",
            "Provider": "AWS",
            "Service": "s3",
            "StartLine": 271,
            "EndLine": 288,
            "Code": {
              "Lines": [
                {
                  "Number": 271,
                  "Content": "resource \"aws_s3_bucket\" \"flowbucket\" {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 272,
                  "Content": "  bucket        = \"${local.resource_prefix.value}-flowlogs\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 273,
                  "Content": "  force_destroy = true",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 274,
                  "Content": "",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 275,
                  "Content": "  tags = merge({",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 276,
                  "Content": "    Name        = \"${local.resource_prefix.value}-flowlogs\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 277,
                  "Content": "    Environment = local.resource_prefix.value",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 278,
                  "Content": "    }, {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 279,
                  "Content": "    git_commit           = \"d68d2897add9bc2203a5ed0632a5cdd8ff8cefb0\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 280,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "AVD-AWS-0087",
          "Title": "S3 Access block should block public policy",
          "Description": "\nS3 bucket policy should have block public policy to prevent users from putting a policy that enable public access.\n",
          "Message": "No public access block so not blocking public policies",
          "Query": "data..",
          "Resolution": "Prevent policies that allow public access being PUT",
          "Severity": "HIGH",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0087",
          "References": [
            "https://docs.aws.amazon.com/AmazonS3/latest/dev-retired/access-control-block-public-access.html",
            "https://avd.aquasec.com/misconfig/avd-aws-0087"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "aws_s3_bucket.flowbucket",
            "Provider": "AWS",
            "Service": "s3",
            "StartLine": 271,
            "EndLine": 288,
            "Code": {
              "Lines": [
                {
                  "Number": 271,
                  "Content": "resource \"aws_s3_bucket\" \"flowbucket\" {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 272,
                  "Content": "  bucket        = \"${local.resource_prefix.value}-flowlogs\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 273,
                  "Content": "  force_destroy = true",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 274,
                  "Content": "",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 275,
                  "Content": "  tags = merge({",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 276,
                  "Content": "    Name        = \"${local.resource_prefix.value}-flowlogs\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 277,
                  "Content": "    Environment = local.resource_prefix.value",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 278,
                  "Content": "    }, {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 279,
                  "Content": "    git_commit           = \"d68d2897add9bc2203a5ed0632a5cdd8ff8cefb0\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 280,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "AVD-AWS-0088",
          "Title": "Unencrypted S3 bucket.",
          "Description": "S3 Buckets should be encrypted to protect the data that is stored within them if access is compromised.",
          "Message": "Bucket does not have encryption enabled",
          "Query": "data..",
          "Resolution": "Configure bucket encryption",
          "Severity": "HIGH",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0088",
          "References": [
            "https://docs.aws.amazon.com/AmazonS3/latest/userguide/bucket-encryption.html",
            "https://avd.aquasec.com/misconfig/avd-aws-0088"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "aws_s3_bucket.flowbucket",
            "Provider": "AWS",
            "Service": "s3",
            "StartLine": 271,
            "EndLine": 288,
            "Code": {
              "Lines": [
                {
                  "Number": 271,
                  "Content": "resource \"aws_s3_bucket\" \"flowbucket\" {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 272,
                  "Content": "  bucket        = \"${local.resource_prefix.value}-flowlogs\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 273,
                  "Content": "  force_destroy = true",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 274,
                  "Content": "",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 275,
                  "Content": "  tags = merge({",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 276,
                  "Content": "    Name        = \"${local.resource_prefix.value}-flowlogs\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 277,
                  "Content": "    Environment = local.resource_prefix.value",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 278,
                  "Content": "    }, {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 279,
                  "Content": "    git_commit           = \"d68d2897add9bc2203a5ed0632a5cdd8ff8cefb0\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 280,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "AVD-AWS-0089",
          "Title": "S3 Bucket does not have logging enabled.",
          "Description": "Buckets should have logging enabled so that access can be audited.",
          "Message": "Bucket does not have logging enabled",
          "Query": "data..",
          "Resolution": "Add a logging block to the resource to enable access logging",
          "Severity": "MEDIUM",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0089",
          "References": [
            "https://docs.aws.amazon.com/AmazonS3/latest/dev/ServerLogs.html",
            "https://avd.aquasec.com/misconfig/avd-aws-0089"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "aws_s3_bucket.flowbucket",
            "Provider": "AWS",
            "Service": "s3",
            "StartLine": 271,
            "EndLine": 288,
            "Code": {
              "Lines": [
                {
                  "Number": 271,
                  "Content": "resource \"aws_s3_bucket\" \"flowbucket\" {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 272,
                  "Content": "  bucket        = \"${local.resource_prefix.value}-flowlogs\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 273,
                  "Content": "  force_destroy = true",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 274,
                  "Content": "",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 275,
                  "Content": "  tags = merge({",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 276,
                  "Content": "    Name        = \"${local.resource_prefix.value}-flowlogs\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 277,
                  "Content": "    Environment = local.resource_prefix.value",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 278,
                  "Content": "    }, {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 279,
                  "Content": "    git_commit           = \"d68d2897add9bc2203a5ed0632a5cdd8ff8cefb0\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 280,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "AVD-AWS-0090",
          "Title": "S3 Data should be versioned",
          "Description": "\nVersioning in Amazon S3 is a means of keeping multiple variants of an object in the same bucket. \nYou can use the S3 Versioning feature to preserve, retrieve, and restore every version of every object stored in your buckets. \nWith versioning you can recover more easily from both unintended user actions and application failures.\n",
          "Message": "Bucket does not have versioning enabled",
          "Query": "data..",
          "Resolution": "Enable versioning to protect against accidental/malicious removal or modification",
          "Severity": "MEDIUM",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0090",
          "References": [
            "https://docs.aws.amazon.com/AmazonS3/latest/userguide/Versioning.html",
            "https://avd.aquasec.com/misconfig/avd-aws-0090"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "aws_s3_bucket.flowbucket",
            "Provider": "AWS",
            "Service": "s3",
            "StartLine": 271,
            "EndLine": 288,
            "Code": {
              "Lines": [
                {
                  "Number": 271,
                  "Content": "resource \"aws_s3_bucket\" \"flowbucket\" {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 272,
                  "Content": "  bucket        = \"${local.resource_prefix.value}-flowlogs\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 273,
                  "Content": "  force_destroy = true",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 274,
                  "Content": "",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 275,
                  "Content": "  tags = merge({",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 276,
                  "Content": "    Name        = \"${local.resource_prefix.value}-flowlogs\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 277,
                  "Content": "    Environment = local.resource_prefix.value",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 278,
                  "Content": "    }, {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 279,
                  "Content": "    git_commit           = \"d68d2897add9bc2203a5ed0632a5cdd8ff8cefb0\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 280,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "AVD-AWS-0091",
          "Title": "S3 Access Block should Ignore Public Acl",
          "Description": "\nS3 buckets should ignore public ACLs on buckets and any objects they contain. By ignoring rather than blocking, PUT calls with public ACLs will still be applied but the ACL will be ignored.\n",
          "Message": "No public access block so not ignoring public acls",
          "Query": "data..",
          "Resolution": "Enable ignoring the application of public ACLs in PUT calls",
          "Severity": "HIGH",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0091",
          "References": [
            "https://docs.aws.amazon.com/AmazonS3/latest/userguide/access-control-block-public-access.html",
            "https://avd.aquasec.com/misconfig/avd-aws-0091"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "aws_s3_bucket.flowbucket",
            "Provider": "AWS",
            "Service": "s3",
            "StartLine": 271,
            "EndLine": 288,
            "Code": {
              "Lines": [
                {
                  "Number": 271,
                  "Content": "resource \"aws_s3_bucket\" \"flowbucket\" {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 272,
                  "Content": "  bucket        = \"${local.resource_prefix.value}-flowlogs\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 273,
                  "Content": "  force_destroy = true",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 274,
                  "Content": "",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 275,
                  "Content": "  tags = merge({",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 276,
                  "Content": "    Name        = \"${local.resource_prefix.value}-flowlogs\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 277,
                  "Content": "    Environment = local.resource_prefix.value",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 278,
                  "Content": "    }, {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 279,
                  "Content": "    git_commit           = \"d68d2897add9bc2203a5ed0632a5cdd8ff8cefb0\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 280,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "AVD-AWS-0093",
          "Title": "S3 Access block should restrict public bucket to limit access",
          "Description": "S3 buckets should restrict public policies for the bucket. By enabling, the restrict_public_buckets, only the bucket owner and AWS Services can access if it has a public policy.",
          "Message": "No public access block so not restricting public buckets",
          "Query": "data..",
          "Resolution": "Limit the access to public buckets to only the owner or AWS Services (eg; CloudFront)",
          "Severity": "HIGH",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0093",
          "References": [
            "https://docs.aws.amazon.com/AmazonS3/latest/dev-retired/access-control-block-public-access.html",
            "https://avd.aquasec.com/misconfig/avd-aws-0093"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "aws_s3_bucket.flowbucket",
            "Provider": "AWS",
            "Service": "s3",
            "StartLine": 271,
            "EndLine": 288,
            "Code": {
              "Lines": [
                {
                  "Number": 271,
                  "Content": "resource \"aws_s3_bucket\" \"flowbucket\" {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 272,
                  "Content": "  bucket        = \"${local.resource_prefix.value}-flowlogs\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 273,
                  "Content": "  force_destroy = true",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 274,
                  "Content": "",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 275,
                  "Content": "  tags = merge({",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 276,
                  "Content": "    Name        = \"${local.resource_prefix.value}-flowlogs\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 277,
                  "Content": "    Environment = local.resource_prefix.value",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 278,
                  "Content": "    }, {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 279,
                  "Content": "    git_commit           = \"d68d2897add9bc2203a5ed0632a5cdd8ff8cefb0\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 280,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "AVD-AWS-0094",
          "Title": "S3 buckets should each define an aws_s3_bucket_public_access_block",
          "Description": "The \"block public access\" settings in S3 override individual policies that apply to a given bucket, meaning that all public access can be controlled in one central types for that bucket. It is therefore good practice to define these settings for each bucket in order to clearly define the public access that can be allowed for it.",
          "Message": "Bucket does not have a corresponding public access block.",
          "Query": "data..",
          "Resolution": "Define a aws_s3_bucket_public_access_block for the given bucket to control public access policies",
          "Severity": "LOW",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0094",
          "References": [
            "https://docs.aws.amazon.com/AmazonS3/latest/userguide/access-control-block-public-access.html",
            "https://avd.aquasec.com/misconfig/avd-aws-0094"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "aws_s3_bucket.flowbucket",
            "Provider": "AWS",
            "Service": "s3",
            "StartLine": 271,
            "EndLine": 288,
            "Code": {
              "Lines": [
                {
                  "Number": 271,
                  "Content": "resource \"aws_s3_bucket\" \"flowbucket\" {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 272,
                  "Content": "  bucket        = \"${local.resource_prefix.value}-flowlogs\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 273,
                  "Content": "  force_destroy = true",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 274,
                  "Content": "",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 275,
                  "Content": "  tags = merge({",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 276,
                  "Content": "    Name        = \"${local.resource_prefix.value}-flowlogs\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 277,
                  "Content": "    Environment = local.resource_prefix.value",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 278,
                  "Content": "    }, {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 279,
                  "Content": "    git_commit           = \"d68d2897add9bc2203a5ed0632a5cdd8ff8cefb0\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 280,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "AVD-AWS-0104",
          "Title": "An egress security group rule allows traffic to /0.",
          "Description": "Opening up ports to connect out to the public internet is generally to be avoided. You should restrict access to IP addresses or ranges that are explicitly required where possible.",
          "Message": "Security group rule allows egress to multiple public internet addresses.",
          "Query": "data..",
          "Resolution": "Set a more restrictive cidr range",
          "Severity": "CRITICAL",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0104",
          "References": [
            "https://docs.aws.amazon.com/whitepapers/latest/building-scalable-secure-multi-vpc-network-infrastructure/centralized-egress-to-internet.html",
            "https://avd.aquasec.com/misconfig/avd-aws-0104"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "aws_security_group.web-node",
            "Provider": "AWS",
            "Service": "vpc",
            "StartLine": 101,
            "EndLine": 102,
            "Code": {
              "Lines": [
                {
                  "Number": 77,
                  "Content": "resource \"aws_security_group\" \"web-node\" {",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 78,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 101,
                  "Content": "    cidr_blocks = [",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 102,
                  "Content": "    \"0.0.0.0/0\"]",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 114,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 115,
                  "Content": "}",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "AVD-AWS-0107",
          "Title": "An ingress security group rule allows traffic from /0.",
          "Description": "Opening up ports to the public internet is generally to be avoided. You should restrict access to IP addresses or ranges that explicitly require it where possible.",
          "Message": "Security group rule allows ingress from public internet.",
          "Query": "data..",
          "Resolution": "Set a more restrictive cidr range",
          "Severity": "CRITICAL",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0107",
          "References": [
            "https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/security-group-rules-reference.html",
            "https://avd.aquasec.com/misconfig/avd-aws-0107"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "aws_security_group.web-node",
            "Provider": "AWS",
            "Service": "vpc",
            "StartLine": 94,
            "EndLine": 95,
            "Code": {
              "Lines": [
                {
                  "Number": 77,
                  "Content": "resource \"aws_security_group\" \"web-node\" {",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 78,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 94,
                  "Content": "    cidr_blocks = [",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 95,
                  "Content": "    \"0.0.0.0/0\"]",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 114,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 115,
                  "Content": "}",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "AVD-AWS-0107",
          "Title": "An ingress security group rule allows traffic from /0.",
          "Description": "Opening up ports to the public internet is generally to be avoided. You should restrict access to IP addresses or ranges that explicitly require it where possible.",
          "Message": "Security group rule allows ingress from public internet.",
          "Query": "data..",
          "Resolution": "Set a more restrictive cidr range",
          "Severity": "CRITICAL",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0107",
          "References": [
            "https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/security-group-rules-reference.html",
            "https://avd.aquasec.com/misconfig/avd-aws-0107"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "aws_security_group.web-node",
            "Provider": "AWS",
            "Service": "vpc",
            "StartLine": 87,
            "EndLine": 88,
            "Code": {
              "Lines": [
                {
                  "Number": 77,
                  "Content": "resource \"aws_security_group\" \"web-node\" {",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 78,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 87,
                  "Content": "    cidr_blocks = [",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 88,
                  "Content": "    \"0.0.0.0/0\"]",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 114,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 115,
                  "Content": "}",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "AVD-AWS-0124",
          "Title": "Missing description for security group rule.",
          "Description": "Security group rules should include a description for auditing purposes.\n\nSimplifies auditing, debugging, and managing security groups.",
          "Message": "Security group rule does not have a description.",
          "Query": "data..",
          "Resolution": "Add descriptions for all security groups rules",
          "Severity": "LOW",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0124",
          "References": [
            "https://www.cloudconformity.com/knowledge-base/aws/EC2/security-group-rules-description.html",
            "https://avd.aquasec.com/misconfig/avd-aws-0124"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "aws_security_group.web-node",
            "Provider": "AWS",
            "Service": "vpc",
            "StartLine": 90,
            "EndLine": 96,
            "Code": {
              "Lines": [
                {
                  "Number": 77,
                  "Content": "resource \"aws_security_group\" \"web-node\" {",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 78,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 90,
                  "Content": "  ingress {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 91,
                  "Content": "    from_port = 22",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 92,
                  "Content": "    to_port   = 22",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 93,
                  "Content": "    protocol  = \"tcp\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 94,
                  "Content": "    cidr_blocks = [",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 95,
                  "Content": "    \"0.0.0.0/0\"]",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 96,
                  "Content": "  }",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 114,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "AVD-AWS-0124",
          "Title": "Missing description for security group rule.",
          "Description": "Security group rules should include a description for auditing purposes.\n\nSimplifies auditing, debugging, and managing security groups.",
          "Message": "Security group rule does not have a description.",
          "Query": "data..",
          "Resolution": "Add descriptions for all security groups rules",
          "Severity": "LOW",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0124",
          "References": [
            "https://www.cloudconformity.com/knowledge-base/aws/EC2/security-group-rules-description.html",
            "https://avd.aquasec.com/misconfig/avd-aws-0124"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "aws_security_group.web-node",
            "Provider": "AWS",
            "Service": "vpc",
            "StartLine": 83,
            "EndLine": 89,
            "Code": {
              "Lines": [
                {
                  "Number": 77,
                  "Content": "resource \"aws_security_group\" \"web-node\" {",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 78,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 83,
                  "Content": "  ingress {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 84,
                  "Content": "    from_port = 80",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 85,
                  "Content": "    to_port   = 80",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 86,
                  "Content": "    protocol  = \"tcp\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 87,
                  "Content": "    cidr_blocks = [",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 88,
                  "Content": "    \"0.0.0.0/0\"]",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 89,
                  "Content": "  }",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 114,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "AVD-AWS-0124",
          "Title": "Missing description for security group rule.",
          "Description": "Security group rules should include a description for auditing purposes.\n\nSimplifies auditing, debugging, and managing security groups.",
          "Message": "Security group rule does not have a description.",
          "Query": "data..",
          "Resolution": "Add descriptions for all security groups rules",
          "Severity": "LOW",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0124",
          "References": [
            "https://www.cloudconformity.com/knowledge-base/aws/EC2/security-group-rules-description.html",
            "https://avd.aquasec.com/misconfig/avd-aws-0124"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "aws_security_group.web-node",
            "Provider": "AWS",
            "Service": "vpc",
            "StartLine": 97,
            "EndLine": 103,
            "Code": {
              "Lines": [
                {
                  "Number": 77,
                  "Content": "resource \"aws_security_group\" \"web-node\" {",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 78,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 97,
                  "Content": "  egress {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 98,
                  "Content": "    from_port = 0",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 99,
                  "Content": "    to_port   = 0",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 100,
                  "Content": "    protocol  = \"-1\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 101,
                  "Content": "    cidr_blocks = [",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 102,
                  "Content": "    \"0.0.0.0/0\"]",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 103,
                  "Content": "  }",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 114,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "AVD-AWS-0131",
          "Title": "Instance with unencrypted block device.",
          "Description": "Block devices should be encrypted to ensure sensitive data is held securely at rest.",
          "Message": "Root block device is not encrypted.",
          "Query": "data..",
          "Resolution": "Turn on encryption for all block devices",
          "Severity": "HIGH",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0131",
          "References": [
            "https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/RootDeviceStorage.html",
            "https://avd.aquasec.com/misconfig/avd-aws-0131"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "aws_instance.web_host",
            "Provider": "AWS",
            "Service": "ec2",
            "StartLine": 1,
            "EndLine": 32,
            "Code": {
              "Lines": [
                {
                  "Number": 1,
                  "Content": "resource \"aws_instance\" \"web_host\" {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 2,
                  "Content": "  # ec2 have plain text secrets in user data",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 3,
                  "Content": "  ami           = \"${var.ami}\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 4,
                  "Content": "  instance_type = \"t2.nano\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 5,
                  "Content": "",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 6,
                  "Content": "  vpc_security_group_ids = [",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 7,
                  "Content": "  \"${aws_security_group.web-node.id}\"]",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 8,
                  "Content": "  subnet_id = \"${aws_subnet.web_subnet.id}\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 9,
                  "Content": "  user_data = \u003c\u003cEOF",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 10,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "AVD-AWS-0132",
          "Title": "S3 encryption should use Customer Managed Keys",
          "Description": "Encryption using AWS keys provides protection for your S3 buckets. To increase control of the encryption and manage factors like rotation use customer managed keys.",
          "Message": "Bucket does not encrypt data with a customer managed key.",
          "Query": "data..",
          "Resolution": "Enable encryption using customer managed keys",
          "Severity": "HIGH",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0132",
          "References": [
            "https://docs.aws.amazon.com/AmazonS3/latest/userguide/bucket-encryption.html",
            "https://avd.aquasec.com/misconfig/avd-aws-0132"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "aws_s3_bucket.flowbucket",
            "Provider": "AWS",
            "Service": "s3",
            "StartLine": 271,
            "EndLine": 288,
            "Code": {
              "Lines": [
                {
                  "Number": 271,
                  "Content": "resource \"aws_s3_bucket\" \"flowbucket\" {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 272,
                  "Content": "  bucket        = \"${local.resource_prefix.value}-flowlogs\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 273,
                  "Content": "  force_destroy = true",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 274,
                  "Content": "",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 275,
                  "Content": "  tags = merge({",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 276,
                  "Content": "    Name        = \"${local.resource_prefix.value}-flowlogs\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 277,
                  "Content": "    Environment = local.resource_prefix.value",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 278,
                  "Content": "    }, {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 279,
                  "Content": "    git_commit           = \"d68d2897add9bc2203a5ed0632a5cdd8ff8cefb0\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 280,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        }
      ]
    },
    {
      "Target": "terraform/aws/ecr.tf",
      "Class": "config",
      "Type": "terraform",
      "MisconfSummary": {
        "Successes": 0,
        "Failures": 3,
        "Exceptions": 0
      },
      "Misconfigurations": [
        {
          "Type": "Terraform Security Check",
          "ID": "AVD-AWS-0030",
          "Title": "ECR repository has image scans disabled.",
          "Description": "Repository image scans should be enabled to ensure vulnerable software can be discovered and remediated as soon as possible.",
          "Message": "Image scanning is not enabled.",
          "Query": "data..",
          "Resolution": "Enable ECR image scanning",
          "Severity": "HIGH",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0030",
          "References": [
            "https://docs.aws.amazon.com/AmazonECR/latest/userguide/image-scanning.html",
            "https://avd.aquasec.com/misconfig/avd-aws-0030"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "aws_ecr_repository.repository",
            "Provider": "AWS",
            "Service": "ecr",
            "StartLine": 1,
            "EndLine": 17,
            "Code": {
              "Lines": [
                {
                  "Number": 1,
                  "Content": "resource aws_ecr_repository \"repository\" {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 2,
                  "Content": "  name                 = \"${local.resource_prefix.value}-repository\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 3,
                  "Content": "  image_tag_mutability = \"MUTABLE\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 4,
                  "Content": "",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 5,
                  "Content": "  tags = merge({",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 6,
                  "Content": "    Name = \"${local.resource_prefix.value}-repository\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 7,
                  "Content": "    }, {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 8,
                  "Content": "    git_commit           = \"d68d2897add9bc2203a5ed0632a5cdd8ff8cefb0\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 9,
                  "Content": "    git_file             = \"terraform/aws/ecr.tf\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 10,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "AVD-AWS-0031",
          "Title": "ECR images tags shouldn't be mutable.",
          "Description": "ECR images should be set to IMMUTABLE to prevent code injection through image mutation.\n\nThis can be done by setting \u003ccode\u003eimage_tab_mutability\u003c/code\u003e to \u003ccode\u003eIMMUTABLE\u003c/code\u003e",
          "Message": "Repository tags are mutable.",
          "Query": "data..",
          "Resolution": "Only use immutable images in ECR",
          "Severity": "HIGH",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0031",
          "References": [
            "https://sysdig.com/blog/toctou-tag-mutability/",
            "https://avd.aquasec.com/misconfig/avd-aws-0031"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "aws_ecr_repository.repository",
            "Provider": "AWS",
            "Service": "ecr",
            "StartLine": 3,
            "EndLine": 3,
            "Code": {
              "Lines": [
                {
                  "Number": 1,
                  "Content": "resource aws_ecr_repository \"repository\" {",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 2,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 3,
                  "Content": "  image_tag_mutability = \"MUTABLE\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": true,
                  "LastCause": true
                },
                {
                  "Number": 16,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 17,
                  "Content": "}",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "AVD-AWS-0033",
          "Title": "ECR Repository should use customer managed keys to allow more control",
          "Description": "Images in the ECR repository are encrypted by default using AWS managed encryption keys. To increase control of the encryption and control the management of factors like key rotation, use a Customer Managed Key.",
          "Message": "Repository is not encrypted using KMS.",
          "Query": "data..",
          "Resolution": "Use customer managed keys",
          "Severity": "LOW",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0033",
          "References": [
            "https://docs.aws.amazon.com/AmazonECR/latest/userguide/encryption-at-rest.html",
            "https://avd.aquasec.com/misconfig/avd-aws-0033"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "aws_ecr_repository.repository",
            "Provider": "AWS",
            "Service": "ecr",
            "StartLine": 1,
            "EndLine": 17,
            "Code": {
              "Lines": [
                {
                  "Number": 1,
                  "Content": "resource aws_ecr_repository \"repository\" {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 2,
                  "Content": "  name                 = \"${local.resource_prefix.value}-repository\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 3,
                  "Content": "  image_tag_mutability = \"MUTABLE\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 4,
                  "Content": "",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 5,
                  "Content": "  tags = merge({",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 6,
                  "Content": "    Name = \"${local.resource_prefix.value}-repository\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 7,
                  "Content": "    }, {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 8,
                  "Content": "    git_commit           = \"d68d2897add9bc2203a5ed0632a5cdd8ff8cefb0\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 9,
                  "Content": "    git_file             = \"terraform/aws/ecr.tf\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 10,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        }
      ]
    },
    {
      "Target": "terraform/aws/eks.tf",
      "Class": "config",
      "Type": "terraform",
      "MisconfSummary": {
        "Successes": 0,
        "Failures": 8,
        "Exceptions": 0
      },
      "Misconfigurations": [
        {
          "Type": "Terraform Security Check",
          "ID": "AVD-AWS-0038",
          "Title": "EKS Clusters should have cluster control plane logging turned on",
          "Description": "By default cluster control plane logging is not turned on. Logging is available for audit, api, authenticator, controllerManager and scheduler. All logging should be turned on for cluster control plane.",
          "Message": "Control plane API logging is not enabled.",
          "Query": "data..",
          "Resolution": "Enable logging for the EKS control plane",
          "Severity": "MEDIUM",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0038",
          "References": [
            "https://docs.aws.amazon.com/eks/latest/userguide/control-plane-logs.html",
            "https://avd.aquasec.com/misconfig/avd-aws-0038"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "aws_eks_cluster.eks_cluster",
            "Provider": "AWS",
            "Service": "eks",
            "StartLine": 117,
            "EndLine": 140,
            "Code": {
              "Lines": [
                {
                  "Number": 117,
                  "Content": "resource aws_eks_cluster \"eks_cluster\" {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 118,
                  "Content": "  name     = local.eks_name.value",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 119,
                  "Content": "  role_arn = \"${aws_iam_role.iam_for_eks.arn}\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 120,
                  "Content": "",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 121,
                  "Content": "  vpc_config {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 122,
                  "Content": "    endpoint_private_access = true",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 123,
                  "Content": "    subnet_ids              = [\"${aws_subnet.eks_subnet1.id}\", \"${aws_subnet.eks_subnet2.id}\"]",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 124,
                  "Content": "  }",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 125,
                  "Content": "",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 126,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "AVD-AWS-0038",
          "Title": "EKS Clusters should have cluster control plane logging turned on",
          "Description": "By default cluster control plane logging is not turned on. Logging is available for audit, api, authenticator, controllerManager and scheduler. All logging should be turned on for cluster control plane.",
          "Message": "Control plane audit logging is not enabled.",
          "Query": "data..",
          "Resolution": "Enable logging for the EKS control plane",
          "Severity": "MEDIUM",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0038",
          "References": [
            "https://docs.aws.amazon.com/eks/latest/userguide/control-plane-logs.html",
            "https://avd.aquasec.com/misconfig/avd-aws-0038"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "aws_eks_cluster.eks_cluster",
            "Provider": "AWS",
            "Service": "eks",
            "StartLine": 117,
            "EndLine": 140,
            "Code": {
              "Lines": [
                {
                  "Number": 117,
                  "Content": "resource aws_eks_cluster \"eks_cluster\" {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 118,
                  "Content": "  name     = local.eks_name.value",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 119,
                  "Content": "  role_arn = \"${aws_iam_role.iam_for_eks.arn}\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 120,
                  "Content": "",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 121,
                  "Content": "  vpc_config {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 122,
                  "Content": "    endpoint_private_access = true",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 123,
                  "Content": "    subnet_ids              = [\"${aws_subnet.eks_subnet1.id}\", \"${aws_subnet.eks_subnet2.id}\"]",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 124,
                  "Content": "  }",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 125,
                  "Content": "",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 126,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "AVD-AWS-0038",
          "Title": "EKS Clusters should have cluster control plane logging turned on",
          "Description": "By default cluster control plane logging is not turned on. Logging is available for audit, api, authenticator, controllerManager and scheduler. All logging should be turned on for cluster control plane.",
          "Message": "Control plane authenticator logging is not enabled.",
          "Query": "data..",
          "Resolution": "Enable logging for the EKS control plane",
          "Severity": "MEDIUM",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0038",
          "References": [
            "https://docs.aws.amazon.com/eks/latest/userguide/control-plane-logs.html",
            "https://avd.aquasec.com/misconfig/avd-aws-0038"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "aws_eks_cluster.eks_cluster",
            "Provider": "AWS",
            "Service": "eks",
            "StartLine": 117,
            "EndLine": 140,
            "Code": {
              "Lines": [
                {
                  "Number": 117,
                  "Content": "resource aws_eks_cluster \"eks_cluster\" {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 118,
                  "Content": "  name     = local.eks_name.value",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 119,
                  "Content": "  role_arn = \"${aws_iam_role.iam_for_eks.arn}\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 120,
                  "Content": "",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 121,
                  "Content": "  vpc_config {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 122,
                  "Content": "    endpoint_private_access = true",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 123,
                  "Content": "    subnet_ids              = [\"${aws_subnet.eks_subnet1.id}\", \"${aws_subnet.eks_subnet2.id}\"]",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 124,
                  "Content": "  }",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 125,
                  "Content": "",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 126,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "AVD-AWS-0038",
          "Title": "EKS Clusters should have cluster control plane logging turned on",
          "Description": "By default cluster control plane logging is not turned on. Logging is available for audit, api, authenticator, controllerManager and scheduler. All logging should be turned on for cluster control plane.",
          "Message": "Control plane controller manager logging is not enabled.",
          "Query": "data..",
          "Resolution": "Enable logging for the EKS control plane",
          "Severity": "MEDIUM",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0038",
          "References": [
            "https://docs.aws.amazon.com/eks/latest/userguide/control-plane-logs.html",
            "https://avd.aquasec.com/misconfig/avd-aws-0038"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "aws_eks_cluster.eks_cluster",
            "Provider": "AWS",
            "Service": "eks",
            "StartLine": 117,
            "EndLine": 140,
            "Code": {
              "Lines": [
                {
                  "Number": 117,
                  "Content": "resource aws_eks_cluster \"eks_cluster\" {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 118,
                  "Content": "  name     = local.eks_name.value",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 119,
                  "Content": "  role_arn = \"${aws_iam_role.iam_for_eks.arn}\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 120,
                  "Content": "",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 121,
                  "Content": "  vpc_config {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 122,
                  "Content": "    endpoint_private_access = true",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 123,
                  "Content": "    subnet_ids              = [\"${aws_subnet.eks_subnet1.id}\", \"${aws_subnet.eks_subnet2.id}\"]",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 124,
                  "Content": "  }",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 125,
                  "Content": "",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 126,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "AVD-AWS-0038",
          "Title": "EKS Clusters should have cluster control plane logging turned on",
          "Description": "By default cluster control plane logging is not turned on. Logging is available for audit, api, authenticator, controllerManager and scheduler. All logging should be turned on for cluster control plane.",
          "Message": "Control plane scheduler logging is not enabled.",
          "Query": "data..",
          "Resolution": "Enable logging for the EKS control plane",
          "Severity": "MEDIUM",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0038",
          "References": [
            "https://docs.aws.amazon.com/eks/latest/userguide/control-plane-logs.html",
            "https://avd.aquasec.com/misconfig/avd-aws-0038"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "aws_eks_cluster.eks_cluster",
            "Provider": "AWS",
            "Service": "eks",
            "StartLine": 117,
            "EndLine": 140,
            "Code": {
              "Lines": [
                {
                  "Number": 117,
                  "Content": "resource aws_eks_cluster \"eks_cluster\" {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 118,
                  "Content": "  name     = local.eks_name.value",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 119,
                  "Content": "  role_arn = \"${aws_iam_role.iam_for_eks.arn}\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 120,
                  "Content": "",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 121,
                  "Content": "  vpc_config {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 122,
                  "Content": "    endpoint_private_access = true",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 123,
                  "Content": "    subnet_ids              = [\"${aws_subnet.eks_subnet1.id}\", \"${aws_subnet.eks_subnet2.id}\"]",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 124,
                  "Content": "  }",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 125,
                  "Content": "",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 126,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "AVD-AWS-0039",
          "Title": "EKS should have the encryption of secrets enabled",
          "Description": "EKS cluster resources should have the encryption_config block set with protection of the secrets resource.",
          "Message": "Cluster does not have secret encryption enabled.",
          "Query": "data..",
          "Resolution": "Enable encryption of EKS secrets",
          "Severity": "HIGH",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0039",
          "References": [
            "https://aws.amazon.com/about-aws/whats-new/2020/03/amazon-eks-adds-envelope-encryption-for-secrets-with-aws-kms/",
            "https://avd.aquasec.com/misconfig/avd-aws-0039"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "aws_eks_cluster.eks_cluster",
            "Provider": "AWS",
            "Service": "eks",
            "StartLine": 117,
            "EndLine": 140,
            "Code": {
              "Lines": [
                {
                  "Number": 117,
                  "Content": "resource aws_eks_cluster \"eks_cluster\" {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 118,
                  "Content": "  name     = local.eks_name.value",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 119,
                  "Content": "  role_arn = \"${aws_iam_role.iam_for_eks.arn}\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 120,
                  "Content": "",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 121,
                  "Content": "  vpc_config {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 122,
                  "Content": "    endpoint_private_access = true",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 123,
                  "Content": "    subnet_ids              = [\"${aws_subnet.eks_subnet1.id}\", \"${aws_subnet.eks_subnet2.id}\"]",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 124,
                  "Content": "  }",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 125,
                  "Content": "",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 126,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "AVD-AWS-0040",
          "Title": "EKS Clusters should have the public access disabled",
          "Description": "EKS clusters are available publicly by default, this should be explicitly disabled in the vpc_config of the EKS cluster resource.",
          "Message": "Public cluster access is enabled.",
          "Query": "data..",
          "Resolution": "Don't enable public access to EKS Clusters",
          "Severity": "CRITICAL",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0040",
          "References": [
            "https://docs.aws.amazon.com/eks/latest/userguide/cluster-endpoint.html",
            "https://avd.aquasec.com/misconfig/avd-aws-0040"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "aws_eks_cluster.eks_cluster",
            "Provider": "AWS",
            "Service": "eks",
            "StartLine": 121,
            "EndLine": 124,
            "Code": {
              "Lines": [
                {
                  "Number": 117,
                  "Content": "resource aws_eks_cluster \"eks_cluster\" {",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 118,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 121,
                  "Content": "  vpc_config {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 122,
                  "Content": "    endpoint_private_access = true",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 123,
                  "Content": "    subnet_ids              = [\"${aws_subnet.eks_subnet1.id}\", \"${aws_subnet.eks_subnet2.id}\"]",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 124,
                  "Content": "  }",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 139,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 140,
                  "Content": "}",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "AVD-AWS-0041",
          "Title": "EKS cluster should not have open CIDR range for public access",
          "Description": "EKS Clusters have public access cidrs set to 0.0.0.0/0 by default which is wide open to the internet. This should be explicitly set to a more specific private CIDR range",
          "Message": "Cluster allows access from a public CIDR: 0.0.0.0/0.",
          "Query": "data..",
          "Resolution": "Don't enable public access to EKS Clusters",
          "Severity": "CRITICAL",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0041",
          "References": [
            "https://docs.aws.amazon.com/eks/latest/userguide/create-public-private-vpc.html",
            "https://avd.aquasec.com/misconfig/avd-aws-0041"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "aws_eks_cluster.eks_cluster",
            "Provider": "AWS",
            "Service": "eks",
            "StartLine": 121,
            "EndLine": 124,
            "Code": {
              "Lines": [
                {
                  "Number": 117,
                  "Content": "resource aws_eks_cluster \"eks_cluster\" {",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 118,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 121,
                  "Content": "  vpc_config {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 122,
                  "Content": "    endpoint_private_access = true",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 123,
                  "Content": "    subnet_ids              = [\"${aws_subnet.eks_subnet1.id}\", \"${aws_subnet.eks_subnet2.id}\"]",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 124,
                  "Content": "  }",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 139,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 140,
                  "Content": "}",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        }
      ]
    },
    {
      "Target": "terraform/aws/elb.tf",
      "Class": "config",
      "Type": "terraform",
      "MisconfSummary": {
        "Successes": 0,
        "Failures": 1,
        "Exceptions": 0
      },
      "Misconfigurations": [
        {
          "Type": "Terraform Security Check",
          "ID": "AVD-AWS-0053",
          "Title": "Load balancer is exposed to the internet.",
          "Description": "There are many scenarios in which you would want to expose a load balancer to the wider internet, but this check exists as a warning to prevent accidental exposure of internal assets. You should ensure that this resource should be exposed publicly.",
          "Message": "Load balancer is exposed publicly.",
          "Query": "data..",
          "Resolution": "Switch to an internal load balancer or add a tfsec ignore",
          "Severity": "HIGH",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0053",
          "References": [
            "https://avd.aquasec.com/misconfig/avd-aws-0053"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "aws_elb.weblb",
            "Provider": "AWS",
            "Service": "elb",
            "StartLine": 2,
            "EndLine": 40,
            "Code": {
              "Lines": [
                {
                  "Number": 2,
                  "Content": "resource \"aws_elb\" \"weblb\" {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 3,
                  "Content": "  name = \"weblb-terraform-elb\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 4,
                  "Content": "",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 5,
                  "Content": "  listener {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 6,
                  "Content": "    instance_port     = 8000",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 7,
                  "Content": "    instance_protocol = \"http\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 8,
                  "Content": "    lb_port           = 80",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 9,
                  "Content": "    lb_protocol       = \"http\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 10,
                  "Content": "  }",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 11,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        }
      ]
    },
    {
      "Target": "terraform/aws/es.tf",
      "Class": "config",
      "Type": "terraform",
      "MisconfSummary": {
        "Successes": 0,
        "Failures": 5,
        "Exceptions": 0
      },
      "Misconfigurations": [
        {
          "Type": "Terraform Security Check",
          "ID": "AVD-AWS-0042",
          "Title": "Domain logging should be enabled for Elastic Search domains",
          "Description": "Amazon ES exposes four Elasticsearch logs through Amazon CloudWatch Logs: error logs, search slow logs, index slow logs, and audit logs. \n\nSearch slow logs, index slow logs, and error logs are useful for troubleshooting performance and stability issues. \n\nAudit logs track user activity for compliance purposes. \n\nAll the logs are disabled by default.",
          "Message": "Domain audit logging is not enabled.",
          "Query": "data..",
          "Resolution": "Enable logging for ElasticSearch domains",
          "Severity": "MEDIUM",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0042",
          "References": [
            "https://docs.aws.amazon.com/elasticsearch-service/latest/developerguide/es-createdomain-configure-slow-logs.html",
            "https://avd.aquasec.com/misconfig/avd-aws-0042"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "aws_elasticsearch_domain.monitoring-framework",
            "Provider": "AWS",
            "Service": "elastic-search",
            "StartLine": 1,
            "EndLine": 27,
            "Code": {
              "Lines": [
                {
                  "Number": 1,
                  "Content": "resource \"aws_elasticsearch_domain\" \"monitoring-framework\" {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 2,
                  "Content": "  domain_name           = \"tg-${var.environment}-es\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 3,
                  "Content": "  elasticsearch_version = \"2.3\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 4,
                  "Content": "",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 5,
                  "Content": "  cluster_config {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 6,
                  "Content": "    instance_type            = \"t2.small.elasticsearch\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 7,
                  "Content": "    instance_count           = 1",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 8,
                  "Content": "    dedicated_master_enabled = false",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 9,
                  "Content": "    dedicated_master_type    = \"m4.large.elasticsearch\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 10,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "AVD-AWS-0043",
          "Title": "Elasticsearch domain uses plaintext traffic for node to node communication.",
          "Description": "Traffic flowing between Elasticsearch nodes should be encrypted to ensure sensitive data is kept private.",
          "Message": "Domain does not have in-transit encryption enabled.",
          "Query": "data..",
          "Resolution": "Enable encrypted node to node communication",
          "Severity": "HIGH",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0043",
          "References": [
            "https://docs.aws.amazon.com/elasticsearch-service/latest/developerguide/ntn.html",
            "https://avd.aquasec.com/misconfig/avd-aws-0043"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "aws_elasticsearch_domain.monitoring-framework",
            "Provider": "AWS",
            "Service": "elastic-search",
            "StartLine": 1,
            "EndLine": 27,
            "Code": {
              "Lines": [
                {
                  "Number": 1,
                  "Content": "resource \"aws_elasticsearch_domain\" \"monitoring-framework\" {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 2,
                  "Content": "  domain_name           = \"tg-${var.environment}-es\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 3,
                  "Content": "  elasticsearch_version = \"2.3\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 4,
                  "Content": "",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 5,
                  "Content": "  cluster_config {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 6,
                  "Content": "    instance_type            = \"t2.small.elasticsearch\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 7,
                  "Content": "    instance_count           = 1",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 8,
                  "Content": "    dedicated_master_enabled = false",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 9,
                  "Content": "    dedicated_master_type    = \"m4.large.elasticsearch\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 10,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "AVD-AWS-0046",
          "Title": "Elasticsearch doesn't enforce HTTPS traffic.",
          "Description": "Plain HTTP is unencrypted and human-readable. This means that if a malicious actor was to eavesdrop on your connection, they would be able to see all of your data flowing back and forth.\n\nYou should use HTTPS, which is HTTP over an encrypted (TLS) connection, meaning eavesdroppers cannot read your traffic.",
          "Message": "Domain does not enforce HTTPS.",
          "Query": "data..",
          "Resolution": "Enforce the use of HTTPS for ElasticSearch",
          "Severity": "CRITICAL",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0046",
          "References": [
            "https://docs.aws.amazon.com/elasticsearch-service/latest/developerguide/es-data-protection.html",
            "https://avd.aquasec.com/misconfig/avd-aws-0046"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "aws_elasticsearch_domain.monitoring-framework",
            "Provider": "AWS",
            "Service": "elastic-search",
            "StartLine": 1,
            "EndLine": 27,
            "Code": {
              "Lines": [
                {
                  "Number": 1,
                  "Content": "resource \"aws_elasticsearch_domain\" \"monitoring-framework\" {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 2,
                  "Content": "  domain_name           = \"tg-${var.environment}-es\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 3,
                  "Content": "  elasticsearch_version = \"2.3\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 4,
                  "Content": "",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 5,
                  "Content": "  cluster_config {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 6,
                  "Content": "    instance_type            = \"t2.small.elasticsearch\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 7,
                  "Content": "    instance_count           = 1",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 8,
                  "Content": "    dedicated_master_enabled = false",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 9,
                  "Content": "    dedicated_master_type    = \"m4.large.elasticsearch\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 10,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "AVD-AWS-0048",
          "Title": "Elasticsearch domain isn't encrypted at rest.",
          "Description": "You should ensure your Elasticsearch data is encrypted at rest to help prevent sensitive information from being read by unauthorised users.",
          "Message": "Domain does not have at-rest encryption enabled.",
          "Query": "data..",
          "Resolution": "Enable ElasticSearch domain encryption",
          "Severity": "HIGH",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0048",
          "References": [
            "https://docs.aws.amazon.com/elasticsearch-service/latest/developerguide/encryption-at-rest.html",
            "https://avd.aquasec.com/misconfig/avd-aws-0048"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "aws_elasticsearch_domain.monitoring-framework",
            "Provider": "AWS",
            "Service": "elastic-search",
            "StartLine": 1,
            "EndLine": 27,
            "Code": {
              "Lines": [
                {
                  "Number": 1,
                  "Content": "resource \"aws_elasticsearch_domain\" \"monitoring-framework\" {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 2,
                  "Content": "  domain_name           = \"tg-${var.environment}-es\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 3,
                  "Content": "  elasticsearch_version = \"2.3\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 4,
                  "Content": "",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 5,
                  "Content": "  cluster_config {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 6,
                  "Content": "    instance_type            = \"t2.small.elasticsearch\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 7,
                  "Content": "    instance_count           = 1",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 8,
                  "Content": "    dedicated_master_enabled = false",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 9,
                  "Content": "    dedicated_master_type    = \"m4.large.elasticsearch\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 10,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "AVD-AWS-0126",
          "Title": "Elasticsearch domain endpoint is using outdated TLS policy.",
          "Description": "You should not use outdated/insecure TLS versions for encryption. You should be using TLS v1.2+.",
          "Message": "Domain does not have a secure TLS policy.",
          "Query": "data..",
          "Resolution": "Use the most modern TLS/SSL policies available",
          "Severity": "HIGH",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0126",
          "References": [
            "https://docs.aws.amazon.com/elasticsearch-service/latest/developerguide/es-data-protection.html",
            "https://avd.aquasec.com/misconfig/avd-aws-0126"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "aws_elasticsearch_domain.monitoring-framework",
            "Provider": "AWS",
            "Service": "elastic-search",
            "StartLine": 1,
            "EndLine": 27,
            "Code": {
              "Lines": [
                {
                  "Number": 1,
                  "Content": "resource \"aws_elasticsearch_domain\" \"monitoring-framework\" {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 2,
                  "Content": "  domain_name           = \"tg-${var.environment}-es\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 3,
                  "Content": "  elasticsearch_version = \"2.3\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 4,
                  "Content": "",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 5,
                  "Content": "  cluster_config {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 6,
                  "Content": "    instance_type            = \"t2.small.elasticsearch\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 7,
                  "Content": "    instance_count           = 1",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 8,
                  "Content": "    dedicated_master_enabled = false",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 9,
                  "Content": "    dedicated_master_type    = \"m4.large.elasticsearch\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 10,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        }
      ]
    },
    {
      "Target": "terraform/aws/iam.tf",
      "Class": "config",
      "Type": "terraform",
      "MisconfSummary": {
        "Successes": 0,
        "Failures": 5,
        "Exceptions": 0
      },
      "Misconfigurations": [
        {
          "Type": "Terraform Security Check",
          "ID": "AVD-AWS-0057",
          "Title": "IAM policy should avoid use of wildcards and instead apply the principle of least privilege",
          "Description": "You should use the principle of least privilege when defining your IAM policies. This means you should specify each exact permission required without using wildcards, as this could cause the granting of access to certain undesired actions, resources and principals.",
          "Message": "IAM policy document uses sensitive action 'ec2:*' on wildcarded resource '*'",
          "Query": "data..",
          "Resolution": "Specify the exact permissions required, and to which resources they should apply instead of using wildcards.",
          "Severity": "HIGH",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0057",
          "References": [
            "https://docs.aws.amazon.com/IAM/latest/UserGuide/best-practices.html",
            "https://avd.aquasec.com/misconfig/avd-aws-0057"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "aws_iam_user_policy.userpolicy",
            "Provider": "AWS",
            "Service": "iam",
            "StartLine": 41,
            "EndLine": 41,
            "Code": {
              "Lines": [
                {
                  "Number": 25,
                  "Content": "resource \"aws_iam_user_policy\" \"userpolicy\" {",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 26,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 41,
                  "Content": "      \"Resource\": \"*\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": true,
                  "LastCause": true
                },
                {
                  "Number": 45,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 46,
                  "Content": "}",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "AVD-AWS-0057",
          "Title": "IAM policy should avoid use of wildcards and instead apply the principle of least privilege",
          "Description": "You should use the principle of least privilege when defining your IAM policies. This means you should specify each exact permission required without using wildcards, as this could cause the granting of access to certain undesired actions, resources and principals.",
          "Message": "IAM policy document uses wildcarded action 'ec2:*'",
          "Query": "data..",
          "Resolution": "Specify the exact permissions required, and to which resources they should apply instead of using wildcards.",
          "Severity": "HIGH",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0057",
          "References": [
            "https://docs.aws.amazon.com/IAM/latest/UserGuide/best-practices.html",
            "https://avd.aquasec.com/misconfig/avd-aws-0057"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "aws_iam_user_policy.userpolicy",
            "Provider": "AWS",
            "Service": "iam",
            "StartLine": 34,
            "EndLine": 39,
            "Code": {
              "Lines": [
                {
                  "Number": 25,
                  "Content": "resource \"aws_iam_user_policy\" \"userpolicy\" {",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 26,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 34,
                  "Content": "      \"Action\": [",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 35,
                  "Content": "        \"ec2:*\",",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 36,
                  "Content": "        \"s3:*\",",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 37,
                  "Content": "        \"lambda:*\",",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 38,
                  "Content": "        \"cloudwatch:*\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 39,
                  "Content": "      ],",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 45,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 46,
                  "Content": "}",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "AVD-AWS-0057",
          "Title": "IAM policy should avoid use of wildcards and instead apply the principle of least privilege",
          "Description": "You should use the principle of least privilege when defining your IAM policies. This means you should specify each exact permission required without using wildcards, as this could cause the granting of access to certain undesired actions, resources and principals.",
          "Message": "IAM policy document uses wildcarded action 'ec2:*'",
          "Query": "data..",
          "Resolution": "Specify the exact permissions required, and to which resources they should apply instead of using wildcards.",
          "Severity": "HIGH",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0057",
          "References": [
            "https://docs.aws.amazon.com/IAM/latest/UserGuide/best-practices.html",
            "https://avd.aquasec.com/misconfig/avd-aws-0057"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "aws_iam_user_policy.userpolicy",
            "Provider": "AWS",
            "Service": "iam",
            "StartLine": 34,
            "EndLine": 39,
            "Code": {
              "Lines": [
                {
                  "Number": 25,
                  "Content": "resource \"aws_iam_user_policy\" \"userpolicy\" {",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 26,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 34,
                  "Content": "      \"Action\": [",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 35,
                  "Content": "        \"ec2:*\",",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 36,
                  "Content": "        \"s3:*\",",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 37,
                  "Content": "        \"lambda:*\",",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 38,
                  "Content": "        \"cloudwatch:*\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 39,
                  "Content": "      ],",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 45,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 46,
                  "Content": "}",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "AVD-AWS-0057",
          "Title": "IAM policy should avoid use of wildcards and instead apply the principle of least privilege",
          "Description": "You should use the principle of least privilege when defining your IAM policies. This means you should specify each exact permission required without using wildcards, as this could cause the granting of access to certain undesired actions, resources and principals.",
          "Message": "IAM policy document uses wildcarded action 'ec2:*'",
          "Query": "data..",
          "Resolution": "Specify the exact permissions required, and to which resources they should apply instead of using wildcards.",
          "Severity": "HIGH",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0057",
          "References": [
            "https://docs.aws.amazon.com/IAM/latest/UserGuide/best-practices.html",
            "https://avd.aquasec.com/misconfig/avd-aws-0057"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "aws_iam_user_policy.userpolicy",
            "Provider": "AWS",
            "Service": "iam",
            "StartLine": 34,
            "EndLine": 39,
            "Code": {
              "Lines": [
                {
                  "Number": 25,
                  "Content": "resource \"aws_iam_user_policy\" \"userpolicy\" {",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 26,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 34,
                  "Content": "      \"Action\": [",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 35,
                  "Content": "        \"ec2:*\",",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 36,
                  "Content": "        \"s3:*\",",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 37,
                  "Content": "        \"lambda:*\",",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 38,
                  "Content": "        \"cloudwatch:*\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 39,
                  "Content": "      ],",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 45,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 46,
                  "Content": "}",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "AVD-AWS-0057",
          "Title": "IAM policy should avoid use of wildcards and instead apply the principle of least privilege",
          "Description": "You should use the principle of least privilege when defining your IAM policies. This means you should specify each exact permission required without using wildcards, as this could cause the granting of access to certain undesired actions, resources and principals.",
          "Message": "IAM policy document uses wildcarded action 'ec2:*'",
          "Query": "data..",
          "Resolution": "Specify the exact permissions required, and to which resources they should apply instead of using wildcards.",
          "Severity": "HIGH",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0057",
          "References": [
            "https://docs.aws.amazon.com/IAM/latest/UserGuide/best-practices.html",
            "https://avd.aquasec.com/misconfig/avd-aws-0057"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "aws_iam_user_policy.userpolicy",
            "Provider": "AWS",
            "Service": "iam",
            "StartLine": 34,
            "EndLine": 39,
            "Code": {
              "Lines": [
                {
                  "Number": 25,
                  "Content": "resource \"aws_iam_user_policy\" \"userpolicy\" {",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 26,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 34,
                  "Content": "      \"Action\": [",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 35,
                  "Content": "        \"ec2:*\",",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 36,
                  "Content": "        \"s3:*\",",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 37,
                  "Content": "        \"lambda:*\",",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 38,
                  "Content": "        \"cloudwatch:*\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 39,
                  "Content": "      ],",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 45,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 46,
                  "Content": "}",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        }
      ]
    },
    {
      "Target": "terraform/aws/kms.tf",
      "Class": "config",
      "Type": "terraform",
      "MisconfSummary": {
        "Successes": 0,
        "Failures": 1,
        "Exceptions": 0
      },
      "Misconfigurations": [
        {
          "Type": "Terraform Security Check",
          "ID": "AVD-AWS-0065",
          "Title": "A KMS key is not configured to auto-rotate.",
          "Description": "You should configure your KMS keys to auto rotate to maintain security and defend against compromise.",
          "Message": "Key does not have rotation enabled.",
          "Query": "data..",
          "Resolution": "Configure KMS key to auto rotate",
          "Severity": "MEDIUM",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0065",
          "References": [
            "https://docs.aws.amazon.com/kms/latest/developerguide/rotate-keys.html",
            "https://avd.aquasec.com/misconfig/avd-aws-0065"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "aws_kms_key.logs_key",
            "Provider": "AWS",
            "Service": "kms",
            "StartLine": 1,
            "EndLine": 16,
            "Code": {
              "Lines": [
                {
                  "Number": 1,
                  "Content": "resource \"aws_kms_key\" \"logs_key\" {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 2,
                  "Content": "  # key does not have rotation enabled",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 3,
                  "Content": "  description = \"${local.resource_prefix.value}-logs bucket key\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 4,
                  "Content": "",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 5,
                  "Content": "  deletion_window_in_days = 7",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 6,
                  "Content": "  tags = {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 7,
                  "Content": "    git_commit           = \"d68d2897add9bc2203a5ed0632a5cdd8ff8cefb0\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 8,
                  "Content": "    git_file             = \"terraform/aws/kms.tf\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 9,
                  "Content": "    git_last_modified_at = \"2020-06-16 14:46:24\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 10,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        }
      ]
    },
    {
      "Target": "terraform/aws/lambda.tf",
      "Class": "config",
      "Type": "terraform",
      "MisconfSummary": {
        "Successes": 0,
        "Failures": 1,
        "Exceptions": 0
      },
      "Misconfigurations": [
        {
          "Type": "Terraform Security Check",
          "ID": "AVD-AWS-0066",
          "Title": "Lambda functions should have X-Ray tracing enabled",
          "Description": "X-Ray tracing enables end-to-end debugging and analysis of all function activity. This will allow for identifying bottlenecks, slow downs and timeouts.",
          "Message": "Function does not have tracing enabled.",
          "Query": "data..",
          "Resolution": "Enable tracing",
          "Severity": "LOW",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0066",
          "References": [
            "https://docs.aws.amazon.com/lambda/latest/dg/services-xray.html",
            "https://avd.aquasec.com/misconfig/avd-aws-0066"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "aws_lambda_function.analysis_lambda",
            "Provider": "AWS",
            "Service": "lambda",
            "StartLine": 31,
            "EndLine": 58,
            "Code": {
              "Lines": [
                {
                  "Number": 31,
                  "Content": "resource \"aws_lambda_function\" \"analysis_lambda\" {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 32,
                  "Content": "  # lambda have plain text secrets in environment variables",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 33,
                  "Content": "  filename      = \"resources/lambda_function_payload.zip\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 34,
                  "Content": "  function_name = \"${local.resource_prefix.value}-analysis\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 35,
                  "Content": "  role          = \"${aws_iam_role.iam_for_lambda.arn}\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 36,
                  "Content": "  handler       = \"exports.test\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 37,
                  "Content": "",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 38,
                  "Content": "  source_code_hash = \"${filebase64sha256(\"resources/lambda_function_payload.zip\")}\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 39,
                  "Content": "",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 40,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        }
      ]
    },
    {
      "Target": "terraform/aws/neptune.tf",
      "Class": "config",
      "Type": "terraform",
      "MisconfSummary": {
        "Successes": 0,
        "Failures": 3,
        "Exceptions": 0
      },
      "Misconfigurations": [
        {
          "Type": "Terraform Security Check",
          "ID": "AVD-AWS-0075",
          "Title": "Neptune logs export should be enabled",
          "Description": "Neptune does not have auditing by default. To ensure that you are able to accurately audit the usage of your Neptune instance you should enable export logs.",
          "Message": "Cluster does not have audit logging enabled.",
          "Query": "data..",
          "Resolution": "Enable export logs",
          "Severity": "MEDIUM",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0075",
          "References": [
            "https://docs.aws.amazon.com/neptune/latest/userguide/auditing.html",
            "https://avd.aquasec.com/misconfig/avd-aws-0075"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "aws_neptune_cluster.default",
            "Provider": "AWS",
            "Service": "neptune",
            "StartLine": 1,
            "EndLine": 20,
            "Code": {
              "Lines": [
                {
                  "Number": 1,
                  "Content": "resource \"aws_neptune_cluster\" \"default\" {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 2,
                  "Content": "  cluster_identifier                  = var.neptune-dbname",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 3,
                  "Content": "  engine                              = \"neptune\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 4,
                  "Content": "  backup_retention_period             = 5",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 5,
                  "Content": "  preferred_backup_window             = \"07:00-09:00\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 6,
                  "Content": "  skip_final_snapshot                 = true",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 7,
                  "Content": "  iam_database_authentication_enabled = false",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 8,
                  "Content": "  apply_immediately                   = true",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 9,
                  "Content": "  storage_encrypted                   = false",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 10,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "AVD-AWS-0076",
          "Title": "Neptune storage must be encrypted at rest",
          "Description": "Encryption of Neptune storage ensures that if their is compromise of the disks, the data is still protected.",
          "Message": "Cluster does not have storage encryption enabled.",
          "Query": "data..",
          "Resolution": "Enable encryption of Neptune storage",
          "Severity": "HIGH",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0076",
          "References": [
            "https://docs.aws.amazon.com/neptune/latest/userguide/encrypt.html",
            "https://avd.aquasec.com/misconfig/avd-aws-0076"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "aws_neptune_cluster.default",
            "Provider": "AWS",
            "Service": "neptune",
            "StartLine": 9,
            "EndLine": 9,
            "Code": {
              "Lines": [
                {
                  "Number": 1,
                  "Content": "resource \"aws_neptune_cluster\" \"default\" {",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 2,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 9,
                  "Content": "  storage_encrypted                   = false",
                  "IsCause": true,
                  "Annotation": "false",
                  "Truncated": false,
                  "FirstCause": true,
                  "LastCause": true
                },
                {
                  "Number": 19,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 20,
                  "Content": "}",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "AVD-AWS-0128",
          "Title": "Neptune encryption should use Customer Managed Keys",
          "Description": "Encryption using AWS keys provides protection for your Neptune underlying storage. To increase control of the encryption and manage factors like rotation use customer managed keys.",
          "Message": "Cluster does not encrypt data with a customer managed key.",
          "Query": "data..",
          "Resolution": "Enable encryption using customer managed keys",
          "Severity": "HIGH",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0128",
          "References": [
            "https://docs.aws.amazon.com/neptune/latest/userguide/encrypt.html",
            "https://avd.aquasec.com/misconfig/avd-aws-0128"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "aws_neptune_cluster.default",
            "Provider": "AWS",
            "Service": "neptune",
            "StartLine": 1,
            "EndLine": 20,
            "Code": {
              "Lines": [
                {
                  "Number": 1,
                  "Content": "resource \"aws_neptune_cluster\" \"default\" {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 2,
                  "Content": "  cluster_identifier                  = var.neptune-dbname",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 3,
                  "Content": "  engine                              = \"neptune\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 4,
                  "Content": "  backup_retention_period             = 5",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 5,
                  "Content": "  preferred_backup_window             = \"07:00-09:00\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 6,
                  "Content": "  skip_final_snapshot                 = true",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 7,
                  "Content": "  iam_database_authentication_enabled = false",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 8,
                  "Content": "  apply_immediately                   = true",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 9,
                  "Content": "  storage_encrypted                   = false",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 10,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        }
      ]
    },
    {
      "Target": "terraform/aws/rds.tf",
      "Class": "config",
      "Type": "terraform",
      "MisconfSummary": {
        "Successes": 1,
        "Failures": 11,
        "Exceptions": 0
      },
      "Misconfigurations": [
        {
          "Type": "Terraform Security Check",
          "ID": "AVD-AWS-0077",
          "Title": "RDS Cluster and RDS instance should have backup retention longer than default 1 day",
          "Description": "RDS backup retention for clusters defaults to 1 day, this may not be enough to identify and respond to an issue. Backup retention periods should be set to a period that is a balance on cost and limiting risk.",
          "Message": "Cluster has very low backup retention period.",
          "Query": "data..",
          "Resolution": "Explicitly set the retention period to greater than the default",
          "Severity": "MEDIUM",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0077",
          "References": [
            "https://docs.aws.amazon.com/AmazonRDS/latest/UserGuide/USER_WorkingWithAutomatedBackups.html#USER_WorkingWithAutomatedBackups.BackupRetention",
            "https://avd.aquasec.com/misconfig/avd-aws-0077"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "aws_rds_cluster.app1-rds-cluster",
            "Provider": "AWS",
            "Service": "rds",
            "StartLine": 4,
            "EndLine": 4,
            "Code": {
              "Lines": [
                {
                  "Number": 1,
                  "Content": "resource \"aws_rds_cluster\" \"app1-rds-cluster\" {",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 2,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 4,
                  "Content": "  backup_retention_period = 0",
                  "IsCause": true,
                  "Annotation": "0",
                  "Truncated": false,
                  "FirstCause": true,
                  "LastCause": true
                },
                {
                  "Number": 14,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 15,
                  "Content": "}",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "AVD-AWS-0077",
          "Title": "RDS Cluster and RDS instance should have backup retention longer than default 1 day",
          "Description": "RDS backup retention for clusters defaults to 1 day, this may not be enough to identify and respond to an issue. Backup retention periods should be set to a period that is a balance on cost and limiting risk.",
          "Message": "Cluster has very low backup retention period.",
          "Query": "data..",
          "Resolution": "Explicitly set the retention period to greater than the default",
          "Severity": "MEDIUM",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0077",
          "References": [
            "https://docs.aws.amazon.com/AmazonRDS/latest/UserGuide/USER_WorkingWithAutomatedBackups.html#USER_WorkingWithAutomatedBackups.BackupRetention",
            "https://avd.aquasec.com/misconfig/avd-aws-0077"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "aws_rds_cluster.app2-rds-cluster",
            "Provider": "AWS",
            "Service": "rds",
            "StartLine": 20,
            "EndLine": 20,
            "Code": {
              "Lines": [
                {
                  "Number": 17,
                  "Content": "resource \"aws_rds_cluster\" \"app2-rds-cluster\" {",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 18,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 20,
                  "Content": "  backup_retention_period = 1",
                  "IsCause": true,
                  "Annotation": "1",
                  "Truncated": false,
                  "FirstCause": true,
                  "LastCause": true
                },
                {
                  "Number": 30,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 31,
                  "Content": "}",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "AVD-AWS-0079",
          "Title": "There is no encryption specified or encryption is disabled on the RDS Cluster.",
          "Description": "Encryption should be enabled for an RDS Aurora cluster. \n\nWhen enabling encryption by setting the kms_key_id, the storage_encrypted must also be set to true.",
          "Message": "Cluster does not have storage encryption enabled.",
          "Query": "data..",
          "Resolution": "Enable encryption for RDS clusters",
          "Severity": "HIGH",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0079",
          "References": [
            "https://docs.aws.amazon.com/AmazonRDS/latest/UserGuide/Overview.Encryption.html",
            "https://avd.aquasec.com/misconfig/avd-aws-0079"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "aws_rds_cluster.app7-rds-cluster",
            "Provider": "AWS",
            "Service": "rds",
            "StartLine": 97,
            "EndLine": 111,
            "Code": {
              "Lines": [
                {
                  "Number": 97,
                  "Content": "resource \"aws_rds_cluster\" \"app7-rds-cluster\" {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 98,
                  "Content": "  cluster_identifier      = \"app7-rds-cluster\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 99,
                  "Content": "  allocated_storage       = 10",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 100,
                  "Content": "  backup_retention_period = 25",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 101,
                  "Content": "  tags = {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 102,
                  "Content": "    git_commit           = \"079fe74f6b96d887c245664fbd8cf676c92f20e5\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 103,
                  "Content": "    git_file             = \"terraform/aws/rds.tf\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 104,
                  "Content": "    git_last_modified_at = \"2021-12-08 23:26:32\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 105,
                  "Content": "    git_last_modified_by = \"tron47@gmail.com\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 106,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "AVD-AWS-0079",
          "Title": "There is no encryption specified or encryption is disabled on the RDS Cluster.",
          "Description": "Encryption should be enabled for an RDS Aurora cluster. \n\nWhen enabling encryption by setting the kms_key_id, the storage_encrypted must also be set to true.",
          "Message": "Cluster does not have storage encryption enabled.",
          "Query": "data..",
          "Resolution": "Enable encryption for RDS clusters",
          "Severity": "HIGH",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0079",
          "References": [
            "https://docs.aws.amazon.com/AmazonRDS/latest/UserGuide/Overview.Encryption.html",
            "https://avd.aquasec.com/misconfig/avd-aws-0079"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "aws_rds_cluster.app6-rds-cluster",
            "Provider": "AWS",
            "Service": "rds",
            "StartLine": 81,
            "EndLine": 95,
            "Code": {
              "Lines": [
                {
                  "Number": 81,
                  "Content": "resource \"aws_rds_cluster\" \"app6-rds-cluster\" {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 82,
                  "Content": "  cluster_identifier      = \"app6-rds-cluster\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 83,
                  "Content": "  allocated_storage       = 10",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 84,
                  "Content": "  backup_retention_period = 15",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 85,
                  "Content": "  tags = {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 86,
                  "Content": "    git_commit           = \"079fe74f6b96d887c245664fbd8cf676c92f20e5\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 87,
                  "Content": "    git_file             = \"terraform/aws/rds.tf\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 88,
                  "Content": "    git_last_modified_at = \"2021-12-08 23:26:32\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 89,
                  "Content": "    git_last_modified_by = \"tron47@gmail.com\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 90,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "AVD-AWS-0079",
          "Title": "There is no encryption specified or encryption is disabled on the RDS Cluster.",
          "Description": "Encryption should be enabled for an RDS Aurora cluster. \n\nWhen enabling encryption by setting the kms_key_id, the storage_encrypted must also be set to true.",
          "Message": "Cluster does not have storage encryption enabled.",
          "Query": "data..",
          "Resolution": "Enable encryption for RDS clusters",
          "Severity": "HIGH",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0079",
          "References": [
            "https://docs.aws.amazon.com/AmazonRDS/latest/UserGuide/Overview.Encryption.html",
            "https://avd.aquasec.com/misconfig/avd-aws-0079"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "aws_rds_cluster.app5-rds-cluster",
            "Provider": "AWS",
            "Service": "rds",
            "StartLine": 65,
            "EndLine": 79,
            "Code": {
              "Lines": [
                {
                  "Number": 65,
                  "Content": "resource \"aws_rds_cluster\" \"app5-rds-cluster\" {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 66,
                  "Content": "  cluster_identifier      = \"app5-rds-cluster\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 67,
                  "Content": "  allocated_storage       = 10",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 68,
                  "Content": "  backup_retention_period = 15",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 69,
                  "Content": "  tags = {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 70,
                  "Content": "    git_commit           = \"079fe74f6b96d887c245664fbd8cf676c92f20e5\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 71,
                  "Content": "    git_file             = \"terraform/aws/rds.tf\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 72,
                  "Content": "    git_last_modified_at = \"2021-12-08 23:26:32\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 73,
                  "Content": "    git_last_modified_by = \"tron47@gmail.com\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 74,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "AVD-AWS-0079",
          "Title": "There is no encryption specified or encryption is disabled on the RDS Cluster.",
          "Description": "Encryption should be enabled for an RDS Aurora cluster. \n\nWhen enabling encryption by setting the kms_key_id, the storage_encrypted must also be set to true.",
          "Message": "Cluster does not have storage encryption enabled.",
          "Query": "data..",
          "Resolution": "Enable encryption for RDS clusters",
          "Severity": "HIGH",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0079",
          "References": [
            "https://docs.aws.amazon.com/AmazonRDS/latest/UserGuide/Overview.Encryption.html",
            "https://avd.aquasec.com/misconfig/avd-aws-0079"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "aws_rds_cluster.app2-rds-cluster",
            "Provider": "AWS",
            "Service": "rds",
            "StartLine": 17,
            "EndLine": 31,
            "Code": {
              "Lines": [
                {
                  "Number": 17,
                  "Content": "resource \"aws_rds_cluster\" \"app2-rds-cluster\" {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 18,
                  "Content": "  cluster_identifier      = \"app2-rds-cluster\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 19,
                  "Content": "  allocated_storage       = 10",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 20,
                  "Content": "  backup_retention_period = 1",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 21,
                  "Content": "  tags = {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 22,
                  "Content": "    git_commit           = \"079fe74f6b96d887c245664fbd8cf676c92f20e5\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 23,
                  "Content": "    git_file             = \"terraform/aws/rds.tf\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 24,
                  "Content": "    git_last_modified_at = \"2021-12-08 23:26:32\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 25,
                  "Content": "    git_last_modified_by = \"tron47@gmail.com\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 26,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "AVD-AWS-0079",
          "Title": "There is no encryption specified or encryption is disabled on the RDS Cluster.",
          "Description": "Encryption should be enabled for an RDS Aurora cluster. \n\nWhen enabling encryption by setting the kms_key_id, the storage_encrypted must also be set to true.",
          "Message": "Cluster does not have storage encryption enabled.",
          "Query": "data..",
          "Resolution": "Enable encryption for RDS clusters",
          "Severity": "HIGH",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0079",
          "References": [
            "https://docs.aws.amazon.com/AmazonRDS/latest/UserGuide/Overview.Encryption.html",
            "https://avd.aquasec.com/misconfig/avd-aws-0079"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "aws_rds_cluster.app9-rds-cluster",
            "Provider": "AWS",
            "Service": "rds",
            "StartLine": 129,
            "EndLine": 143,
            "Code": {
              "Lines": [
                {
                  "Number": 129,
                  "Content": "resource \"aws_rds_cluster\" \"app9-rds-cluster\" {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 130,
                  "Content": "  cluster_identifier      = \"app9-rds-cluster\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 131,
                  "Content": "  allocated_storage       = 10",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 132,
                  "Content": "  backup_retention_period = 25",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 133,
                  "Content": "  tags = {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 134,
                  "Content": "    git_commit           = \"079fe74f6b96d887c245664fbd8cf676c92f20e5\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 135,
                  "Content": "    git_file             = \"terraform/aws/rds.tf\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 136,
                  "Content": "    git_last_modified_at = \"2021-12-08 23:26:32\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 137,
                  "Content": "    git_last_modified_by = \"tron47@gmail.com\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 138,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "AVD-AWS-0079",
          "Title": "There is no encryption specified or encryption is disabled on the RDS Cluster.",
          "Description": "Encryption should be enabled for an RDS Aurora cluster. \n\nWhen enabling encryption by setting the kms_key_id, the storage_encrypted must also be set to true.",
          "Message": "Cluster does not have storage encryption enabled.",
          "Query": "data..",
          "Resolution": "Enable encryption for RDS clusters",
          "Severity": "HIGH",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0079",
          "References": [
            "https://docs.aws.amazon.com/AmazonRDS/latest/UserGuide/Overview.Encryption.html",
            "https://avd.aquasec.com/misconfig/avd-aws-0079"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "aws_rds_cluster.app8-rds-cluster",
            "Provider": "AWS",
            "Service": "rds",
            "StartLine": 113,
            "EndLine": 127,
            "Code": {
              "Lines": [
                {
                  "Number": 113,
                  "Content": "resource \"aws_rds_cluster\" \"app8-rds-cluster\" {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 114,
                  "Content": "  cluster_identifier      = \"app8-rds-cluster\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 115,
                  "Content": "  allocated_storage       = 10",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 116,
                  "Content": "  backup_retention_period = 25",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 117,
                  "Content": "  tags = {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 118,
                  "Content": "    git_commit           = \"079fe74f6b96d887c245664fbd8cf676c92f20e5\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 119,
                  "Content": "    git_file             = \"terraform/aws/rds.tf\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 120,
                  "Content": "    git_last_modified_at = \"2021-12-08 23:26:32\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 121,
                  "Content": "    git_last_modified_by = \"tron47@gmail.com\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 122,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "AVD-AWS-0079",
          "Title": "There is no encryption specified or encryption is disabled on the RDS Cluster.",
          "Description": "Encryption should be enabled for an RDS Aurora cluster. \n\nWhen enabling encryption by setting the kms_key_id, the storage_encrypted must also be set to true.",
          "Message": "Cluster does not have storage encryption enabled.",
          "Query": "data..",
          "Resolution": "Enable encryption for RDS clusters",
          "Severity": "HIGH",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0079",
          "References": [
            "https://docs.aws.amazon.com/AmazonRDS/latest/UserGuide/Overview.Encryption.html",
            "https://avd.aquasec.com/misconfig/avd-aws-0079"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "aws_rds_cluster.app1-rds-cluster",
            "Provider": "AWS",
            "Service": "rds",
            "StartLine": 1,
            "EndLine": 15,
            "Code": {
              "Lines": [
                {
                  "Number": 1,
                  "Content": "resource \"aws_rds_cluster\" \"app1-rds-cluster\" {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 2,
                  "Content": "  cluster_identifier      = \"app1-rds-cluster\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 3,
                  "Content": "  allocated_storage       = 10",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 4,
                  "Content": "  backup_retention_period = 0",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 5,
                  "Content": "  tags = {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 6,
                  "Content": "    git_commit           = \"079fe74f6b96d887c245664fbd8cf676c92f20e5\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 7,
                  "Content": "    git_file             = \"terraform/aws/rds.tf\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 8,
                  "Content": "    git_last_modified_at = \"2021-12-08 23:26:32\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 9,
                  "Content": "    git_last_modified_by = \"tron47@gmail.com\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 10,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "AVD-AWS-0079",
          "Title": "There is no encryption specified or encryption is disabled on the RDS Cluster.",
          "Description": "Encryption should be enabled for an RDS Aurora cluster. \n\nWhen enabling encryption by setting the kms_key_id, the storage_encrypted must also be set to true.",
          "Message": "Cluster does not have storage encryption enabled.",
          "Query": "data..",
          "Resolution": "Enable encryption for RDS clusters",
          "Severity": "HIGH",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0079",
          "References": [
            "https://docs.aws.amazon.com/AmazonRDS/latest/UserGuide/Overview.Encryption.html",
            "https://avd.aquasec.com/misconfig/avd-aws-0079"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "aws_rds_cluster.app4-rds-cluster",
            "Provider": "AWS",
            "Service": "rds",
            "StartLine": 49,
            "EndLine": 63,
            "Code": {
              "Lines": [
                {
                  "Number": 49,
                  "Content": "resource \"aws_rds_cluster\" \"app4-rds-cluster\" {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 50,
                  "Content": "  cluster_identifier      = \"app4-rds-cluster\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 51,
                  "Content": "  allocated_storage       = 10",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 52,
                  "Content": "  backup_retention_period = 15",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 53,
                  "Content": "  tags = {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 54,
                  "Content": "    git_commit           = \"079fe74f6b96d887c245664fbd8cf676c92f20e5\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 55,
                  "Content": "    git_file             = \"terraform/aws/rds.tf\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 56,
                  "Content": "    git_last_modified_at = \"2021-12-08 23:26:32\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 57,
                  "Content": "    git_last_modified_by = \"tron47@gmail.com\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 58,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "AVD-AWS-0079",
          "Title": "There is no encryption specified or encryption is disabled on the RDS Cluster.",
          "Description": "Encryption should be enabled for an RDS Aurora cluster. \n\nWhen enabling encryption by setting the kms_key_id, the storage_encrypted must also be set to true.",
          "Message": "Cluster does not have storage encryption enabled.",
          "Query": "data..",
          "Resolution": "Enable encryption for RDS clusters",
          "Severity": "HIGH",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0079",
          "References": [
            "https://docs.aws.amazon.com/AmazonRDS/latest/UserGuide/Overview.Encryption.html",
            "https://avd.aquasec.com/misconfig/avd-aws-0079"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "aws_rds_cluster.app3-rds-cluster",
            "Provider": "AWS",
            "Service": "rds",
            "StartLine": 33,
            "EndLine": 47,
            "Code": {
              "Lines": [
                {
                  "Number": 33,
                  "Content": "resource \"aws_rds_cluster\" \"app3-rds-cluster\" {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 34,
                  "Content": "  cluster_identifier      = \"app3-rds-cluster\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 35,
                  "Content": "  allocated_storage       = 10",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 36,
                  "Content": "  backup_retention_period = 15",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 37,
                  "Content": "  tags = {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 38,
                  "Content": "    git_commit           = \"079fe74f6b96d887c245664fbd8cf676c92f20e5\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 39,
                  "Content": "    git_file             = \"terraform/aws/rds.tf\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 40,
                  "Content": "    git_last_modified_at = \"2021-12-08 23:26:32\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 41,
                  "Content": "    git_last_modified_by = \"tron47@gmail.com\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 42,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        }
      ]
    },
    {
      "Target": "terraform/aws/resources/Dockerfile",
      "Class": "config",
      "Type": "dockerfile",
      "MisconfSummary": {
        "Successes": 21,
        "Failures": 1,
        "Exceptions": 0
      },
      "Misconfigurations": [
        {
          "Type": "Dockerfile Security Check",
          "ID": "DS002",
          "Title": "Image user should not be 'root'",
          "Description": "Running containers with 'root' user can lead to a container escape situation. It is a best practice to run containers as non-root users, which can be done by adding a 'USER' statement to the Dockerfile.",
          "Message": "Specify at least 1 USER command in Dockerfile with non-root user as argument",
          "Namespace": "builtin.dockerfile.DS002",
          "Query": "data.builtin.dockerfile.DS002.deny",
          "Resolution": "Add 'USER \u003cnon root user name\u003e' line to the Dockerfile",
          "Severity": "HIGH",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/ds002",
          "References": [
            "https://docs.docker.com/develop/develop-images/dockerfile_best-practices/",
            "https://avd.aquasec.com/misconfig/ds002"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Provider": "Dockerfile",
            "Service": "general",
            "Code": {
              "Lines": null
            }
          }
        }
      ]
    },
    {
      "Target": "terraform/aws/s3.tf",
      "Class": "config",
      "Type": "terraform",
      "MisconfSummary": {
        "Successes": 4,
        "Failures": 39,
        "Exceptions": 0
      },
      "Misconfigurations": [
        {
          "Type": "Terraform Security Check",
          "ID": "AVD-AWS-0086",
          "Title": "S3 Access block should block public ACL",
          "Description": "\nS3 buckets should block public ACLs on buckets and any objects they contain. By blocking, PUTs with fail if the object has any public ACL a.\n",
          "Message": "No public access block so not blocking public acls",
          "Query": "data..",
          "Resolution": "Enable blocking any PUT calls with a public ACL specified",
          "Severity": "HIGH",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0086",
          "References": [
            "https://docs.aws.amazon.com/AmazonS3/latest/userguide/access-control-block-public-access.html",
            "https://avd.aquasec.com/misconfig/avd-aws-0086"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "aws_s3_bucket.data_science",
            "Provider": "AWS",
            "Service": "s3",
            "StartLine": 91,
            "EndLine": 113,
            "Code": {
              "Lines": [
                {
                  "Number": 91,
                  "Content": "resource \"aws_s3_bucket\" \"data_science\" {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 92,
                  "Content": "  # bucket is not encrypted",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 93,
                  "Content": "  bucket = \"${local.resource_prefix.value}-data-science\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 94,
                  "Content": "  acl    = \"private\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 95,
                  "Content": "  versioning {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 96,
                  "Content": "    enabled = true",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 97,
                  "Content": "  }",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 98,
                  "Content": "  logging {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 99,
                  "Content": "    target_bucket = \"${aws_s3_bucket.logs.id}\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 100,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "AVD-AWS-0086",
          "Title": "S3 Access block should block public ACL",
          "Description": "\nS3 buckets should block public ACLs on buckets and any objects they contain. By blocking, PUTs with fail if the object has any public ACL a.\n",
          "Message": "No public access block so not blocking public acls",
          "Query": "data..",
          "Resolution": "Enable blocking any PUT calls with a public ACL specified",
          "Severity": "HIGH",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0086",
          "References": [
            "https://docs.aws.amazon.com/AmazonS3/latest/userguide/access-control-block-public-access.html",
            "https://avd.aquasec.com/misconfig/avd-aws-0086"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "aws_s3_bucket.operations",
            "Provider": "AWS",
            "Service": "s3",
            "StartLine": 66,
            "EndLine": 89,
            "Code": {
              "Lines": [
                {
                  "Number": 66,
                  "Content": "resource \"aws_s3_bucket\" \"operations\" {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 67,
                  "Content": "  # bucket is not encrypted",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 68,
                  "Content": "  # bucket does not have access logs",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 69,
                  "Content": "  bucket = \"${local.resource_prefix.value}-operations\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 70,
                  "Content": "  acl    = \"private\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 71,
                  "Content": "  versioning {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 72,
                  "Content": "    enabled = true",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 73,
                  "Content": "  }",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 74,
                  "Content": "  force_destroy = true",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 75,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "AVD-AWS-0086",
          "Title": "S3 Access block should block public ACL",
          "Description": "\nS3 buckets should block public ACLs on buckets and any objects they contain. By blocking, PUTs with fail if the object has any public ACL a.\n",
          "Message": "No public access block so not blocking public acls",
          "Query": "data..",
          "Resolution": "Enable blocking any PUT calls with a public ACL specified",
          "Severity": "HIGH",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0086",
          "References": [
            "https://docs.aws.amazon.com/AmazonS3/latest/userguide/access-control-block-public-access.html",
            "https://avd.aquasec.com/misconfig/avd-aws-0086"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "aws_s3_bucket.financials",
            "Provider": "AWS",
            "Service": "s3",
            "StartLine": 43,
            "EndLine": 64,
            "Code": {
              "Lines": [
                {
                  "Number": 43,
                  "Content": "resource \"aws_s3_bucket\" \"financials\" {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 44,
                  "Content": "  # bucket is not encrypted",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 45,
                  "Content": "  # bucket does not have access logs",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 46,
                  "Content": "  # bucket does not have versioning",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 47,
                  "Content": "  bucket        = \"${local.resource_prefix.value}-financials\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 48,
                  "Content": "  acl           = \"private\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 49,
                  "Content": "  force_destroy = true",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 50,
                  "Content": "  tags = merge({",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 51,
                  "Content": "    Name        = \"${local.resource_prefix.value}-financials\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 52,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "AVD-AWS-0086",
          "Title": "S3 Access block should block public ACL",
          "Description": "\nS3 buckets should block public ACLs on buckets and any objects they contain. By blocking, PUTs with fail if the object has any public ACL a.\n",
          "Message": "No public access block so not blocking public acls",
          "Query": "data..",
          "Resolution": "Enable blocking any PUT calls with a public ACL specified",
          "Severity": "HIGH",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0086",
          "References": [
            "https://docs.aws.amazon.com/AmazonS3/latest/userguide/access-control-block-public-access.html",
            "https://avd.aquasec.com/misconfig/avd-aws-0086"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "aws_s3_bucket.logs",
            "Provider": "AWS",
            "Service": "s3",
            "StartLine": 115,
            "EndLine": 143,
            "Code": {
              "Lines": [
                {
                  "Number": 115,
                  "Content": "resource \"aws_s3_bucket\" \"logs\" {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 116,
                  "Content": "  bucket = \"${local.resource_prefix.value}-logs\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 117,
                  "Content": "  acl    = \"log-delivery-write\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 118,
                  "Content": "  versioning {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 119,
                  "Content": "    enabled = true",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 120,
                  "Content": "  }",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 121,
                  "Content": "  server_side_encryption_configuration {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 122,
                  "Content": "    rule {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 123,
                  "Content": "      apply_server_side_encryption_by_default {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 124,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "AVD-AWS-0086",
          "Title": "S3 Access block should block public ACL",
          "Description": "\nS3 buckets should block public ACLs on buckets and any objects they contain. By blocking, PUTs with fail if the object has any public ACL a.\n",
          "Message": "No public access block so not blocking public acls",
          "Query": "data..",
          "Resolution": "Enable blocking any PUT calls with a public ACL specified",
          "Severity": "HIGH",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0086",
          "References": [
            "https://docs.aws.amazon.com/AmazonS3/latest/userguide/access-control-block-public-access.html",
            "https://avd.aquasec.com/misconfig/avd-aws-0086"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "aws_s3_bucket.data",
            "Provider": "AWS",
            "Service": "s3",
            "StartLine": 1,
            "EndLine": 22,
            "Code": {
              "Lines": [
                {
                  "Number": 1,
                  "Content": "resource \"aws_s3_bucket\" \"data\" {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 2,
                  "Content": "  # bucket is public",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 3,
                  "Content": "  # bucket is not encrypted",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 4,
                  "Content": "  # bucket does not have access logs",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 5,
                  "Content": "  # bucket does not have versioning",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 6,
                  "Content": "  bucket        = \"${local.resource_prefix.value}-data\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 7,
                  "Content": "  acl           = \"public-read\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 8,
                  "Content": "  force_destroy = true",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 9,
                  "Content": "  tags = merge({",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 10,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "AVD-AWS-0087",
          "Title": "S3 Access block should block public policy",
          "Description": "\nS3 bucket policy should have block public policy to prevent users from putting a policy that enable public access.\n",
          "Message": "No public access block so not blocking public policies",
          "Query": "data..",
          "Resolution": "Prevent policies that allow public access being PUT",
          "Severity": "HIGH",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0087",
          "References": [
            "https://docs.aws.amazon.com/AmazonS3/latest/dev-retired/access-control-block-public-access.html",
            "https://avd.aquasec.com/misconfig/avd-aws-0087"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "aws_s3_bucket.data_science",
            "Provider": "AWS",
            "Service": "s3",
            "StartLine": 91,
            "EndLine": 113,
            "Code": {
              "Lines": [
                {
                  "Number": 91,
                  "Content": "resource \"aws_s3_bucket\" \"data_science\" {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 92,
                  "Content": "  # bucket is not encrypted",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 93,
                  "Content": "  bucket = \"${local.resource_prefix.value}-data-science\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 94,
                  "Content": "  acl    = \"private\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 95,
                  "Content": "  versioning {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 96,
                  "Content": "    enabled = true",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 97,
                  "Content": "  }",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 98,
                  "Content": "  logging {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 99,
                  "Content": "    target_bucket = \"${aws_s3_bucket.logs.id}\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 100,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "AVD-AWS-0087",
          "Title": "S3 Access block should block public policy",
          "Description": "\nS3 bucket policy should have block public policy to prevent users from putting a policy that enable public access.\n",
          "Message": "No public access block so not blocking public policies",
          "Query": "data..",
          "Resolution": "Prevent policies that allow public access being PUT",
          "Severity": "HIGH",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0087",
          "References": [
            "https://docs.aws.amazon.com/AmazonS3/latest/dev-retired/access-control-block-public-access.html",
            "https://avd.aquasec.com/misconfig/avd-aws-0087"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "aws_s3_bucket.operations",
            "Provider": "AWS",
            "Service": "s3",
            "StartLine": 66,
            "EndLine": 89,
            "Code": {
              "Lines": [
                {
                  "Number": 66,
                  "Content": "resource \"aws_s3_bucket\" \"operations\" {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 67,
                  "Content": "  # bucket is not encrypted",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 68,
                  "Content": "  # bucket does not have access logs",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 69,
                  "Content": "  bucket = \"${local.resource_prefix.value}-operations\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 70,
                  "Content": "  acl    = \"private\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 71,
                  "Content": "  versioning {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 72,
                  "Content": "    enabled = true",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 73,
                  "Content": "  }",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 74,
                  "Content": "  force_destroy = true",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 75,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "AVD-AWS-0087",
          "Title": "S3 Access block should block public policy",
          "Description": "\nS3 bucket policy should have block public policy to prevent users from putting a policy that enable public access.\n",
          "Message": "No public access block so not blocking public policies",
          "Query": "data..",
          "Resolution": "Prevent policies that allow public access being PUT",
          "Severity": "HIGH",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0087",
          "References": [
            "https://docs.aws.amazon.com/AmazonS3/latest/dev-retired/access-control-block-public-access.html",
            "https://avd.aquasec.com/misconfig/avd-aws-0087"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "aws_s3_bucket.financials",
            "Provider": "AWS",
            "Service": "s3",
            "StartLine": 43,
            "EndLine": 64,
            "Code": {
              "Lines": [
                {
                  "Number": 43,
                  "Content": "resource \"aws_s3_bucket\" \"financials\" {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 44,
                  "Content": "  # bucket is not encrypted",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 45,
                  "Content": "  # bucket does not have access logs",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 46,
                  "Content": "  # bucket does not have versioning",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 47,
                  "Content": "  bucket        = \"${local.resource_prefix.value}-financials\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 48,
                  "Content": "  acl           = \"private\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 49,
                  "Content": "  force_destroy = true",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 50,
                  "Content": "  tags = merge({",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 51,
                  "Content": "    Name        = \"${local.resource_prefix.value}-financials\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 52,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "AVD-AWS-0087",
          "Title": "S3 Access block should block public policy",
          "Description": "\nS3 bucket policy should have block public policy to prevent users from putting a policy that enable public access.\n",
          "Message": "No public access block so not blocking public policies",
          "Query": "data..",
          "Resolution": "Prevent policies that allow public access being PUT",
          "Severity": "HIGH",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0087",
          "References": [
            "https://docs.aws.amazon.com/AmazonS3/latest/dev-retired/access-control-block-public-access.html",
            "https://avd.aquasec.com/misconfig/avd-aws-0087"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "aws_s3_bucket.logs",
            "Provider": "AWS",
            "Service": "s3",
            "StartLine": 115,
            "EndLine": 143,
            "Code": {
              "Lines": [
                {
                  "Number": 115,
                  "Content": "resource \"aws_s3_bucket\" \"logs\" {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 116,
                  "Content": "  bucket = \"${local.resource_prefix.value}-logs\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 117,
                  "Content": "  acl    = \"log-delivery-write\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 118,
                  "Content": "  versioning {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 119,
                  "Content": "    enabled = true",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 120,
                  "Content": "  }",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 121,
                  "Content": "  server_side_encryption_configuration {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 122,
                  "Content": "    rule {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 123,
                  "Content": "      apply_server_side_encryption_by_default {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 124,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "AVD-AWS-0087",
          "Title": "S3 Access block should block public policy",
          "Description": "\nS3 bucket policy should have block public policy to prevent users from putting a policy that enable public access.\n",
          "Message": "No public access block so not blocking public policies",
          "Query": "data..",
          "Resolution": "Prevent policies that allow public access being PUT",
          "Severity": "HIGH",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0087",
          "References": [
            "https://docs.aws.amazon.com/AmazonS3/latest/dev-retired/access-control-block-public-access.html",
            "https://avd.aquasec.com/misconfig/avd-aws-0087"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "aws_s3_bucket.data",
            "Provider": "AWS",
            "Service": "s3",
            "StartLine": 1,
            "EndLine": 22,
            "Code": {
              "Lines": [
                {
                  "Number": 1,
                  "Content": "resource \"aws_s3_bucket\" \"data\" {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 2,
                  "Content": "  # bucket is public",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 3,
                  "Content": "  # bucket is not encrypted",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 4,
                  "Content": "  # bucket does not have access logs",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 5,
                  "Content": "  # bucket does not have versioning",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 6,
                  "Content": "  bucket        = \"${local.resource_prefix.value}-data\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 7,
                  "Content": "  acl           = \"public-read\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 8,
                  "Content": "  force_destroy = true",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 9,
                  "Content": "  tags = merge({",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 10,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "AVD-AWS-0088",
          "Title": "Unencrypted S3 bucket.",
          "Description": "S3 Buckets should be encrypted to protect the data that is stored within them if access is compromised.",
          "Message": "Bucket does not have encryption enabled",
          "Query": "data..",
          "Resolution": "Configure bucket encryption",
          "Severity": "HIGH",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0088",
          "References": [
            "https://docs.aws.amazon.com/AmazonS3/latest/userguide/bucket-encryption.html",
            "https://avd.aquasec.com/misconfig/avd-aws-0088"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "aws_s3_bucket.data_science",
            "Provider": "AWS",
            "Service": "s3",
            "StartLine": 91,
            "EndLine": 113,
            "Code": {
              "Lines": [
                {
                  "Number": 91,
                  "Content": "resource \"aws_s3_bucket\" \"data_science\" {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 92,
                  "Content": "  # bucket is not encrypted",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 93,
                  "Content": "  bucket = \"${local.resource_prefix.value}-data-science\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 94,
                  "Content": "  acl    = \"private\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 95,
                  "Content": "  versioning {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 96,
                  "Content": "    enabled = true",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 97,
                  "Content": "  }",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 98,
                  "Content": "  logging {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 99,
                  "Content": "    target_bucket = \"${aws_s3_bucket.logs.id}\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 100,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "AVD-AWS-0088",
          "Title": "Unencrypted S3 bucket.",
          "Description": "S3 Buckets should be encrypted to protect the data that is stored within them if access is compromised.",
          "Message": "Bucket does not have encryption enabled",
          "Query": "data..",
          "Resolution": "Configure bucket encryption",
          "Severity": "HIGH",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0088",
          "References": [
            "https://docs.aws.amazon.com/AmazonS3/latest/userguide/bucket-encryption.html",
            "https://avd.aquasec.com/misconfig/avd-aws-0088"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "aws_s3_bucket.operations",
            "Provider": "AWS",
            "Service": "s3",
            "StartLine": 66,
            "EndLine": 89,
            "Code": {
              "Lines": [
                {
                  "Number": 66,
                  "Content": "resource \"aws_s3_bucket\" \"operations\" {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 67,
                  "Content": "  # bucket is not encrypted",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 68,
                  "Content": "  # bucket does not have access logs",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 69,
                  "Content": "  bucket = \"${local.resource_prefix.value}-operations\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 70,
                  "Content": "  acl    = \"private\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 71,
                  "Content": "  versioning {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 72,
                  "Content": "    enabled = true",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 73,
                  "Content": "  }",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 74,
                  "Content": "  force_destroy = true",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 75,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "AVD-AWS-0088",
          "Title": "Unencrypted S3 bucket.",
          "Description": "S3 Buckets should be encrypted to protect the data that is stored within them if access is compromised.",
          "Message": "Bucket does not have encryption enabled",
          "Query": "data..",
          "Resolution": "Configure bucket encryption",
          "Severity": "HIGH",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0088",
          "References": [
            "https://docs.aws.amazon.com/AmazonS3/latest/userguide/bucket-encryption.html",
            "https://avd.aquasec.com/misconfig/avd-aws-0088"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "aws_s3_bucket.financials",
            "Provider": "AWS",
            "Service": "s3",
            "StartLine": 43,
            "EndLine": 64,
            "Code": {
              "Lines": [
                {
                  "Number": 43,
                  "Content": "resource \"aws_s3_bucket\" \"financials\" {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 44,
                  "Content": "  # bucket is not encrypted",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 45,
                  "Content": "  # bucket does not have access logs",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 46,
                  "Content": "  # bucket does not have versioning",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 47,
                  "Content": "  bucket        = \"${local.resource_prefix.value}-financials\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 48,
                  "Content": "  acl           = \"private\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 49,
                  "Content": "  force_destroy = true",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 50,
                  "Content": "  tags = merge({",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 51,
                  "Content": "    Name        = \"${local.resource_prefix.value}-financials\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 52,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "AVD-AWS-0088",
          "Title": "Unencrypted S3 bucket.",
          "Description": "S3 Buckets should be encrypted to protect the data that is stored within them if access is compromised.",
          "Message": "Bucket does not have encryption enabled",
          "Query": "data..",
          "Resolution": "Configure bucket encryption",
          "Severity": "HIGH",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0088",
          "References": [
            "https://docs.aws.amazon.com/AmazonS3/latest/userguide/bucket-encryption.html",
            "https://avd.aquasec.com/misconfig/avd-aws-0088"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "aws_s3_bucket.data",
            "Provider": "AWS",
            "Service": "s3",
            "StartLine": 1,
            "EndLine": 22,
            "Code": {
              "Lines": [
                {
                  "Number": 1,
                  "Content": "resource \"aws_s3_bucket\" \"data\" {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 2,
                  "Content": "  # bucket is public",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 3,
                  "Content": "  # bucket is not encrypted",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 4,
                  "Content": "  # bucket does not have access logs",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 5,
                  "Content": "  # bucket does not have versioning",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 6,
                  "Content": "  bucket        = \"${local.resource_prefix.value}-data\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 7,
                  "Content": "  acl           = \"public-read\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 8,
                  "Content": "  force_destroy = true",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 9,
                  "Content": "  tags = merge({",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 10,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "AVD-AWS-0089",
          "Title": "S3 Bucket does not have logging enabled.",
          "Description": "Buckets should have logging enabled so that access can be audited.",
          "Message": "Bucket does not have logging enabled",
          "Query": "data..",
          "Resolution": "Add a logging block to the resource to enable access logging",
          "Severity": "MEDIUM",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0089",
          "References": [
            "https://docs.aws.amazon.com/AmazonS3/latest/dev/ServerLogs.html",
            "https://avd.aquasec.com/misconfig/avd-aws-0089"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "aws_s3_bucket.operations",
            "Provider": "AWS",
            "Service": "s3",
            "StartLine": 66,
            "EndLine": 89,
            "Code": {
              "Lines": [
                {
                  "Number": 66,
                  "Content": "resource \"aws_s3_bucket\" \"operations\" {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 67,
                  "Content": "  # bucket is not encrypted",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 68,
                  "Content": "  # bucket does not have access logs",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 69,
                  "Content": "  bucket = \"${local.resource_prefix.value}-operations\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 70,
                  "Content": "  acl    = \"private\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 71,
                  "Content": "  versioning {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 72,
                  "Content": "    enabled = true",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 73,
                  "Content": "  }",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 74,
                  "Content": "  force_destroy = true",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 75,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "AVD-AWS-0089",
          "Title": "S3 Bucket does not have logging enabled.",
          "Description": "Buckets should have logging enabled so that access can be audited.",
          "Message": "Bucket does not have logging enabled",
          "Query": "data..",
          "Resolution": "Add a logging block to the resource to enable access logging",
          "Severity": "MEDIUM",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0089",
          "References": [
            "https://docs.aws.amazon.com/AmazonS3/latest/dev/ServerLogs.html",
            "https://avd.aquasec.com/misconfig/avd-aws-0089"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "aws_s3_bucket.financials",
            "Provider": "AWS",
            "Service": "s3",
            "StartLine": 43,
            "EndLine": 64,
            "Code": {
              "Lines": [
                {
                  "Number": 43,
                  "Content": "resource \"aws_s3_bucket\" \"financials\" {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 44,
                  "Content": "  # bucket is not encrypted",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 45,
                  "Content": "  # bucket does not have access logs",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 46,
                  "Content": "  # bucket does not have versioning",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 47,
                  "Content": "  bucket        = \"${local.resource_prefix.value}-financials\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 48,
                  "Content": "  acl           = \"private\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 49,
                  "Content": "  force_destroy = true",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 50,
                  "Content": "  tags = merge({",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 51,
                  "Content": "    Name        = \"${local.resource_prefix.value}-financials\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 52,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "AVD-AWS-0089",
          "Title": "S3 Bucket does not have logging enabled.",
          "Description": "Buckets should have logging enabled so that access can be audited.",
          "Message": "Bucket does not have logging enabled",
          "Query": "data..",
          "Resolution": "Add a logging block to the resource to enable access logging",
          "Severity": "MEDIUM",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0089",
          "References": [
            "https://docs.aws.amazon.com/AmazonS3/latest/dev/ServerLogs.html",
            "https://avd.aquasec.com/misconfig/avd-aws-0089"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "aws_s3_bucket.data",
            "Provider": "AWS",
            "Service": "s3",
            "StartLine": 1,
            "EndLine": 22,
            "Code": {
              "Lines": [
                {
                  "Number": 1,
                  "Content": "resource \"aws_s3_bucket\" \"data\" {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 2,
                  "Content": "  # bucket is public",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 3,
                  "Content": "  # bucket is not encrypted",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 4,
                  "Content": "  # bucket does not have access logs",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 5,
                  "Content": "  # bucket does not have versioning",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 6,
                  "Content": "  bucket        = \"${local.resource_prefix.value}-data\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 7,
                  "Content": "  acl           = \"public-read\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 8,
                  "Content": "  force_destroy = true",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 9,
                  "Content": "  tags = merge({",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 10,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "AVD-AWS-0090",
          "Title": "S3 Data should be versioned",
          "Description": "\nVersioning in Amazon S3 is a means of keeping multiple variants of an object in the same bucket. \nYou can use the S3 Versioning feature to preserve, retrieve, and restore every version of every object stored in your buckets. \nWith versioning you can recover more easily from both unintended user actions and application failures.\n",
          "Message": "Bucket does not have versioning enabled",
          "Query": "data..",
          "Resolution": "Enable versioning to protect against accidental/malicious removal or modification",
          "Severity": "MEDIUM",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0090",
          "References": [
            "https://docs.aws.amazon.com/AmazonS3/latest/userguide/Versioning.html",
            "https://avd.aquasec.com/misconfig/avd-aws-0090"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "aws_s3_bucket.financials",
            "Provider": "AWS",
            "Service": "s3",
            "StartLine": 43,
            "EndLine": 64,
            "Code": {
              "Lines": [
                {
                  "Number": 43,
                  "Content": "resource \"aws_s3_bucket\" \"financials\" {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 44,
                  "Content": "  # bucket is not encrypted",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 45,
                  "Content": "  # bucket does not have access logs",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 46,
                  "Content": "  # bucket does not have versioning",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 47,
                  "Content": "  bucket        = \"${local.resource_prefix.value}-financials\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 48,
                  "Content": "  acl           = \"private\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 49,
                  "Content": "  force_destroy = true",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 50,
                  "Content": "  tags = merge({",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 51,
                  "Content": "    Name        = \"${local.resource_prefix.value}-financials\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 52,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "AVD-AWS-0090",
          "Title": "S3 Data should be versioned",
          "Description": "\nVersioning in Amazon S3 is a means of keeping multiple variants of an object in the same bucket. \nYou can use the S3 Versioning feature to preserve, retrieve, and restore every version of every object stored in your buckets. \nWith versioning you can recover more easily from both unintended user actions and application failures.\n",
          "Message": "Bucket does not have versioning enabled",
          "Query": "data..",
          "Resolution": "Enable versioning to protect against accidental/malicious removal or modification",
          "Severity": "MEDIUM",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0090",
          "References": [
            "https://docs.aws.amazon.com/AmazonS3/latest/userguide/Versioning.html",
            "https://avd.aquasec.com/misconfig/avd-aws-0090"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "aws_s3_bucket.data",
            "Provider": "AWS",
            "Service": "s3",
            "StartLine": 1,
            "EndLine": 22,
            "Code": {
              "Lines": [
                {
                  "Number": 1,
                  "Content": "resource \"aws_s3_bucket\" \"data\" {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 2,
                  "Content": "  # bucket is public",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 3,
                  "Content": "  # bucket is not encrypted",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 4,
                  "Content": "  # bucket does not have access logs",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 5,
                  "Content": "  # bucket does not have versioning",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 6,
                  "Content": "  bucket        = \"${local.resource_prefix.value}-data\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 7,
                  "Content": "  acl           = \"public-read\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 8,
                  "Content": "  force_destroy = true",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 9,
                  "Content": "  tags = merge({",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 10,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "AVD-AWS-0091",
          "Title": "S3 Access Block should Ignore Public Acl",
          "Description": "\nS3 buckets should ignore public ACLs on buckets and any objects they contain. By ignoring rather than blocking, PUT calls with public ACLs will still be applied but the ACL will be ignored.\n",
          "Message": "No public access block so not ignoring public acls",
          "Query": "data..",
          "Resolution": "Enable ignoring the application of public ACLs in PUT calls",
          "Severity": "HIGH",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0091",
          "References": [
            "https://docs.aws.amazon.com/AmazonS3/latest/userguide/access-control-block-public-access.html",
            "https://avd.aquasec.com/misconfig/avd-aws-0091"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "aws_s3_bucket.financials",
            "Provider": "AWS",
            "Service": "s3",
            "StartLine": 43,
            "EndLine": 64,
            "Code": {
              "Lines": [
                {
                  "Number": 43,
                  "Content": "resource \"aws_s3_bucket\" \"financials\" {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 44,
                  "Content": "  # bucket is not encrypted",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 45,
                  "Content": "  # bucket does not have access logs",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 46,
                  "Content": "  # bucket does not have versioning",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 47,
                  "Content": "  bucket        = \"${local.resource_prefix.value}-financials\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 48,
                  "Content": "  acl           = \"private\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 49,
                  "Content": "  force_destroy = true",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 50,
                  "Content": "  tags = merge({",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 51,
                  "Content": "    Name        = \"${local.resource_prefix.value}-financials\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 52,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "AVD-AWS-0091",
          "Title": "S3 Access Block should Ignore Public Acl",
          "Description": "\nS3 buckets should ignore public ACLs on buckets and any objects they contain. By ignoring rather than blocking, PUT calls with public ACLs will still be applied but the ACL will be ignored.\n",
          "Message": "No public access block so not ignoring public acls",
          "Query": "data..",
          "Resolution": "Enable ignoring the application of public ACLs in PUT calls",
          "Severity": "HIGH",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0091",
          "References": [
            "https://docs.aws.amazon.com/AmazonS3/latest/userguide/access-control-block-public-access.html",
            "https://avd.aquasec.com/misconfig/avd-aws-0091"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "aws_s3_bucket.data_science",
            "Provider": "AWS",
            "Service": "s3",
            "StartLine": 91,
            "EndLine": 113,
            "Code": {
              "Lines": [
                {
                  "Number": 91,
                  "Content": "resource \"aws_s3_bucket\" \"data_science\" {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 92,
                  "Content": "  # bucket is not encrypted",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 93,
                  "Content": "  bucket = \"${local.resource_prefix.value}-data-science\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 94,
                  "Content": "  acl    = \"private\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 95,
                  "Content": "  versioning {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 96,
                  "Content": "    enabled = true",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 97,
                  "Content": "  }",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 98,
                  "Content": "  logging {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 99,
                  "Content": "    target_bucket = \"${aws_s3_bucket.logs.id}\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 100,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "AVD-AWS-0091",
          "Title": "S3 Access Block should Ignore Public Acl",
          "Description": "\nS3 buckets should ignore public ACLs on buckets and any objects they contain. By ignoring rather than blocking, PUT calls with public ACLs will still be applied but the ACL will be ignored.\n",
          "Message": "No public access block so not ignoring public acls",
          "Query": "data..",
          "Resolution": "Enable ignoring the application of public ACLs in PUT calls",
          "Severity": "HIGH",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0091",
          "References": [
            "https://docs.aws.amazon.com/AmazonS3/latest/userguide/access-control-block-public-access.html",
            "https://avd.aquasec.com/misconfig/avd-aws-0091"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "aws_s3_bucket.data",
            "Provider": "AWS",
            "Service": "s3",
            "StartLine": 1,
            "EndLine": 22,
            "Code": {
              "Lines": [
                {
                  "Number": 1,
                  "Content": "resource \"aws_s3_bucket\" \"data\" {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 2,
                  "Content": "  # bucket is public",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 3,
                  "Content": "  # bucket is not encrypted",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 4,
                  "Content": "  # bucket does not have access logs",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 5,
                  "Content": "  # bucket does not have versioning",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 6,
                  "Content": "  bucket        = \"${local.resource_prefix.value}-data\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 7,
                  "Content": "  acl           = \"public-read\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 8,
                  "Content": "  force_destroy = true",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 9,
                  "Content": "  tags = merge({",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 10,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "AVD-AWS-0091",
          "Title": "S3 Access Block should Ignore Public Acl",
          "Description": "\nS3 buckets should ignore public ACLs on buckets and any objects they contain. By ignoring rather than blocking, PUT calls with public ACLs will still be applied but the ACL will be ignored.\n",
          "Message": "No public access block so not ignoring public acls",
          "Query": "data..",
          "Resolution": "Enable ignoring the application of public ACLs in PUT calls",
          "Severity": "HIGH",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0091",
          "References": [
            "https://docs.aws.amazon.com/AmazonS3/latest/userguide/access-control-block-public-access.html",
            "https://avd.aquasec.com/misconfig/avd-aws-0091"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "aws_s3_bucket.logs",
            "Provider": "AWS",
            "Service": "s3",
            "StartLine": 115,
            "EndLine": 143,
            "Code": {
              "Lines": [
                {
                  "Number": 115,
                  "Content": "resource \"aws_s3_bucket\" \"logs\" {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 116,
                  "Content": "  bucket = \"${local.resource_prefix.value}-logs\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 117,
                  "Content": "  acl    = \"log-delivery-write\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 118,
                  "Content": "  versioning {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 119,
                  "Content": "    enabled = true",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 120,
                  "Content": "  }",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 121,
                  "Content": "  server_side_encryption_configuration {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 122,
                  "Content": "    rule {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 123,
                  "Content": "      apply_server_side_encryption_by_default {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 124,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "AVD-AWS-0091",
          "Title": "S3 Access Block should Ignore Public Acl",
          "Description": "\nS3 buckets should ignore public ACLs on buckets and any objects they contain. By ignoring rather than blocking, PUT calls with public ACLs will still be applied but the ACL will be ignored.\n",
          "Message": "No public access block so not ignoring public acls",
          "Query": "data..",
          "Resolution": "Enable ignoring the application of public ACLs in PUT calls",
          "Severity": "HIGH",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0091",
          "References": [
            "https://docs.aws.amazon.com/AmazonS3/latest/userguide/access-control-block-public-access.html",
            "https://avd.aquasec.com/misconfig/avd-aws-0091"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "aws_s3_bucket.operations",
            "Provider": "AWS",
            "Service": "s3",
            "StartLine": 66,
            "EndLine": 89,
            "Code": {
              "Lines": [
                {
                  "Number": 66,
                  "Content": "resource \"aws_s3_bucket\" \"operations\" {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 67,
                  "Content": "  # bucket is not encrypted",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 68,
                  "Content": "  # bucket does not have access logs",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 69,
                  "Content": "  bucket = \"${local.resource_prefix.value}-operations\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 70,
                  "Content": "  acl    = \"private\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 71,
                  "Content": "  versioning {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 72,
                  "Content": "    enabled = true",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 73,
                  "Content": "  }",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 74,
                  "Content": "  force_destroy = true",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 75,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "AVD-AWS-0092",
          "Title": "S3 Buckets not publicly accessible through ACL.",
          "Description": "\nBuckets should not have ACLs that allow public access\n",
          "Message": "Bucket has a public ACL: 'public-read'.",
          "Query": "data..",
          "Resolution": "Don't use canned ACLs or switch to private acl",
          "Severity": "HIGH",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0092",
          "References": [
            "https://docs.aws.amazon.com/AmazonS3/latest/userguide/acl-overview.html",
            "https://avd.aquasec.com/misconfig/avd-aws-0092"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "aws_s3_bucket.data",
            "Provider": "AWS",
            "Service": "s3",
            "StartLine": 7,
            "EndLine": 7,
            "Code": {
              "Lines": [
                {
                  "Number": 1,
                  "Content": "resource \"aws_s3_bucket\" \"data\" {",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 2,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 7,
                  "Content": "  acl           = \"public-read\"",
                  "IsCause": true,
                  "Annotation": "\"public-read\"",
                  "Truncated": false,
                  "FirstCause": true,
                  "LastCause": true
                },
                {
                  "Number": 21,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 22,
                  "Content": "}",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "AVD-AWS-0093",
          "Title": "S3 Access block should restrict public bucket to limit access",
          "Description": "S3 buckets should restrict public policies for the bucket. By enabling, the restrict_public_buckets, only the bucket owner and AWS Services can access if it has a public policy.",
          "Message": "No public access block so not restricting public buckets",
          "Query": "data..",
          "Resolution": "Limit the access to public buckets to only the owner or AWS Services (eg; CloudFront)",
          "Severity": "HIGH",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0093",
          "References": [
            "https://docs.aws.amazon.com/AmazonS3/latest/dev-retired/access-control-block-public-access.html",
            "https://avd.aquasec.com/misconfig/avd-aws-0093"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "aws_s3_bucket.operations",
            "Provider": "AWS",
            "Service": "s3",
            "StartLine": 66,
            "EndLine": 89,
            "Code": {
              "Lines": [
                {
                  "Number": 66,
                  "Content": "resource \"aws_s3_bucket\" \"operations\" {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 67,
                  "Content": "  # bucket is not encrypted",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 68,
                  "Content": "  # bucket does not have access logs",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 69,
                  "Content": "  bucket = \"${local.resource_prefix.value}-operations\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 70,
                  "Content": "  acl    = \"private\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 71,
                  "Content": "  versioning {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 72,
                  "Content": "    enabled = true",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 73,
                  "Content": "  }",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 74,
                  "Content": "  force_destroy = true",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 75,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "AVD-AWS-0093",
          "Title": "S3 Access block should restrict public bucket to limit access",
          "Description": "S3 buckets should restrict public policies for the bucket. By enabling, the restrict_public_buckets, only the bucket owner and AWS Services can access if it has a public policy.",
          "Message": "No public access block so not restricting public buckets",
          "Query": "data..",
          "Resolution": "Limit the access to public buckets to only the owner or AWS Services (eg; CloudFront)",
          "Severity": "HIGH",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0093",
          "References": [
            "https://docs.aws.amazon.com/AmazonS3/latest/dev-retired/access-control-block-public-access.html",
            "https://avd.aquasec.com/misconfig/avd-aws-0093"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "aws_s3_bucket.financials",
            "Provider": "AWS",
            "Service": "s3",
            "StartLine": 43,
            "EndLine": 64,
            "Code": {
              "Lines": [
                {
                  "Number": 43,
                  "Content": "resource \"aws_s3_bucket\" \"financials\" {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 44,
                  "Content": "  # bucket is not encrypted",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 45,
                  "Content": "  # bucket does not have access logs",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 46,
                  "Content": "  # bucket does not have versioning",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 47,
                  "Content": "  bucket        = \"${local.resource_prefix.value}-financials\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 48,
                  "Content": "  acl           = \"private\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 49,
                  "Content": "  force_destroy = true",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 50,
                  "Content": "  tags = merge({",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 51,
                  "Content": "    Name        = \"${local.resource_prefix.value}-financials\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 52,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "AVD-AWS-0093",
          "Title": "S3 Access block should restrict public bucket to limit access",
          "Description": "S3 buckets should restrict public policies for the bucket. By enabling, the restrict_public_buckets, only the bucket owner and AWS Services can access if it has a public policy.",
          "Message": "No public access block so not restricting public buckets",
          "Query": "data..",
          "Resolution": "Limit the access to public buckets to only the owner or AWS Services (eg; CloudFront)",
          "Severity": "HIGH",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0093",
          "References": [
            "https://docs.aws.amazon.com/AmazonS3/latest/dev-retired/access-control-block-public-access.html",
            "https://avd.aquasec.com/misconfig/avd-aws-0093"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "aws_s3_bucket.logs",
            "Provider": "AWS",
            "Service": "s3",
            "StartLine": 115,
            "EndLine": 143,
            "Code": {
              "Lines": [
                {
                  "Number": 115,
                  "Content": "resource \"aws_s3_bucket\" \"logs\" {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 116,
                  "Content": "  bucket = \"${local.resource_prefix.value}-logs\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 117,
                  "Content": "  acl    = \"log-delivery-write\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 118,
                  "Content": "  versioning {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 119,
                  "Content": "    enabled = true",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 120,
                  "Content": "  }",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 121,
                  "Content": "  server_side_encryption_configuration {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 122,
                  "Content": "    rule {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 123,
                  "Content": "      apply_server_side_encryption_by_default {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 124,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "AVD-AWS-0093",
          "Title": "S3 Access block should restrict public bucket to limit access",
          "Description": "S3 buckets should restrict public policies for the bucket. By enabling, the restrict_public_buckets, only the bucket owner and AWS Services can access if it has a public policy.",
          "Message": "No public access block so not restricting public buckets",
          "Query": "data..",
          "Resolution": "Limit the access to public buckets to only the owner or AWS Services (eg; CloudFront)",
          "Severity": "HIGH",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0093",
          "References": [
            "https://docs.aws.amazon.com/AmazonS3/latest/dev-retired/access-control-block-public-access.html",
            "https://avd.aquasec.com/misconfig/avd-aws-0093"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "aws_s3_bucket.data",
            "Provider": "AWS",
            "Service": "s3",
            "StartLine": 1,
            "EndLine": 22,
            "Code": {
              "Lines": [
                {
                  "Number": 1,
                  "Content": "resource \"aws_s3_bucket\" \"data\" {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 2,
                  "Content": "  # bucket is public",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 3,
                  "Content": "  # bucket is not encrypted",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 4,
                  "Content": "  # bucket does not have access logs",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 5,
                  "Content": "  # bucket does not have versioning",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 6,
                  "Content": "  bucket        = \"${local.resource_prefix.value}-data\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 7,
                  "Content": "  acl           = \"public-read\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 8,
                  "Content": "  force_destroy = true",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 9,
                  "Content": "  tags = merge({",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 10,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "AVD-AWS-0093",
          "Title": "S3 Access block should restrict public bucket to limit access",
          "Description": "S3 buckets should restrict public policies for the bucket. By enabling, the restrict_public_buckets, only the bucket owner and AWS Services can access if it has a public policy.",
          "Message": "No public access block so not restricting public buckets",
          "Query": "data..",
          "Resolution": "Limit the access to public buckets to only the owner or AWS Services (eg; CloudFront)",
          "Severity": "HIGH",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0093",
          "References": [
            "https://docs.aws.amazon.com/AmazonS3/latest/dev-retired/access-control-block-public-access.html",
            "https://avd.aquasec.com/misconfig/avd-aws-0093"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "aws_s3_bucket.data_science",
            "Provider": "AWS",
            "Service": "s3",
            "StartLine": 91,
            "EndLine": 113,
            "Code": {
              "Lines": [
                {
                  "Number": 91,
                  "Content": "resource \"aws_s3_bucket\" \"data_science\" {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 92,
                  "Content": "  # bucket is not encrypted",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 93,
                  "Content": "  bucket = \"${local.resource_prefix.value}-data-science\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 94,
                  "Content": "  acl    = \"private\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 95,
                  "Content": "  versioning {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 96,
                  "Content": "    enabled = true",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 97,
                  "Content": "  }",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 98,
                  "Content": "  logging {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 99,
                  "Content": "    target_bucket = \"${aws_s3_bucket.logs.id}\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 100,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "AVD-AWS-0094",
          "Title": "S3 buckets should each define an aws_s3_bucket_public_access_block",
          "Description": "The \"block public access\" settings in S3 override individual policies that apply to a given bucket, meaning that all public access can be controlled in one central types for that bucket. It is therefore good practice to define these settings for each bucket in order to clearly define the public access that can be allowed for it.",
          "Message": "Bucket does not have a corresponding public access block.",
          "Query": "data..",
          "Resolution": "Define a aws_s3_bucket_public_access_block for the given bucket to control public access policies",
          "Severity": "LOW",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0094",
          "References": [
            "https://docs.aws.amazon.com/AmazonS3/latest/userguide/access-control-block-public-access.html",
            "https://avd.aquasec.com/misconfig/avd-aws-0094"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "aws_s3_bucket.data",
            "Provider": "AWS",
            "Service": "s3",
            "StartLine": 1,
            "EndLine": 22,
            "Code": {
              "Lines": [
                {
                  "Number": 1,
                  "Content": "resource \"aws_s3_bucket\" \"data\" {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 2,
                  "Content": "  # bucket is public",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 3,
                  "Content": "  # bucket is not encrypted",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 4,
                  "Content": "  # bucket does not have access logs",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 5,
                  "Content": "  # bucket does not have versioning",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 6,
                  "Content": "  bucket        = \"${local.resource_prefix.value}-data\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 7,
                  "Content": "  acl           = \"public-read\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 8,
                  "Content": "  force_destroy = true",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 9,
                  "Content": "  tags = merge({",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 10,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "AVD-AWS-0094",
          "Title": "S3 buckets should each define an aws_s3_bucket_public_access_block",
          "Description": "The \"block public access\" settings in S3 override individual policies that apply to a given bucket, meaning that all public access can be controlled in one central types for that bucket. It is therefore good practice to define these settings for each bucket in order to clearly define the public access that can be allowed for it.",
          "Message": "Bucket does not have a corresponding public access block.",
          "Query": "data..",
          "Resolution": "Define a aws_s3_bucket_public_access_block for the given bucket to control public access policies",
          "Severity": "LOW",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0094",
          "References": [
            "https://docs.aws.amazon.com/AmazonS3/latest/userguide/access-control-block-public-access.html",
            "https://avd.aquasec.com/misconfig/avd-aws-0094"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "aws_s3_bucket.operations",
            "Provider": "AWS",
            "Service": "s3",
            "StartLine": 66,
            "EndLine": 89,
            "Code": {
              "Lines": [
                {
                  "Number": 66,
                  "Content": "resource \"aws_s3_bucket\" \"operations\" {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 67,
                  "Content": "  # bucket is not encrypted",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 68,
                  "Content": "  # bucket does not have access logs",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 69,
                  "Content": "  bucket = \"${local.resource_prefix.value}-operations\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 70,
                  "Content": "  acl    = \"private\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 71,
                  "Content": "  versioning {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 72,
                  "Content": "    enabled = true",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 73,
                  "Content": "  }",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 74,
                  "Content": "  force_destroy = true",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 75,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "AVD-AWS-0094",
          "Title": "S3 buckets should each define an aws_s3_bucket_public_access_block",
          "Description": "The \"block public access\" settings in S3 override individual policies that apply to a given bucket, meaning that all public access can be controlled in one central types for that bucket. It is therefore good practice to define these settings for each bucket in order to clearly define the public access that can be allowed for it.",
          "Message": "Bucket does not have a corresponding public access block.",
          "Query": "data..",
          "Resolution": "Define a aws_s3_bucket_public_access_block for the given bucket to control public access policies",
          "Severity": "LOW",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0094",
          "References": [
            "https://docs.aws.amazon.com/AmazonS3/latest/userguide/access-control-block-public-access.html",
            "https://avd.aquasec.com/misconfig/avd-aws-0094"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "aws_s3_bucket.financials",
            "Provider": "AWS",
            "Service": "s3",
            "StartLine": 43,
            "EndLine": 64,
            "Code": {
              "Lines": [
                {
                  "Number": 43,
                  "Content": "resource \"aws_s3_bucket\" \"financials\" {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 44,
                  "Content": "  # bucket is not encrypted",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 45,
                  "Content": "  # bucket does not have access logs",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 46,
                  "Content": "  # bucket does not have versioning",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 47,
                  "Content": "  bucket        = \"${local.resource_prefix.value}-financials\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 48,
                  "Content": "  acl           = \"private\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 49,
                  "Content": "  force_destroy = true",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 50,
                  "Content": "  tags = merge({",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 51,
                  "Content": "    Name        = \"${local.resource_prefix.value}-financials\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 52,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "AVD-AWS-0094",
          "Title": "S3 buckets should each define an aws_s3_bucket_public_access_block",
          "Description": "The \"block public access\" settings in S3 override individual policies that apply to a given bucket, meaning that all public access can be controlled in one central types for that bucket. It is therefore good practice to define these settings for each bucket in order to clearly define the public access that can be allowed for it.",
          "Message": "Bucket does not have a corresponding public access block.",
          "Query": "data..",
          "Resolution": "Define a aws_s3_bucket_public_access_block for the given bucket to control public access policies",
          "Severity": "LOW",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0094",
          "References": [
            "https://docs.aws.amazon.com/AmazonS3/latest/userguide/access-control-block-public-access.html",
            "https://avd.aquasec.com/misconfig/avd-aws-0094"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "aws_s3_bucket.logs",
            "Provider": "AWS",
            "Service": "s3",
            "StartLine": 115,
            "EndLine": 143,
            "Code": {
              "Lines": [
                {
                  "Number": 115,
                  "Content": "resource \"aws_s3_bucket\" \"logs\" {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 116,
                  "Content": "  bucket = \"${local.resource_prefix.value}-logs\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 117,
                  "Content": "  acl    = \"log-delivery-write\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 118,
                  "Content": "  versioning {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 119,
                  "Content": "    enabled = true",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 120,
                  "Content": "  }",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 121,
                  "Content": "  server_side_encryption_configuration {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 122,
                  "Content": "    rule {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 123,
                  "Content": "      apply_server_side_encryption_by_default {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 124,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "AVD-AWS-0094",
          "Title": "S3 buckets should each define an aws_s3_bucket_public_access_block",
          "Description": "The \"block public access\" settings in S3 override individual policies that apply to a given bucket, meaning that all public access can be controlled in one central types for that bucket. It is therefore good practice to define these settings for each bucket in order to clearly define the public access that can be allowed for it.",
          "Message": "Bucket does not have a corresponding public access block.",
          "Query": "data..",
          "Resolution": "Define a aws_s3_bucket_public_access_block for the given bucket to control public access policies",
          "Severity": "LOW",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0094",
          "References": [
            "https://docs.aws.amazon.com/AmazonS3/latest/userguide/access-control-block-public-access.html",
            "https://avd.aquasec.com/misconfig/avd-aws-0094"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "aws_s3_bucket.data_science",
            "Provider": "AWS",
            "Service": "s3",
            "StartLine": 91,
            "EndLine": 113,
            "Code": {
              "Lines": [
                {
                  "Number": 91,
                  "Content": "resource \"aws_s3_bucket\" \"data_science\" {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 92,
                  "Content": "  # bucket is not encrypted",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 93,
                  "Content": "  bucket = \"${local.resource_prefix.value}-data-science\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 94,
                  "Content": "  acl    = \"private\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 95,
                  "Content": "  versioning {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 96,
                  "Content": "    enabled = true",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 97,
                  "Content": "  }",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 98,
                  "Content": "  logging {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 99,
                  "Content": "    target_bucket = \"${aws_s3_bucket.logs.id}\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 100,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "AVD-AWS-0132",
          "Title": "S3 encryption should use Customer Managed Keys",
          "Description": "Encryption using AWS keys provides protection for your S3 buckets. To increase control of the encryption and manage factors like rotation use customer managed keys.",
          "Message": "Bucket does not encrypt data with a customer managed key.",
          "Query": "data..",
          "Resolution": "Enable encryption using customer managed keys",
          "Severity": "HIGH",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0132",
          "References": [
            "https://docs.aws.amazon.com/AmazonS3/latest/userguide/bucket-encryption.html",
            "https://avd.aquasec.com/misconfig/avd-aws-0132"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "aws_s3_bucket.data",
            "Provider": "AWS",
            "Service": "s3",
            "StartLine": 1,
            "EndLine": 22,
            "Code": {
              "Lines": [
                {
                  "Number": 1,
                  "Content": "resource \"aws_s3_bucket\" \"data\" {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 2,
                  "Content": "  # bucket is public",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 3,
                  "Content": "  # bucket is not encrypted",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 4,
                  "Content": "  # bucket does not have access logs",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 5,
                  "Content": "  # bucket does not have versioning",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 6,
                  "Content": "  bucket        = \"${local.resource_prefix.value}-data\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 7,
                  "Content": "  acl           = \"public-read\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 8,
                  "Content": "  force_destroy = true",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 9,
                  "Content": "  tags = merge({",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 10,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "AVD-AWS-0132",
          "Title": "S3 encryption should use Customer Managed Keys",
          "Description": "Encryption using AWS keys provides protection for your S3 buckets. To increase control of the encryption and manage factors like rotation use customer managed keys.",
          "Message": "Bucket does not encrypt data with a customer managed key.",
          "Query": "data..",
          "Resolution": "Enable encryption using customer managed keys",
          "Severity": "HIGH",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0132",
          "References": [
            "https://docs.aws.amazon.com/AmazonS3/latest/userguide/bucket-encryption.html",
            "https://avd.aquasec.com/misconfig/avd-aws-0132"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "aws_s3_bucket.financials",
            "Provider": "AWS",
            "Service": "s3",
            "StartLine": 43,
            "EndLine": 64,
            "Code": {
              "Lines": [
                {
                  "Number": 43,
                  "Content": "resource \"aws_s3_bucket\" \"financials\" {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 44,
                  "Content": "  # bucket is not encrypted",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 45,
                  "Content": "  # bucket does not have access logs",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 46,
                  "Content": "  # bucket does not have versioning",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 47,
                  "Content": "  bucket        = \"${local.resource_prefix.value}-financials\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 48,
                  "Content": "  acl           = \"private\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 49,
                  "Content": "  force_destroy = true",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 50,
                  "Content": "  tags = merge({",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 51,
                  "Content": "    Name        = \"${local.resource_prefix.value}-financials\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 52,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "AVD-AWS-0132",
          "Title": "S3 encryption should use Customer Managed Keys",
          "Description": "Encryption using AWS keys provides protection for your S3 buckets. To increase control of the encryption and manage factors like rotation use customer managed keys.",
          "Message": "Bucket does not encrypt data with a customer managed key.",
          "Query": "data..",
          "Resolution": "Enable encryption using customer managed keys",
          "Severity": "HIGH",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0132",
          "References": [
            "https://docs.aws.amazon.com/AmazonS3/latest/userguide/bucket-encryption.html",
            "https://avd.aquasec.com/misconfig/avd-aws-0132"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "aws_s3_bucket.operations",
            "Provider": "AWS",
            "Service": "s3",
            "StartLine": 66,
            "EndLine": 89,
            "Code": {
              "Lines": [
                {
                  "Number": 66,
                  "Content": "resource \"aws_s3_bucket\" \"operations\" {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 67,
                  "Content": "  # bucket is not encrypted",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 68,
                  "Content": "  # bucket does not have access logs",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 69,
                  "Content": "  bucket = \"${local.resource_prefix.value}-operations\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 70,
                  "Content": "  acl    = \"private\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 71,
                  "Content": "  versioning {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 72,
                  "Content": "    enabled = true",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 73,
                  "Content": "  }",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 74,
                  "Content": "  force_destroy = true",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 75,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "AVD-AWS-0132",
          "Title": "S3 encryption should use Customer Managed Keys",
          "Description": "Encryption using AWS keys provides protection for your S3 buckets. To increase control of the encryption and manage factors like rotation use customer managed keys.",
          "Message": "Bucket does not encrypt data with a customer managed key.",
          "Query": "data..",
          "Resolution": "Enable encryption using customer managed keys",
          "Severity": "HIGH",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0132",
          "References": [
            "https://docs.aws.amazon.com/AmazonS3/latest/userguide/bucket-encryption.html",
            "https://avd.aquasec.com/misconfig/avd-aws-0132"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "aws_s3_bucket.data_science",
            "Provider": "AWS",
            "Service": "s3",
            "StartLine": 91,
            "EndLine": 113,
            "Code": {
              "Lines": [
                {
                  "Number": 91,
                  "Content": "resource \"aws_s3_bucket\" \"data_science\" {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 92,
                  "Content": "  # bucket is not encrypted",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 93,
                  "Content": "  bucket = \"${local.resource_prefix.value}-data-science\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 94,
                  "Content": "  acl    = \"private\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 95,
                  "Content": "  versioning {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 96,
                  "Content": "    enabled = true",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 97,
                  "Content": "  }",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 98,
                  "Content": "  logging {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 99,
                  "Content": "    target_bucket = \"${aws_s3_bucket.logs.id}\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 100,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        }
      ]
    },
    {
      "Target": "terraform/azure/aks.tf",
      "Class": "config",
      "Type": "terraform",
      "MisconfSummary": {
        "Successes": 0,
        "Failures": 4,
        "Exceptions": 0
      },
      "Misconfigurations": [
        {
          "Type": "Terraform Security Check",
          "ID": "AVD-AZU-0040",
          "Title": "Ensure AKS logging to Azure Monitoring is Configured",
          "Description": "Ensure AKS logging to Azure Monitoring is configured for containers to monitor the performance of workloads.",
          "Message": "Cluster does not have logging enabled via OMS Agent.",
          "Query": "data..",
          "Resolution": "Enable logging for AKS",
          "Severity": "MEDIUM",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-azu-0040",
          "References": [
            "https://docs.microsoft.com/en-us/azure/azure-monitor/insights/container-insights-onboard",
            "https://avd.aquasec.com/misconfig/avd-azu-0040"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "azurerm_kubernetes_cluster.k8s_cluster",
            "Provider": "Azure",
            "Service": "container",
            "StartLine": 16,
            "EndLine": 16,
            "Code": {
              "Lines": [
                {
                  "Number": 1,
                  "Content": "resource azurerm_kubernetes_cluster \"k8s_cluster\" {",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 2,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 16,
                  "Content": "      enabled = false",
                  "IsCause": true,
                  "Annotation": "false",
                  "Truncated": false,
                  "FirstCause": true,
                  "LastCause": true
                },
                {
                  "Number": 34,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 35,
                  "Content": "}",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "AVD-AZU-0041",
          "Title": "Ensure AKS has an API Server Authorized IP Ranges enabled",
          "Description": "The API server is the central way to interact with and manage a cluster. To improve cluster security and minimize attacks, the API server should only be accessible from a limited set of IP address ranges.",
          "Message": "Cluster does not limit API access to specific IP addresses.",
          "Query": "data..",
          "Resolution": "Limit the access to the API server to a limited IP range",
          "Severity": "CRITICAL",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-azu-0041",
          "References": [
            "https://docs.microsoft.com/en-us/azure/aks/api-server-authorized-ip-ranges",
            "https://avd.aquasec.com/misconfig/avd-azu-0041"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "azurerm_kubernetes_cluster.k8s_cluster",
            "Provider": "Azure",
            "Service": "container",
            "StartLine": 1,
            "EndLine": 35,
            "Code": {
              "Lines": [
                {
                  "Number": 1,
                  "Content": "resource azurerm_kubernetes_cluster \"k8s_cluster\" {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 2,
                  "Content": "  dns_prefix          = \"terragoat-${var.environment}\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 3,
                  "Content": "  location            = var.location",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 4,
                  "Content": "  name                = \"terragoat-aks-${var.environment}\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 5,
                  "Content": "  resource_group_name = azurerm_resource_group.example.name",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 6,
                  "Content": "  identity {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 7,
                  "Content": "    type = \"SystemAssigned\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 8,
                  "Content": "  }",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 9,
                  "Content": "  default_node_pool {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 10,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "AVD-AZU-0042",
          "Title": "Ensure RBAC is enabled on AKS clusters",
          "Description": "Using Kubernetes role-based access control (RBAC), you can grant users, groups, and service accounts access to only the resources they need.",
          "Message": "Cluster has RBAC disabled",
          "Query": "data..",
          "Resolution": "Enable RBAC",
          "Severity": "HIGH",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-azu-0042",
          "References": [
            "https://docs.microsoft.com/en-us/azure/aks/concepts-identity",
            "https://avd.aquasec.com/misconfig/avd-azu-0042"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "azurerm_kubernetes_cluster.k8s_cluster",
            "Provider": "Azure",
            "Service": "container",
            "StartLine": 23,
            "EndLine": 23,
            "Code": {
              "Lines": [
                {
                  "Number": 1,
                  "Content": "resource azurerm_kubernetes_cluster \"k8s_cluster\" {",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 2,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 23,
                  "Content": "    enabled = false",
                  "IsCause": true,
                  "Annotation": "false",
                  "Truncated": false,
                  "FirstCause": true,
                  "LastCause": true
                },
                {
                  "Number": 34,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 35,
                  "Content": "}",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "AVD-AZU-0043",
          "Title": "Ensure AKS cluster has Network Policy configured",
          "Description": "The Kubernetes object type NetworkPolicy should be defined to have opportunity allow or block traffic to pods, as in a Kubernetes cluster configured with default settings, all pods can discover and communicate with each other without any restrictions.",
          "Message": "Kubernetes cluster does not have a network policy set.",
          "Query": "data..",
          "Resolution": "Configure a network policy",
          "Severity": "HIGH",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-azu-0043",
          "References": [
            "https://kubernetes.io/docs/concepts/services-networking/network-policies",
            "https://avd.aquasec.com/misconfig/avd-azu-0043"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "azurerm_kubernetes_cluster.k8s_cluster",
            "Provider": "Azure",
            "Service": "container",
            "StartLine": 1,
            "EndLine": 35,
            "Code": {
              "Lines": [
                {
                  "Number": 1,
                  "Content": "resource azurerm_kubernetes_cluster \"k8s_cluster\" {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 2,
                  "Content": "  dns_prefix          = \"terragoat-${var.environment}\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 3,
                  "Content": "  location            = var.location",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 4,
                  "Content": "  name                = \"terragoat-aks-${var.environment}\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 5,
                  "Content": "  resource_group_name = azurerm_resource_group.example.name",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 6,
                  "Content": "  identity {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 7,
                  "Content": "    type = \"SystemAssigned\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 8,
                  "Content": "  }",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 9,
                  "Content": "  default_node_pool {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 10,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        }
      ]
    },
    {
      "Target": "terraform/azure/app_service.tf",
      "Class": "config",
      "Type": "terraform",
      "MisconfSummary": {
        "Successes": 1,
        "Failures": 9,
        "Exceptions": 0
      },
      "Misconfigurations": [
        {
          "Type": "Terraform Security Check",
          "ID": "AVD-AZU-0001",
          "Title": "Web App accepts incoming client certificate",
          "Description": "The TLS mutual authentication technique in enterprise environments ensures the authenticity of clients to the server. If incoming client certificates are enabled only an authenticated client with valid certificates can access the app.",
          "Message": "App service does not have client certificates enabled.",
          "Query": "data..",
          "Resolution": "Enable incoming certificates for clients",
          "Severity": "LOW",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-azu-0001",
          "References": [
            "https://avd.aquasec.com/misconfig/avd-azu-0001"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "azurerm_app_service.app-service2",
            "Provider": "Azure",
            "Service": "appservice",
            "StartLine": 43,
            "EndLine": 63,
            "Code": {
              "Lines": [
                {
                  "Number": 43,
                  "Content": "resource azurerm_app_service \"app-service2\" {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 44,
                  "Content": "  app_service_plan_id = azurerm_app_service_plan.example.id",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 45,
                  "Content": "  location            = var.location",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 46,
                  "Content": "  name                = \"terragoat-app-service-${var.environment}${random_integer.rnd_int.result}\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 47,
                  "Content": "  resource_group_name = azurerm_resource_group.example.name",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 48,
                  "Content": "  https_only          = true",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 49,
                  "Content": "",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 50,
                  "Content": "  auth_settings {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 51,
                  "Content": "    enabled = false",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 52,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "AVD-AZU-0001",
          "Title": "Web App accepts incoming client certificate",
          "Description": "The TLS mutual authentication technique in enterprise environments ensures the authenticity of clients to the server. If incoming client certificates are enabled only an authenticated client with valid certificates can access the app.",
          "Message": "App service does not have client certificates enabled.",
          "Query": "data..",
          "Resolution": "Enable incoming certificates for clients",
          "Severity": "LOW",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-azu-0001",
          "References": [
            "https://avd.aquasec.com/misconfig/avd-azu-0001"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "azurerm_app_service.app-service1",
            "Provider": "Azure",
            "Service": "appservice",
            "StartLine": 22,
            "EndLine": 41,
            "Code": {
              "Lines": [
                {
                  "Number": 22,
                  "Content": "resource azurerm_app_service \"app-service1\" {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 23,
                  "Content": "  app_service_plan_id = azurerm_app_service_plan.example.id",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 24,
                  "Content": "  location            = var.location",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 25,
                  "Content": "  name                = \"terragoat-app-service-${var.environment}${random_integer.rnd_int.result}\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 26,
                  "Content": "  resource_group_name = azurerm_resource_group.example.name",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 27,
                  "Content": "  https_only          = false",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 28,
                  "Content": "  site_config {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 29,
                  "Content": "    min_tls_version = \"1.1\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 30,
                  "Content": "  }",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 31,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "AVD-AZU-0002",
          "Title": "Web App has registration with AD enabled",
          "Description": "Registering the identity used by an App with AD allows it to interact with other services without using username and password",
          "Message": "App service does not have an identity type.",
          "Query": "data..",
          "Resolution": "Register the app identity with AD",
          "Severity": "LOW",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-azu-0002",
          "References": [
            "https://avd.aquasec.com/misconfig/avd-azu-0002"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "azurerm_app_service.app-service2",
            "Provider": "Azure",
            "Service": "appservice",
            "StartLine": 43,
            "EndLine": 63,
            "Code": {
              "Lines": [
                {
                  "Number": 43,
                  "Content": "resource azurerm_app_service \"app-service2\" {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 44,
                  "Content": "  app_service_plan_id = azurerm_app_service_plan.example.id",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 45,
                  "Content": "  location            = var.location",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 46,
                  "Content": "  name                = \"terragoat-app-service-${var.environment}${random_integer.rnd_int.result}\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 47,
                  "Content": "  resource_group_name = azurerm_resource_group.example.name",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 48,
                  "Content": "  https_only          = true",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 49,
                  "Content": "",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 50,
                  "Content": "  auth_settings {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 51,
                  "Content": "    enabled = false",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 52,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "AVD-AZU-0002",
          "Title": "Web App has registration with AD enabled",
          "Description": "Registering the identity used by an App with AD allows it to interact with other services without using username and password",
          "Message": "App service does not have an identity type.",
          "Query": "data..",
          "Resolution": "Register the app identity with AD",
          "Severity": "LOW",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-azu-0002",
          "References": [
            "https://avd.aquasec.com/misconfig/avd-azu-0002"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "azurerm_app_service.app-service1",
            "Provider": "Azure",
            "Service": "appservice",
            "StartLine": 22,
            "EndLine": 41,
            "Code": {
              "Lines": [
                {
                  "Number": 22,
                  "Content": "resource azurerm_app_service \"app-service1\" {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 23,
                  "Content": "  app_service_plan_id = azurerm_app_service_plan.example.id",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 24,
                  "Content": "  location            = var.location",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 25,
                  "Content": "  name                = \"terragoat-app-service-${var.environment}${random_integer.rnd_int.result}\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 26,
                  "Content": "  resource_group_name = azurerm_resource_group.example.name",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 27,
                  "Content": "  https_only          = false",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 28,
                  "Content": "  site_config {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 29,
                  "Content": "    min_tls_version = \"1.1\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 30,
                  "Content": "  }",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 31,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "AVD-AZU-0003",
          "Title": "App Service authentication is activated",
          "Description": "Enabling authentication ensures that all communications in the application are authenticated. The auth_settings block needs to be filled out with the appropriate auth backend settings",
          "Message": "App service does not have authentication enabled.",
          "Query": "data..",
          "Resolution": "Enable authentication to prevent anonymous request being accepted",
          "Severity": "MEDIUM",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-azu-0003",
          "References": [
            "https://avd.aquasec.com/misconfig/avd-azu-0003"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "azurerm_app_service.app-service2",
            "Provider": "Azure",
            "Service": "appservice",
            "StartLine": 51,
            "EndLine": 51,
            "Code": {
              "Lines": [
                {
                  "Number": 43,
                  "Content": "resource azurerm_app_service \"app-service2\" {",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 44,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 51,
                  "Content": "    enabled = false",
                  "IsCause": true,
                  "Annotation": "false",
                  "Truncated": false,
                  "FirstCause": true,
                  "LastCause": true
                },
                {
                  "Number": 62,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 63,
                  "Content": "}",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "AVD-AZU-0003",
          "Title": "App Service authentication is activated",
          "Description": "Enabling authentication ensures that all communications in the application are authenticated. The auth_settings block needs to be filled out with the appropriate auth backend settings",
          "Message": "App service does not have authentication enabled.",
          "Query": "data..",
          "Resolution": "Enable authentication to prevent anonymous request being accepted",
          "Severity": "MEDIUM",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-azu-0003",
          "References": [
            "https://avd.aquasec.com/misconfig/avd-azu-0003"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "azurerm_app_service.app-service1",
            "Provider": "Azure",
            "Service": "appservice",
            "StartLine": 22,
            "EndLine": 41,
            "Code": {
              "Lines": [
                {
                  "Number": 22,
                  "Content": "resource azurerm_app_service \"app-service1\" {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 23,
                  "Content": "  app_service_plan_id = azurerm_app_service_plan.example.id",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 24,
                  "Content": "  location            = var.location",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 25,
                  "Content": "  name                = \"terragoat-app-service-${var.environment}${random_integer.rnd_int.result}\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 26,
                  "Content": "  resource_group_name = azurerm_resource_group.example.name",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 27,
                  "Content": "  https_only          = false",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 28,
                  "Content": "  site_config {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 29,
                  "Content": "    min_tls_version = \"1.1\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 30,
                  "Content": "  }",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 31,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "AVD-AZU-0005",
          "Title": "Web App uses the latest HTTP version",
          "Description": "Use the latest version of HTTP to ensure you are benefiting from security fixes",
          "Message": "App service does not have HTTP/2 enabled.",
          "Query": "data..",
          "Resolution": "Use the latest version of HTTP",
          "Severity": "LOW",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-azu-0005",
          "References": [
            "https://avd.aquasec.com/misconfig/avd-azu-0005"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "azurerm_app_service.app-service2",
            "Provider": "Azure",
            "Service": "appservice",
            "StartLine": 43,
            "EndLine": 63,
            "Code": {
              "Lines": [
                {
                  "Number": 43,
                  "Content": "resource azurerm_app_service \"app-service2\" {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 44,
                  "Content": "  app_service_plan_id = azurerm_app_service_plan.example.id",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 45,
                  "Content": "  location            = var.location",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 46,
                  "Content": "  name                = \"terragoat-app-service-${var.environment}${random_integer.rnd_int.result}\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 47,
                  "Content": "  resource_group_name = azurerm_resource_group.example.name",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 48,
                  "Content": "  https_only          = true",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 49,
                  "Content": "",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 50,
                  "Content": "  auth_settings {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 51,
                  "Content": "    enabled = false",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 52,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "AVD-AZU-0005",
          "Title": "Web App uses the latest HTTP version",
          "Description": "Use the latest version of HTTP to ensure you are benefiting from security fixes",
          "Message": "App service does not have HTTP/2 enabled.",
          "Query": "data..",
          "Resolution": "Use the latest version of HTTP",
          "Severity": "LOW",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-azu-0005",
          "References": [
            "https://avd.aquasec.com/misconfig/avd-azu-0005"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "azurerm_app_service.app-service1",
            "Provider": "Azure",
            "Service": "appservice",
            "StartLine": 28,
            "EndLine": 30,
            "Code": {
              "Lines": [
                {
                  "Number": 22,
                  "Content": "resource azurerm_app_service \"app-service1\" {",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 23,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 28,
                  "Content": "  site_config {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 29,
                  "Content": "    min_tls_version = \"1.1\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 30,
                  "Content": "  }",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 40,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 41,
                  "Content": "}",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "AVD-AZU-0006",
          "Title": "Web App uses latest TLS version",
          "Description": "Use a more recent TLS/SSL policy for the App Service",
          "Message": "App service does not require a secure TLS version.",
          "Query": "data..",
          "Resolution": "The TLS version being outdated and has known vulnerabilities",
          "Severity": "HIGH",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-azu-0006",
          "References": [
            "https://avd.aquasec.com/misconfig/avd-azu-0006"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "azurerm_app_service.app-service1",
            "Provider": "Azure",
            "Service": "appservice",
            "StartLine": 29,
            "EndLine": 29,
            "Code": {
              "Lines": [
                {
                  "Number": 22,
                  "Content": "resource azurerm_app_service \"app-service1\" {",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 23,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 29,
                  "Content": "    min_tls_version = \"1.1\"",
                  "IsCause": true,
                  "Annotation": "\"1.1\"",
                  "Truncated": false,
                  "FirstCause": true,
                  "LastCause": true
                },
                {
                  "Number": 40,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 41,
                  "Content": "}",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        }
      ]
    },
    {
      "Target": "terraform/azure/instance.tf",
      "Class": "config",
      "Type": "terraform",
      "MisconfSummary": {
        "Successes": 1,
        "Failures": 1,
        "Exceptions": 0
      },
      "Misconfigurations": [
        {
          "Type": "Terraform Security Check",
          "ID": "AVD-AZU-0039",
          "Title": "Password authentication should be disabled on Azure virtual machines",
          "Description": "Access to virtual machines should be authenticated using SSH keys. Removing the option of password authentication enforces more secure methods while removing the risks inherent with passwords.",
          "Message": "Linux virtual machine allows password authentication.",
          "Query": "data..",
          "Resolution": "Use ssh authentication for virtual machines",
          "Severity": "HIGH",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-azu-0039",
          "References": [
            "https://avd.aquasec.com/misconfig/avd-azu-0039"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "azurerm_linux_virtual_machine.linux_machine",
            "Provider": "Azure",
            "Service": "compute",
            "StartLine": 17,
            "EndLine": 17,
            "Code": {
              "Lines": [
                {
                  "Number": 9,
                  "Content": "resource azurerm_linux_virtual_machine \"linux_machine\" {",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 10,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 17,
                  "Content": "  disable_password_authentication = false",
                  "IsCause": true,
                  "Annotation": "false",
                  "Truncated": false,
                  "FirstCause": true,
                  "LastCause": true
                },
                {
                  "Number": 41,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 42,
                  "Content": "}",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        }
      ]
    },
    {
      "Target": "terraform/azure/key_vault.tf",
      "Class": "config",
      "Type": "terraform",
      "MisconfSummary": {
        "Successes": 0,
        "Failures": 5,
        "Exceptions": 0
      },
      "Misconfigurations": [
        {
          "Type": "Terraform Security Check",
          "ID": "AVD-AZU-0013",
          "Title": "Key vault should have the network acl block specified",
          "Description": "Network ACLs allow you to reduce your exposure to risk by limiting what can access your key vault. \n\nThe default action of the Network ACL should be set to deny for when IPs are not matched. Azure services can be allowed to bypass.",
          "Message": "Vault network ACL does not block access by default.",
          "Query": "data..",
          "Resolution": "Set a network ACL for the key vault",
          "Severity": "CRITICAL",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-azu-0013",
          "References": [
            "https://docs.microsoft.com/en-us/azure/key-vault/general/network-security",
            "https://avd.aquasec.com/misconfig/avd-azu-0013"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "azurerm_key_vault.example",
            "Provider": "Azure",
            "Service": "keyvault",
            "StartLine": 1,
            "EndLine": 31,
            "Code": {
              "Lines": [
                {
                  "Number": 1,
                  "Content": "resource \"azurerm_key_vault\" \"example\" {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 2,
                  "Content": "  name                = \"terragoat-key-${var.environment}${random_integer.rnd_int.result}\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 3,
                  "Content": "  location            = azurerm_resource_group.example.location",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 4,
                  "Content": "  resource_group_name = azurerm_resource_group.example.name",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 5,
                  "Content": "  tenant_id           = data.azurerm_client_config.current.tenant_id",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 6,
                  "Content": "  sku_name            = \"premium\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 7,
                  "Content": "  access_policy {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 8,
                  "Content": "    tenant_id = data.azurerm_client_config.current.tenant_id",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 9,
                  "Content": "    object_id = data.azurerm_client_config.current.object_id",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 10,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "AVD-AZU-0014",
          "Title": "Ensure that the expiration date is set on all keys",
          "Description": "Expiration Date is an optional Key Vault Key behavior and is not set by default.\n\nSet when the resource will be become inactive.",
          "Message": "Key should have an expiry date specified.",
          "Query": "data..",
          "Resolution": "Set an expiration date on the vault key",
          "Severity": "MEDIUM",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-azu-0014",
          "References": [
            "https://docs.microsoft.com/en-us/powershell/module/az.keyvault/update-azkeyvaultkey?view=azps-5.8.0#example-1--modify-a-key-to-enable-it--and-set-the-expiration-date-and-tags",
            "https://avd.aquasec.com/misconfig/avd-azu-0014"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "azurerm_key_vault_key.generated",
            "Provider": "Azure",
            "Service": "keyvault",
            "StartLine": 33,
            "EndLine": 56,
            "Code": {
              "Lines": [
                {
                  "Number": 33,
                  "Content": "resource \"azurerm_key_vault_key\" \"generated\" {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 34,
                  "Content": "  name         = \"terragoat-generated-certificate-${var.environment}\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 35,
                  "Content": "  key_vault_id = azurerm_key_vault.example.id",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 36,
                  "Content": "  key_type     = \"RSA\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 37,
                  "Content": "  key_size     = 2048",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 38,
                  "Content": "  key_opts = [",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 39,
                  "Content": "    \"decrypt\",",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 40,
                  "Content": "    \"encrypt\",",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 41,
                  "Content": "    \"sign\",",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 42,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "AVD-AZU-0015",
          "Title": "Key vault Secret should have a content type set",
          "Description": "Content Type is an optional Key Vault Secret behavior and is not enabled by default.\n\nClients may specify the content type of a secret to assist in interpreting the secret data when it's retrieved. The maximum length of this field is 255 characters. There are no pre-defined values. The suggested usage is as a hint for interpreting the secret data.",
          "Message": "Secret does not have a content-type specified.",
          "Query": "data..",
          "Resolution": "Provide content type for secrets to aid interpretation on retrieval",
          "Severity": "LOW",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-azu-0015",
          "References": [
            "https://docs.microsoft.com/en-us/azure/key-vault/secrets/about-secrets",
            "https://avd.aquasec.com/misconfig/avd-azu-0015"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "azurerm_key_vault_secret.secret",
            "Provider": "Azure",
            "Service": "keyvault",
            "StartLine": 58,
            "EndLine": 72,
            "Code": {
              "Lines": [
                {
                  "Number": 58,
                  "Content": "resource \"azurerm_key_vault_secret\" \"secret\" {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 59,
                  "Content": "  key_vault_id = azurerm_key_vault.example.id",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 60,
                  "Content": "  name         = \"terragoat-secret-${var.environment}\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 61,
                  "Content": "  value        = random_string.password.result",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 62,
                  "Content": "  tags = {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 63,
                  "Content": "    git_commit           = \"f8ff847bb69370bbe03b3d2b70db586ff6c867fc\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 64,
                  "Content": "    git_file             = \"terraform/azure/key_vault.tf\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 65,
                  "Content": "    git_last_modified_at = \"2020-06-19 21:16:08\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 66,
                  "Content": "    git_last_modified_by = \"Adin.Ermie@outlook.com\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 67,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "AVD-AZU-0016",
          "Title": "Key vault should have purge protection enabled",
          "Description": "Purge protection is an optional Key Vault behavior and is not enabled by default.\n\nPurge protection can only be enabled once soft-delete is enabled. It can be turned on via CLI or PowerShell.",
          "Message": "Vault does not have purge protection enabled.",
          "Query": "data..",
          "Resolution": "Enable purge protection for key vaults",
          "Severity": "MEDIUM",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-azu-0016",
          "References": [
            "https://docs.microsoft.com/en-us/azure/key-vault/general/soft-delete-overview#purge-protection",
            "https://avd.aquasec.com/misconfig/avd-azu-0016"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "azurerm_key_vault.example",
            "Provider": "Azure",
            "Service": "keyvault",
            "StartLine": 1,
            "EndLine": 31,
            "Code": {
              "Lines": [
                {
                  "Number": 1,
                  "Content": "resource \"azurerm_key_vault\" \"example\" {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 2,
                  "Content": "  name                = \"terragoat-key-${var.environment}${random_integer.rnd_int.result}\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 3,
                  "Content": "  location            = azurerm_resource_group.example.location",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 4,
                  "Content": "  resource_group_name = azurerm_resource_group.example.name",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 5,
                  "Content": "  tenant_id           = data.azurerm_client_config.current.tenant_id",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 6,
                  "Content": "  sku_name            = \"premium\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 7,
                  "Content": "  access_policy {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 8,
                  "Content": "    tenant_id = data.azurerm_client_config.current.tenant_id",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 9,
                  "Content": "    object_id = data.azurerm_client_config.current.object_id",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 10,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "AVD-AZU-0017",
          "Title": "Key Vault Secret should have an expiration date set",
          "Description": "Expiration Date is an optional Key Vault Secret behavior and is not set by default.\n\nSet when the resource will be become inactive.",
          "Message": "Secret should have an expiry date specified.",
          "Query": "data..",
          "Resolution": "Set an expiry for secrets",
          "Severity": "LOW",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-azu-0017",
          "References": [
            "https://docs.microsoft.com/en-us/azure/key-vault/secrets/about-secrets",
            "https://avd.aquasec.com/misconfig/avd-azu-0017"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "azurerm_key_vault_secret.secret",
            "Provider": "Azure",
            "Service": "keyvault",
            "StartLine": 58,
            "EndLine": 72,
            "Code": {
              "Lines": [
                {
                  "Number": 58,
                  "Content": "resource \"azurerm_key_vault_secret\" \"secret\" {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 59,
                  "Content": "  key_vault_id = azurerm_key_vault.example.id",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 60,
                  "Content": "  name         = \"terragoat-secret-${var.environment}\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 61,
                  "Content": "  value        = random_string.password.result",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 62,
                  "Content": "  tags = {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 63,
                  "Content": "    git_commit           = \"f8ff847bb69370bbe03b3d2b70db586ff6c867fc\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 64,
                  "Content": "    git_file             = \"terraform/azure/key_vault.tf\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 65,
                  "Content": "    git_last_modified_at = \"2020-06-19 21:16:08\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 66,
                  "Content": "    git_last_modified_by = \"Adin.Ermie@outlook.com\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 67,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        }
      ]
    },
    {
      "Target": "terraform/azure/logging.tf",
      "Class": "config",
      "Type": "terraform",
      "MisconfSummary": {
        "Successes": 0,
        "Failures": 4,
        "Exceptions": 0
      },
      "Misconfigurations": [
        {
          "Type": "Terraform Security Check",
          "ID": "AVD-AZU-0031",
          "Title": "Ensure the activity retention log is set to at least a year",
          "Description": "The average time to detect a breach is up to 210 days, to ensure that all the information required for an effective investigation is available, the retention period should allow for delayed starts to investigating.",
          "Message": "Profile has a log retention policy of less than 1 year.",
          "Query": "data..",
          "Resolution": "Set a retention period that will allow for delayed investigation",
          "Severity": "MEDIUM",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-azu-0031",
          "References": [
            "https://docs.microsoft.com/en-us/azure/azure-monitor/essentials/platform-logs-overview",
            "https://avd.aquasec.com/misconfig/avd-azu-0031"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "azurerm_monitor_log_profile.logging_profile",
            "Provider": "Azure",
            "Service": "monitor",
            "StartLine": 8,
            "EndLine": 8,
            "Code": {
              "Lines": [
                {
                  "Number": 1,
                  "Content": "resource azurerm_monitor_log_profile \"logging_profile\" {",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 2,
                  "Content": "  storage_account_id = azurerm_storage_account.example.id",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 3,
                  "Content": "  categories         = [\"Action\"]",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 4,
                  "Content": "  locations          = [var.location]",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 5,
                  "Content": "  name               = \"terragoat-${var.environment}\"",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 6,
                  "Content": "  retention_policy {",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 7,
                  "Content": "    enabled = true",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 8,
                  "Content": "    days    = 30",
                  "IsCause": true,
                  "Annotation": "30",
                  "Truncated": false,
                  "FirstCause": true,
                  "LastCause": true
                },
                {
                  "Number": 9,
                  "Content": "  }",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 10,
                  "Content": "}",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "AVD-AZU-0032",
          "Title": "Ensure activitys are captured for all locations",
          "Description": "Log profiles should capture all regions to ensure that all events are logged",
          "Message": "Log profile does not log to all regions (68 regions missing).",
          "Query": "data..",
          "Resolution": "Enable capture for all locations",
          "Severity": "MEDIUM",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-azu-0032",
          "References": [
            "https://docs.microsoft.com/en-us/cli/azure/monitor/log-profiles?view=azure-cli-latest#az_monitor_log_profiles_create-required-parameters",
            "https://avd.aquasec.com/misconfig/avd-azu-0032"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "azurerm_monitor_log_profile.logging_profile",
            "Provider": "Azure",
            "Service": "monitor",
            "StartLine": 1,
            "EndLine": 10,
            "Code": {
              "Lines": [
                {
                  "Number": 1,
                  "Content": "resource azurerm_monitor_log_profile \"logging_profile\" {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 2,
                  "Content": "  storage_account_id = azurerm_storage_account.example.id",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 3,
                  "Content": "  categories         = [\"Action\"]",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 4,
                  "Content": "  locations          = [var.location]",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 5,
                  "Content": "  name               = \"terragoat-${var.environment}\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 6,
                  "Content": "  retention_policy {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 7,
                  "Content": "    enabled = true",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 8,
                  "Content": "    days    = 30",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 9,
                  "Content": "  }",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 10,
                  "Content": "}",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": true
                }
              ]
            }
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "AVD-AZU-0033",
          "Title": "Ensure log profile captures all activities",
          "Description": "Log profiles should capture all categories to ensure that all events are logged",
          "Message": "Log profile does not require the 'Delete' category.",
          "Query": "data..",
          "Resolution": "Configure log profile to capture all activities",
          "Severity": "MEDIUM",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-azu-0033",
          "References": [
            "https://docs.microsoft.com/en-us/azure/azure-monitor/essentials/activity-log",
            "https://docs.microsoft.com/en-us/cli/azure/monitor/log-profiles?view=azure-cli-latest#az_monitor_log_profiles_create-required-parameters",
            "https://avd.aquasec.com/misconfig/avd-azu-0033"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "azurerm_monitor_log_profile.logging_profile",
            "Provider": "Azure",
            "Service": "monitor",
            "StartLine": 1,
            "EndLine": 10,
            "Code": {
              "Lines": [
                {
                  "Number": 1,
                  "Content": "resource azurerm_monitor_log_profile \"logging_profile\" {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 2,
                  "Content": "  storage_account_id = azurerm_storage_account.example.id",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 3,
                  "Content": "  categories         = [\"Action\"]",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 4,
                  "Content": "  locations          = [var.location]",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 5,
                  "Content": "  name               = \"terragoat-${var.environment}\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 6,
                  "Content": "  retention_policy {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 7,
                  "Content": "    enabled = true",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 8,
                  "Content": "    days    = 30",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 9,
                  "Content": "  }",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 10,
                  "Content": "}",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": true
                }
              ]
            }
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "AVD-AZU-0033",
          "Title": "Ensure log profile captures all activities",
          "Description": "Log profiles should capture all categories to ensure that all events are logged",
          "Message": "Log profile does not require the 'Write' category.",
          "Query": "data..",
          "Resolution": "Configure log profile to capture all activities",
          "Severity": "MEDIUM",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-azu-0033",
          "References": [
            "https://docs.microsoft.com/en-us/azure/azure-monitor/essentials/activity-log",
            "https://docs.microsoft.com/en-us/cli/azure/monitor/log-profiles?view=azure-cli-latest#az_monitor_log_profiles_create-required-parameters",
            "https://avd.aquasec.com/misconfig/avd-azu-0033"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "azurerm_monitor_log_profile.logging_profile",
            "Provider": "Azure",
            "Service": "monitor",
            "StartLine": 1,
            "EndLine": 10,
            "Code": {
              "Lines": [
                {
                  "Number": 1,
                  "Content": "resource azurerm_monitor_log_profile \"logging_profile\" {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 2,
                  "Content": "  storage_account_id = azurerm_storage_account.example.id",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 3,
                  "Content": "  categories         = [\"Action\"]",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 4,
                  "Content": "  locations          = [var.location]",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 5,
                  "Content": "  name               = \"terragoat-${var.environment}\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 6,
                  "Content": "  retention_policy {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 7,
                  "Content": "    enabled = true",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 8,
                  "Content": "    days    = 30",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 9,
                  "Content": "  }",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 10,
                  "Content": "}",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": true
                }
              ]
            }
          }
        }
      ]
    },
    {
      "Target": "terraform/azure/mssql.tf",
      "Class": "config",
      "Type": "terraform",
      "MisconfSummary": {
        "Successes": 2,
        "Failures": 38,
        "Exceptions": 0
      },
      "Misconfigurations": [
        {
          "Type": "Terraform Security Check",
          "ID": "AVD-AZU-0009",
          "Title": "When using Queue Services for a storage account, logging should be enabled.",
          "Description": "Storage Analytics logs detailed information about successful and failed requests to a storage service. \n\nThis information can be used to monitor individual requests and to diagnose issues with a storage service. \n\nRequests are logged on a best-effort basis.",
          "Message": "Queue services storage account does not have logging enabled.",
          "Query": "data..",
          "Resolution": "Enable logging for Queue Services",
          "Severity": "MEDIUM",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-azu-0009",
          "References": [
            "https://docs.microsoft.com/en-us/azure/storage/common/storage-analytics-logging?tabs=dotnet",
            "https://avd.aquasec.com/misconfig/avd-azu-0009"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "azurerm_storage_account.security_storage_account",
            "Provider": "Azure",
            "Service": "storage",
            "StartLine": 1,
            "EndLine": 18,
            "Code": {
              "Lines": [
                {
                  "Number": 1,
                  "Content": "resource \"azurerm_storage_account\" \"security_storage_account\" {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 2,
                  "Content": "  name                      = \"securitystorageaccount-${var.environment}${random_integer.rnd_int.result}\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 3,
                  "Content": "  resource_group_name       = azurerm_resource_group.example.name",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 4,
                  "Content": "  location                  = azurerm_resource_group.example.location",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 5,
                  "Content": "  account_tier              = \"Standard\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 6,
                  "Content": "  account_replication_type  = \"LRS\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 7,
                  "Content": "  enable_https_traffic_only = true",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 8,
                  "Content": "  tags = {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 9,
                  "Content": "    git_commit           = \"a1d1c1ce31a1bde6dafa188846d90eca82abe5fd\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 10,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "AVD-AZU-0011",
          "Title": "The minimum TLS version for Storage Accounts should be TLS1_2",
          "Description": "Azure Storage currently supports three versions of the TLS protocol: 1.0, 1.1, and 1.2. \n\nAzure Storage uses TLS 1.2 on public HTTPS endpoints, but TLS 1.0 and TLS 1.1 are still supported for backward compatibility.\n\nThis check will warn if the minimum TLS is not set to TLS1_2.",
          "Message": "Storage account uses an insecure TLS version.",
          "Query": "data..",
          "Resolution": "Use a more recent TLS/SSL policy for the load balancer",
          "Severity": "CRITICAL",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-azu-0011",
          "References": [
            "https://docs.microsoft.com/en-us/azure/storage/common/transport-layer-security-configure-minimum-version",
            "https://avd.aquasec.com/misconfig/avd-azu-0011"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "azurerm_storage_account.security_storage_account",
            "Provider": "Azure",
            "Service": "storage",
            "StartLine": 1,
            "EndLine": 18,
            "Code": {
              "Lines": [
                {
                  "Number": 1,
                  "Content": "resource \"azurerm_storage_account\" \"security_storage_account\" {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 2,
                  "Content": "  name                      = \"securitystorageaccount-${var.environment}${random_integer.rnd_int.result}\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 3,
                  "Content": "  resource_group_name       = azurerm_resource_group.example.name",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 4,
                  "Content": "  location                  = azurerm_resource_group.example.location",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 5,
                  "Content": "  account_tier              = \"Standard\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 6,
                  "Content": "  account_replication_type  = \"LRS\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 7,
                  "Content": "  enable_https_traffic_only = true",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 8,
                  "Content": "  tags = {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 9,
                  "Content": "    git_commit           = \"a1d1c1ce31a1bde6dafa188846d90eca82abe5fd\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 10,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "AVD-AZU-0018",
          "Title": "At least one email address is set for threat alerts",
          "Description": "SQL Server sends alerts for threat detection via email, if there are no email addresses set then mitigation will be delayed.",
          "Message": "Security alert policy does not include any email addresses for notification.",
          "Query": "data..",
          "Resolution": "Provide at least one email address for threat alerts",
          "Severity": "MEDIUM",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-azu-0018",
          "References": [
            "https://avd.aquasec.com/misconfig/avd-azu-0018"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "azurerm_mssql_server_security_alert_policy.alertpolicy5",
            "Provider": "Azure",
            "Service": "database",
            "StartLine": 209,
            "EndLine": 220,
            "Code": {
              "Lines": [
                {
                  "Number": 209,
                  "Content": "resource \"azurerm_mssql_server_security_alert_policy\" \"alertpolicy5\" {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 210,
                  "Content": "  resource_group_name        = azurerm_resource_group.example.name",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 211,
                  "Content": "  server_name                = azurerm_mssql_server.mssql5.name",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 212,
                  "Content": "  state                      = \"Enabled\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 213,
                  "Content": "  storage_endpoint           = azurerm_storage_account.security_storage_account.primary_blob_endpoint",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 214,
                  "Content": "  storage_account_access_key = azurerm_storage_account.security_storage_account.primary_access_key",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 215,
                  "Content": "  disabled_alerts = [",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 216,
                  "Content": "    \"Sql_Injection\",",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 217,
                  "Content": "    \"Data_Exfiltration\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 218,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "AVD-AZU-0022",
          "Title": "Ensure databases are not publicly accessible",
          "Description": "Database resources should not publicly available. You should limit all access to the minimum that is required for your application to function.",
          "Message": "Database server has public network access enabled.",
          "Query": "data..",
          "Resolution": "Disable public access to database when not required",
          "Severity": "MEDIUM",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-azu-0022",
          "References": [
            "https://avd.aquasec.com/misconfig/avd-azu-0022"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "azurerm_mssql_server.mssql5",
            "Provider": "Azure",
            "Service": "database",
            "StartLine": 96,
            "EndLine": 113,
            "Code": {
              "Lines": [
                {
                  "Number": 96,
                  "Content": "resource \"azurerm_mssql_server\" \"mssql5\" {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 97,
                  "Content": "  name                         = \"mssql5-${var.environment}${random_integer.rnd_int.result}\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 98,
                  "Content": "  resource_group_name          = azurerm_resource_group.example.name",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 99,
                  "Content": "  location                     = azurerm_resource_group.example.location",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 100,
                  "Content": "  version                      = \"12.0\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 101,
                  "Content": "  administrator_login          = \"missadministrator\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 102,
                  "Content": "  administrator_login_password = \"AdminPassword123!\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 103,
                  "Content": "  tags = {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 104,
                  "Content": "    git_commit           = \"c6f8caa51942284d02465518822685897ad90141\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 105,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "AVD-AZU-0022",
          "Title": "Ensure databases are not publicly accessible",
          "Description": "Database resources should not publicly available. You should limit all access to the minimum that is required for your application to function.",
          "Message": "Database server has public network access enabled.",
          "Query": "data..",
          "Resolution": "Disable public access to database when not required",
          "Severity": "MEDIUM",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-azu-0022",
          "References": [
            "https://avd.aquasec.com/misconfig/avd-azu-0022"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "azurerm_mssql_server.mssql6",
            "Provider": "Azure",
            "Service": "database",
            "StartLine": 115,
            "EndLine": 132,
            "Code": {
              "Lines": [
                {
                  "Number": 115,
                  "Content": "resource \"azurerm_mssql_server\" \"mssql6\" {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 116,
                  "Content": "  name                         = \"mssql6-${var.environment}${random_integer.rnd_int.result}\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 117,
                  "Content": "  resource_group_name          = azurerm_resource_group.example.name",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 118,
                  "Content": "  location                     = azurerm_resource_group.example.location",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 119,
                  "Content": "  version                      = \"12.0\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 120,
                  "Content": "  administrator_login          = \"missadministrator\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 121,
                  "Content": "  administrator_login_password = \"AdminPassword123!\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 122,
                  "Content": "  tags = {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 123,
                  "Content": "    git_commit           = \"c6f8caa51942284d02465518822685897ad90141\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 124,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "AVD-AZU-0022",
          "Title": "Ensure databases are not publicly accessible",
          "Description": "Database resources should not publicly available. You should limit all access to the minimum that is required for your application to function.",
          "Message": "Database server has public network access enabled.",
          "Query": "data..",
          "Resolution": "Disable public access to database when not required",
          "Severity": "MEDIUM",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-azu-0022",
          "References": [
            "https://avd.aquasec.com/misconfig/avd-azu-0022"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "azurerm_mssql_server.mssql1",
            "Provider": "Azure",
            "Service": "database",
            "StartLine": 20,
            "EndLine": 37,
            "Code": {
              "Lines": [
                {
                  "Number": 20,
                  "Content": "resource \"azurerm_mssql_server\" \"mssql1\" {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 21,
                  "Content": "  name                         = \"terragoat-mssql1-${var.environment}${random_integer.rnd_int.result}\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 22,
                  "Content": "  resource_group_name          = azurerm_resource_group.example.name",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 23,
                  "Content": "  location                     = azurerm_resource_group.example.location",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 24,
                  "Content": "  version                      = \"12.0\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 25,
                  "Content": "  administrator_login          = \"missadministrator\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 26,
                  "Content": "  administrator_login_password = \"AdminPassword123!\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 27,
                  "Content": "  tags = {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 28,
                  "Content": "    git_commit           = \"c6f8caa51942284d02465518822685897ad90141\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 29,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "AVD-AZU-0022",
          "Title": "Ensure databases are not publicly accessible",
          "Description": "Database resources should not publicly available. You should limit all access to the minimum that is required for your application to function.",
          "Message": "Database server has public network access enabled.",
          "Query": "data..",
          "Resolution": "Disable public access to database when not required",
          "Severity": "MEDIUM",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-azu-0022",
          "References": [
            "https://avd.aquasec.com/misconfig/avd-azu-0022"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "azurerm_mssql_server.mssql2",
            "Provider": "Azure",
            "Service": "database",
            "StartLine": 39,
            "EndLine": 56,
            "Code": {
              "Lines": [
                {
                  "Number": 39,
                  "Content": "resource \"azurerm_mssql_server\" \"mssql2\" {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 40,
                  "Content": "  name                         = \"mssql2-${var.environment}${random_integer.rnd_int.result}\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 41,
                  "Content": "  resource_group_name          = azurerm_resource_group.example.name",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 42,
                  "Content": "  location                     = azurerm_resource_group.example.location",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 43,
                  "Content": "  version                      = \"12.0\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 44,
                  "Content": "  administrator_login          = \"missadministrator\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 45,
                  "Content": "  administrator_login_password = \"AdminPassword123!\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 46,
                  "Content": "  tags = {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 47,
                  "Content": "    git_commit           = \"c6f8caa51942284d02465518822685897ad90141\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 48,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "AVD-AZU-0022",
          "Title": "Ensure databases are not publicly accessible",
          "Description": "Database resources should not publicly available. You should limit all access to the minimum that is required for your application to function.",
          "Message": "Database server has public network access enabled.",
          "Query": "data..",
          "Resolution": "Disable public access to database when not required",
          "Severity": "MEDIUM",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-azu-0022",
          "References": [
            "https://avd.aquasec.com/misconfig/avd-azu-0022"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "azurerm_mssql_server.mssql3",
            "Provider": "Azure",
            "Service": "database",
            "StartLine": 58,
            "EndLine": 75,
            "Code": {
              "Lines": [
                {
                  "Number": 58,
                  "Content": "resource \"azurerm_mssql_server\" \"mssql3\" {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 59,
                  "Content": "  name                         = \"mssql3-${var.environment}${random_integer.rnd_int.result}\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 60,
                  "Content": "  resource_group_name          = azurerm_resource_group.example.name",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 61,
                  "Content": "  location                     = azurerm_resource_group.example.location",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 62,
                  "Content": "  version                      = \"12.0\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 63,
                  "Content": "  administrator_login          = \"missadministrator\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 64,
                  "Content": "  administrator_login_password = \"AdminPassword123!\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 65,
                  "Content": "  tags = {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 66,
                  "Content": "    git_commit           = \"c6f8caa51942284d02465518822685897ad90141\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 67,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "AVD-AZU-0022",
          "Title": "Ensure databases are not publicly accessible",
          "Description": "Database resources should not publicly available. You should limit all access to the minimum that is required for your application to function.",
          "Message": "Database server has public network access enabled.",
          "Query": "data..",
          "Resolution": "Disable public access to database when not required",
          "Severity": "MEDIUM",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-azu-0022",
          "References": [
            "https://avd.aquasec.com/misconfig/avd-azu-0022"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "azurerm_mssql_server.mssql4",
            "Provider": "Azure",
            "Service": "database",
            "StartLine": 77,
            "EndLine": 94,
            "Code": {
              "Lines": [
                {
                  "Number": 77,
                  "Content": "resource \"azurerm_mssql_server\" \"mssql4\" {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 78,
                  "Content": "  name                         = \"mssql4-${var.environment}${random_integer.rnd_int.result}\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 79,
                  "Content": "  resource_group_name          = azurerm_resource_group.example.name",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 80,
                  "Content": "  location                     = azurerm_resource_group.example.location",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 81,
                  "Content": "  version                      = \"12.0\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 82,
                  "Content": "  administrator_login          = \"missadministrator\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 83,
                  "Content": "  administrator_login_password = \"AdminPassword123!\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 84,
                  "Content": "  tags = {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 85,
                  "Content": "    git_commit           = \"c6f8caa51942284d02465518822685897ad90141\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 86,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "AVD-AZU-0022",
          "Title": "Ensure databases are not publicly accessible",
          "Description": "Database resources should not publicly available. You should limit all access to the minimum that is required for your application to function.",
          "Message": "Database server has public network access enabled.",
          "Query": "data..",
          "Resolution": "Disable public access to database when not required",
          "Severity": "MEDIUM",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-azu-0022",
          "References": [
            "https://avd.aquasec.com/misconfig/avd-azu-0022"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "azurerm_mssql_server.mssql7",
            "Provider": "Azure",
            "Service": "database",
            "StartLine": 134,
            "EndLine": 151,
            "Code": {
              "Lines": [
                {
                  "Number": 134,
                  "Content": "resource \"azurerm_mssql_server\" \"mssql7\" {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 135,
                  "Content": "  name                         = \"mssql7-${var.environment}${random_integer.rnd_int.result}\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 136,
                  "Content": "  resource_group_name          = azurerm_resource_group.example.name",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 137,
                  "Content": "  location                     = azurerm_resource_group.example.location",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 138,
                  "Content": "  version                      = \"12.0\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 139,
                  "Content": "  administrator_login          = \"missadministrator\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 140,
                  "Content": "  administrator_login_password = \"AdminPassword123!\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 141,
                  "Content": "  tags = {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 142,
                  "Content": "    git_commit           = \"c6f8caa51942284d02465518822685897ad90141\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 143,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "AVD-AZU-0023",
          "Title": "Security threat alerts go to subcription owners and co-administrators",
          "Description": "Subscription owners should be notified when there are security alerts. By ensuring the administrators of the account have been notified they can quickly assist in any required remediation",
          "Message": "Security alert policy does not alert account admins.",
          "Query": "data..",
          "Resolution": "Enable email to subscription owners",
          "Severity": "LOW",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-azu-0023",
          "References": [
            "https://avd.aquasec.com/misconfig/avd-azu-0023"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "azurerm_mssql_server_security_alert_policy.alertpolicy1",
            "Provider": "Azure",
            "Service": "database",
            "StartLine": 153,
            "EndLine": 165,
            "Code": {
              "Lines": [
                {
                  "Number": 153,
                  "Content": "resource \"azurerm_mssql_server_security_alert_policy\" \"alertpolicy1\" {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 154,
                  "Content": "  resource_group_name        = azurerm_resource_group.example.name",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 155,
                  "Content": "  server_name                = azurerm_mssql_server.mssql1.name",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 156,
                  "Content": "  state                      = \"Enabled\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 157,
                  "Content": "  storage_endpoint           = azurerm_storage_account.security_storage_account.primary_blob_endpoint",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 158,
                  "Content": "  storage_account_access_key = azurerm_storage_account.security_storage_account.primary_access_key",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 159,
                  "Content": "  disabled_alerts = [",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 160,
                  "Content": "    \"Sql_Injection\",",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 161,
                  "Content": "    \"Data_Exfiltration\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 162,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "AVD-AZU-0023",
          "Title": "Security threat alerts go to subcription owners and co-administrators",
          "Description": "Subscription owners should be notified when there are security alerts. By ensuring the administrators of the account have been notified they can quickly assist in any required remediation",
          "Message": "Security alert policy does not alert account admins.",
          "Query": "data..",
          "Resolution": "Enable email to subscription owners",
          "Severity": "LOW",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-azu-0023",
          "References": [
            "https://avd.aquasec.com/misconfig/avd-azu-0023"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "azurerm_mssql_server_security_alert_policy.alertpolicy5",
            "Provider": "Azure",
            "Service": "database",
            "StartLine": 209,
            "EndLine": 220,
            "Code": {
              "Lines": [
                {
                  "Number": 209,
                  "Content": "resource \"azurerm_mssql_server_security_alert_policy\" \"alertpolicy5\" {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 210,
                  "Content": "  resource_group_name        = azurerm_resource_group.example.name",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 211,
                  "Content": "  server_name                = azurerm_mssql_server.mssql5.name",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 212,
                  "Content": "  state                      = \"Enabled\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 213,
                  "Content": "  storage_endpoint           = azurerm_storage_account.security_storage_account.primary_blob_endpoint",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 214,
                  "Content": "  storage_account_access_key = azurerm_storage_account.security_storage_account.primary_access_key",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 215,
                  "Content": "  disabled_alerts = [",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 216,
                  "Content": "    \"Sql_Injection\",",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 217,
                  "Content": "    \"Data_Exfiltration\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 218,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "AVD-AZU-0023",
          "Title": "Security threat alerts go to subcription owners and co-administrators",
          "Description": "Subscription owners should be notified when there are security alerts. By ensuring the administrators of the account have been notified they can quickly assist in any required remediation",
          "Message": "Security alert policy does not alert account admins.",
          "Query": "data..",
          "Resolution": "Enable email to subscription owners",
          "Severity": "LOW",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-azu-0023",
          "References": [
            "https://avd.aquasec.com/misconfig/avd-azu-0023"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "azurerm_mssql_server_security_alert_policy.alertpolicy4",
            "Provider": "Azure",
            "Service": "database",
            "StartLine": 195,
            "EndLine": 207,
            "Code": {
              "Lines": [
                {
                  "Number": 195,
                  "Content": "resource \"azurerm_mssql_server_security_alert_policy\" \"alertpolicy4\" {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 196,
                  "Content": "  resource_group_name        = azurerm_resource_group.example.name",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 197,
                  "Content": "  server_name                = azurerm_mssql_server.mssql4.name",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 198,
                  "Content": "  state                      = \"Enabled\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 199,
                  "Content": "  storage_endpoint           = azurerm_storage_account.security_storage_account.primary_blob_endpoint",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 200,
                  "Content": "  storage_account_access_key = azurerm_storage_account.security_storage_account.primary_access_key",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 201,
                  "Content": "  disabled_alerts = [",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 202,
                  "Content": "    \"Sql_Injection\",",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 203,
                  "Content": "    \"Data_Exfiltration\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 204,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "AVD-AZU-0023",
          "Title": "Security threat alerts go to subcription owners and co-administrators",
          "Description": "Subscription owners should be notified when there are security alerts. By ensuring the administrators of the account have been notified they can quickly assist in any required remediation",
          "Message": "Security alert policy does not alert account admins.",
          "Query": "data..",
          "Resolution": "Enable email to subscription owners",
          "Severity": "LOW",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-azu-0023",
          "References": [
            "https://avd.aquasec.com/misconfig/avd-azu-0023"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "azurerm_mssql_server_security_alert_policy.alertpolicy3",
            "Provider": "Azure",
            "Service": "database",
            "StartLine": 181,
            "EndLine": 193,
            "Code": {
              "Lines": [
                {
                  "Number": 181,
                  "Content": "resource \"azurerm_mssql_server_security_alert_policy\" \"alertpolicy3\" {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 182,
                  "Content": "  resource_group_name        = azurerm_resource_group.example.name",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 183,
                  "Content": "  server_name                = azurerm_mssql_server.mssql3.name",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 184,
                  "Content": "  state                      = \"Enabled\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 185,
                  "Content": "  storage_endpoint           = azurerm_storage_account.security_storage_account.primary_blob_endpoint",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 186,
                  "Content": "  storage_account_access_key = azurerm_storage_account.security_storage_account.primary_access_key",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 187,
                  "Content": "  disabled_alerts = [",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 188,
                  "Content": "    \"Sql_Injection\",",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 189,
                  "Content": "    \"Data_Exfiltration\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 190,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "AVD-AZU-0023",
          "Title": "Security threat alerts go to subcription owners and co-administrators",
          "Description": "Subscription owners should be notified when there are security alerts. By ensuring the administrators of the account have been notified they can quickly assist in any required remediation",
          "Message": "Security alert policy does not alert account admins.",
          "Query": "data..",
          "Resolution": "Enable email to subscription owners",
          "Severity": "LOW",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-azu-0023",
          "References": [
            "https://avd.aquasec.com/misconfig/avd-azu-0023"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "azurerm_mssql_server_security_alert_policy.alertpolicy2",
            "Provider": "Azure",
            "Service": "database",
            "StartLine": 167,
            "EndLine": 179,
            "Code": {
              "Lines": [
                {
                  "Number": 167,
                  "Content": "resource \"azurerm_mssql_server_security_alert_policy\" \"alertpolicy2\" {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 168,
                  "Content": "  resource_group_name        = azurerm_resource_group.example.name",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 169,
                  "Content": "  server_name                = azurerm_mssql_server.mssql2.name",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 170,
                  "Content": "  state                      = \"Enabled\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 171,
                  "Content": "  storage_endpoint           = azurerm_storage_account.security_storage_account.primary_blob_endpoint",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 172,
                  "Content": "  storage_account_access_key = azurerm_storage_account.security_storage_account.primary_access_key",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 173,
                  "Content": "  disabled_alerts = [",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 174,
                  "Content": "    \"Sql_Injection\",",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 175,
                  "Content": "    \"Data_Exfiltration\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 176,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "AVD-AZU-0023",
          "Title": "Security threat alerts go to subcription owners and co-administrators",
          "Description": "Subscription owners should be notified when there are security alerts. By ensuring the administrators of the account have been notified they can quickly assist in any required remediation",
          "Message": "Security alert policy does not alert account admins.",
          "Query": "data..",
          "Resolution": "Enable email to subscription owners",
          "Severity": "LOW",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-azu-0023",
          "References": [
            "https://avd.aquasec.com/misconfig/avd-azu-0023"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "azurerm_mssql_server_security_alert_policy.alertpolicy6",
            "Provider": "Azure",
            "Service": "database",
            "StartLine": 222,
            "EndLine": 234,
            "Code": {
              "Lines": [
                {
                  "Number": 222,
                  "Content": "resource \"azurerm_mssql_server_security_alert_policy\" \"alertpolicy6\" {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 223,
                  "Content": "  resource_group_name        = azurerm_resource_group.example.name",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 224,
                  "Content": "  server_name                = azurerm_mssql_server.mssql6.name",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 225,
                  "Content": "  state                      = \"Enabled\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 226,
                  "Content": "  storage_endpoint           = azurerm_storage_account.security_storage_account.primary_blob_endpoint",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 227,
                  "Content": "  storage_account_access_key = azurerm_storage_account.security_storage_account.primary_access_key",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 228,
                  "Content": "  disabled_alerts = [",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 229,
                  "Content": "    \"Sql_Injection\",",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 230,
                  "Content": "    \"Data_Exfiltration\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 231,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "AVD-AZU-0023",
          "Title": "Security threat alerts go to subcription owners and co-administrators",
          "Description": "Subscription owners should be notified when there are security alerts. By ensuring the administrators of the account have been notified they can quickly assist in any required remediation",
          "Message": "Security alert policy does not alert account admins.",
          "Query": "data..",
          "Resolution": "Enable email to subscription owners",
          "Severity": "LOW",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-azu-0023",
          "References": [
            "https://avd.aquasec.com/misconfig/avd-azu-0023"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "azurerm_mssql_server_security_alert_policy.alertpolicy7",
            "Provider": "Azure",
            "Service": "database",
            "StartLine": 236,
            "EndLine": 248,
            "Code": {
              "Lines": [
                {
                  "Number": 236,
                  "Content": "resource \"azurerm_mssql_server_security_alert_policy\" \"alertpolicy7\" {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 237,
                  "Content": "  resource_group_name        = azurerm_resource_group.example.name",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 238,
                  "Content": "  server_name                = azurerm_mssql_server.mssql7.name",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 239,
                  "Content": "  state                      = \"Enabled\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 240,
                  "Content": "  storage_endpoint           = azurerm_storage_account.security_storage_account.primary_blob_endpoint",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 241,
                  "Content": "  storage_account_access_key = azurerm_storage_account.security_storage_account.primary_access_key",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 242,
                  "Content": "  disabled_alerts = [",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 243,
                  "Content": "    \"Sql_Injection\",",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 244,
                  "Content": "    \"Data_Exfiltration\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 245,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "AVD-AZU-0026",
          "Title": "Databases should have the minimum TLS set for connections",
          "Description": "You should not use outdated/insecure TLS versions for encryption. You should be using TLS v1.2+.",
          "Message": "Database server does not require a secure TLS version.",
          "Query": "data..",
          "Resolution": "Use the most modern TLS policies available",
          "Severity": "MEDIUM",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-azu-0026",
          "References": [
            "https://avd.aquasec.com/misconfig/avd-azu-0026"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "azurerm_mssql_server.mssql6",
            "Provider": "Azure",
            "Service": "database",
            "StartLine": 115,
            "EndLine": 132,
            "Code": {
              "Lines": [
                {
                  "Number": 115,
                  "Content": "resource \"azurerm_mssql_server\" \"mssql6\" {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 116,
                  "Content": "  name                         = \"mssql6-${var.environment}${random_integer.rnd_int.result}\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 117,
                  "Content": "  resource_group_name          = azurerm_resource_group.example.name",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 118,
                  "Content": "  location                     = azurerm_resource_group.example.location",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 119,
                  "Content": "  version                      = \"12.0\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 120,
                  "Content": "  administrator_login          = \"missadministrator\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 121,
                  "Content": "  administrator_login_password = \"AdminPassword123!\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 122,
                  "Content": "  tags = {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 123,
                  "Content": "    git_commit           = \"c6f8caa51942284d02465518822685897ad90141\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 124,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "AVD-AZU-0026",
          "Title": "Databases should have the minimum TLS set for connections",
          "Description": "You should not use outdated/insecure TLS versions for encryption. You should be using TLS v1.2+.",
          "Message": "Database server does not require a secure TLS version.",
          "Query": "data..",
          "Resolution": "Use the most modern TLS policies available",
          "Severity": "MEDIUM",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-azu-0026",
          "References": [
            "https://avd.aquasec.com/misconfig/avd-azu-0026"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "azurerm_mssql_server.mssql7",
            "Provider": "Azure",
            "Service": "database",
            "StartLine": 134,
            "EndLine": 151,
            "Code": {
              "Lines": [
                {
                  "Number": 134,
                  "Content": "resource \"azurerm_mssql_server\" \"mssql7\" {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 135,
                  "Content": "  name                         = \"mssql7-${var.environment}${random_integer.rnd_int.result}\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 136,
                  "Content": "  resource_group_name          = azurerm_resource_group.example.name",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 137,
                  "Content": "  location                     = azurerm_resource_group.example.location",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 138,
                  "Content": "  version                      = \"12.0\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 139,
                  "Content": "  administrator_login          = \"missadministrator\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 140,
                  "Content": "  administrator_login_password = \"AdminPassword123!\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 141,
                  "Content": "  tags = {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 142,
                  "Content": "    git_commit           = \"c6f8caa51942284d02465518822685897ad90141\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 143,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "AVD-AZU-0026",
          "Title": "Databases should have the minimum TLS set for connections",
          "Description": "You should not use outdated/insecure TLS versions for encryption. You should be using TLS v1.2+.",
          "Message": "Database server does not require a secure TLS version.",
          "Query": "data..",
          "Resolution": "Use the most modern TLS policies available",
          "Severity": "MEDIUM",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-azu-0026",
          "References": [
            "https://avd.aquasec.com/misconfig/avd-azu-0026"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "azurerm_mssql_server.mssql1",
            "Provider": "Azure",
            "Service": "database",
            "StartLine": 20,
            "EndLine": 37,
            "Code": {
              "Lines": [
                {
                  "Number": 20,
                  "Content": "resource \"azurerm_mssql_server\" \"mssql1\" {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 21,
                  "Content": "  name                         = \"terragoat-mssql1-${var.environment}${random_integer.rnd_int.result}\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 22,
                  "Content": "  resource_group_name          = azurerm_resource_group.example.name",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 23,
                  "Content": "  location                     = azurerm_resource_group.example.location",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 24,
                  "Content": "  version                      = \"12.0\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 25,
                  "Content": "  administrator_login          = \"missadministrator\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 26,
                  "Content": "  administrator_login_password = \"AdminPassword123!\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 27,
                  "Content": "  tags = {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 28,
                  "Content": "    git_commit           = \"c6f8caa51942284d02465518822685897ad90141\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 29,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "AVD-AZU-0026",
          "Title": "Databases should have the minimum TLS set for connections",
          "Description": "You should not use outdated/insecure TLS versions for encryption. You should be using TLS v1.2+.",
          "Message": "Database server does not require a secure TLS version.",
          "Query": "data..",
          "Resolution": "Use the most modern TLS policies available",
          "Severity": "MEDIUM",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-azu-0026",
          "References": [
            "https://avd.aquasec.com/misconfig/avd-azu-0026"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "azurerm_mssql_server.mssql2",
            "Provider": "Azure",
            "Service": "database",
            "StartLine": 39,
            "EndLine": 56,
            "Code": {
              "Lines": [
                {
                  "Number": 39,
                  "Content": "resource \"azurerm_mssql_server\" \"mssql2\" {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 40,
                  "Content": "  name                         = \"mssql2-${var.environment}${random_integer.rnd_int.result}\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 41,
                  "Content": "  resource_group_name          = azurerm_resource_group.example.name",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 42,
                  "Content": "  location                     = azurerm_resource_group.example.location",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 43,
                  "Content": "  version                      = \"12.0\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 44,
                  "Content": "  administrator_login          = \"missadministrator\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 45,
                  "Content": "  administrator_login_password = \"AdminPassword123!\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 46,
                  "Content": "  tags = {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 47,
                  "Content": "    git_commit           = \"c6f8caa51942284d02465518822685897ad90141\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 48,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "AVD-AZU-0026",
          "Title": "Databases should have the minimum TLS set for connections",
          "Description": "You should not use outdated/insecure TLS versions for encryption. You should be using TLS v1.2+.",
          "Message": "Database server does not require a secure TLS version.",
          "Query": "data..",
          "Resolution": "Use the most modern TLS policies available",
          "Severity": "MEDIUM",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-azu-0026",
          "References": [
            "https://avd.aquasec.com/misconfig/avd-azu-0026"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "azurerm_mssql_server.mssql5",
            "Provider": "Azure",
            "Service": "database",
            "StartLine": 96,
            "EndLine": 113,
            "Code": {
              "Lines": [
                {
                  "Number": 96,
                  "Content": "resource \"azurerm_mssql_server\" \"mssql5\" {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 97,
                  "Content": "  name                         = \"mssql5-${var.environment}${random_integer.rnd_int.result}\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 98,
                  "Content": "  resource_group_name          = azurerm_resource_group.example.name",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 99,
                  "Content": "  location                     = azurerm_resource_group.example.location",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 100,
                  "Content": "  version                      = \"12.0\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 101,
                  "Content": "  administrator_login          = \"missadministrator\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 102,
                  "Content": "  administrator_login_password = \"AdminPassword123!\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 103,
                  "Content": "  tags = {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 104,
                  "Content": "    git_commit           = \"c6f8caa51942284d02465518822685897ad90141\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 105,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "AVD-AZU-0026",
          "Title": "Databases should have the minimum TLS set for connections",
          "Description": "You should not use outdated/insecure TLS versions for encryption. You should be using TLS v1.2+.",
          "Message": "Database server does not require a secure TLS version.",
          "Query": "data..",
          "Resolution": "Use the most modern TLS policies available",
          "Severity": "MEDIUM",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-azu-0026",
          "References": [
            "https://avd.aquasec.com/misconfig/avd-azu-0026"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "azurerm_mssql_server.mssql4",
            "Provider": "Azure",
            "Service": "database",
            "StartLine": 77,
            "EndLine": 94,
            "Code": {
              "Lines": [
                {
                  "Number": 77,
                  "Content": "resource \"azurerm_mssql_server\" \"mssql4\" {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 78,
                  "Content": "  name                         = \"mssql4-${var.environment}${random_integer.rnd_int.result}\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 79,
                  "Content": "  resource_group_name          = azurerm_resource_group.example.name",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 80,
                  "Content": "  location                     = azurerm_resource_group.example.location",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 81,
                  "Content": "  version                      = \"12.0\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 82,
                  "Content": "  administrator_login          = \"missadministrator\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 83,
                  "Content": "  administrator_login_password = \"AdminPassword123!\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 84,
                  "Content": "  tags = {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 85,
                  "Content": "    git_commit           = \"c6f8caa51942284d02465518822685897ad90141\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 86,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "AVD-AZU-0026",
          "Title": "Databases should have the minimum TLS set for connections",
          "Description": "You should not use outdated/insecure TLS versions for encryption. You should be using TLS v1.2+.",
          "Message": "Database server does not require a secure TLS version.",
          "Query": "data..",
          "Resolution": "Use the most modern TLS policies available",
          "Severity": "MEDIUM",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-azu-0026",
          "References": [
            "https://avd.aquasec.com/misconfig/avd-azu-0026"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "azurerm_mssql_server.mssql3",
            "Provider": "Azure",
            "Service": "database",
            "StartLine": 58,
            "EndLine": 75,
            "Code": {
              "Lines": [
                {
                  "Number": 58,
                  "Content": "resource \"azurerm_mssql_server\" \"mssql3\" {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 59,
                  "Content": "  name                         = \"mssql3-${var.environment}${random_integer.rnd_int.result}\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 60,
                  "Content": "  resource_group_name          = azurerm_resource_group.example.name",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 61,
                  "Content": "  location                     = azurerm_resource_group.example.location",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 62,
                  "Content": "  version                      = \"12.0\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 63,
                  "Content": "  administrator_login          = \"missadministrator\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 64,
                  "Content": "  administrator_login_password = \"AdminPassword123!\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 65,
                  "Content": "  tags = {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 66,
                  "Content": "    git_commit           = \"c6f8caa51942284d02465518822685897ad90141\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 67,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "AVD-AZU-0027",
          "Title": "Auditing should be enabled on Azure SQL Databases",
          "Description": "Auditing helps you maintain regulatory compliance, understand database activity, and gain insight into discrepancies and anomalies that could indicate business concerns or suspected security violations.",
          "Message": "Server does not have an extended audit policy configured.",
          "Query": "data..",
          "Resolution": "Enable auditing on Azure SQL databases",
          "Severity": "MEDIUM",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-azu-0027",
          "References": [
            "https://docs.microsoft.com/en-us/azure/azure-sql/database/auditing-overview",
            "https://avd.aquasec.com/misconfig/avd-azu-0027"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "azurerm_mssql_server.mssql7",
            "Provider": "Azure",
            "Service": "database",
            "StartLine": 134,
            "EndLine": 151,
            "Code": {
              "Lines": [
                {
                  "Number": 134,
                  "Content": "resource \"azurerm_mssql_server\" \"mssql7\" {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 135,
                  "Content": "  name                         = \"mssql7-${var.environment}${random_integer.rnd_int.result}\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 136,
                  "Content": "  resource_group_name          = azurerm_resource_group.example.name",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 137,
                  "Content": "  location                     = azurerm_resource_group.example.location",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 138,
                  "Content": "  version                      = \"12.0\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 139,
                  "Content": "  administrator_login          = \"missadministrator\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 140,
                  "Content": "  administrator_login_password = \"AdminPassword123!\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 141,
                  "Content": "  tags = {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 142,
                  "Content": "    git_commit           = \"c6f8caa51942284d02465518822685897ad90141\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 143,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "AVD-AZU-0027",
          "Title": "Auditing should be enabled on Azure SQL Databases",
          "Description": "Auditing helps you maintain regulatory compliance, understand database activity, and gain insight into discrepancies and anomalies that could indicate business concerns or suspected security violations.",
          "Message": "Server does not have an extended audit policy configured.",
          "Query": "data..",
          "Resolution": "Enable auditing on Azure SQL databases",
          "Severity": "MEDIUM",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-azu-0027",
          "References": [
            "https://docs.microsoft.com/en-us/azure/azure-sql/database/auditing-overview",
            "https://avd.aquasec.com/misconfig/avd-azu-0027"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "azurerm_mssql_server.mssql6",
            "Provider": "Azure",
            "Service": "database",
            "StartLine": 115,
            "EndLine": 132,
            "Code": {
              "Lines": [
                {
                  "Number": 115,
                  "Content": "resource \"azurerm_mssql_server\" \"mssql6\" {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 116,
                  "Content": "  name                         = \"mssql6-${var.environment}${random_integer.rnd_int.result}\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 117,
                  "Content": "  resource_group_name          = azurerm_resource_group.example.name",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 118,
                  "Content": "  location                     = azurerm_resource_group.example.location",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 119,
                  "Content": "  version                      = \"12.0\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 120,
                  "Content": "  administrator_login          = \"missadministrator\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 121,
                  "Content": "  administrator_login_password = \"AdminPassword123!\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 122,
                  "Content": "  tags = {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 123,
                  "Content": "    git_commit           = \"c6f8caa51942284d02465518822685897ad90141\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 124,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "AVD-AZU-0027",
          "Title": "Auditing should be enabled on Azure SQL Databases",
          "Description": "Auditing helps you maintain regulatory compliance, understand database activity, and gain insight into discrepancies and anomalies that could indicate business concerns or suspected security violations.",
          "Message": "Server does not have an extended audit policy configured.",
          "Query": "data..",
          "Resolution": "Enable auditing on Azure SQL databases",
          "Severity": "MEDIUM",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-azu-0027",
          "References": [
            "https://docs.microsoft.com/en-us/azure/azure-sql/database/auditing-overview",
            "https://avd.aquasec.com/misconfig/avd-azu-0027"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "azurerm_mssql_server.mssql3",
            "Provider": "Azure",
            "Service": "database",
            "StartLine": 58,
            "EndLine": 75,
            "Code": {
              "Lines": [
                {
                  "Number": 58,
                  "Content": "resource \"azurerm_mssql_server\" \"mssql3\" {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 59,
                  "Content": "  name                         = \"mssql3-${var.environment}${random_integer.rnd_int.result}\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 60,
                  "Content": "  resource_group_name          = azurerm_resource_group.example.name",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 61,
                  "Content": "  location                     = azurerm_resource_group.example.location",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 62,
                  "Content": "  version                      = \"12.0\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 63,
                  "Content": "  administrator_login          = \"missadministrator\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 64,
                  "Content": "  administrator_login_password = \"AdminPassword123!\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 65,
                  "Content": "  tags = {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 66,
                  "Content": "    git_commit           = \"c6f8caa51942284d02465518822685897ad90141\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 67,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "AVD-AZU-0027",
          "Title": "Auditing should be enabled on Azure SQL Databases",
          "Description": "Auditing helps you maintain regulatory compliance, understand database activity, and gain insight into discrepancies and anomalies that could indicate business concerns or suspected security violations.",
          "Message": "Server does not have an extended audit policy configured.",
          "Query": "data..",
          "Resolution": "Enable auditing on Azure SQL databases",
          "Severity": "MEDIUM",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-azu-0027",
          "References": [
            "https://docs.microsoft.com/en-us/azure/azure-sql/database/auditing-overview",
            "https://avd.aquasec.com/misconfig/avd-azu-0027"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "azurerm_mssql_server.mssql4",
            "Provider": "Azure",
            "Service": "database",
            "StartLine": 77,
            "EndLine": 94,
            "Code": {
              "Lines": [
                {
                  "Number": 77,
                  "Content": "resource \"azurerm_mssql_server\" \"mssql4\" {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 78,
                  "Content": "  name                         = \"mssql4-${var.environment}${random_integer.rnd_int.result}\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 79,
                  "Content": "  resource_group_name          = azurerm_resource_group.example.name",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 80,
                  "Content": "  location                     = azurerm_resource_group.example.location",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 81,
                  "Content": "  version                      = \"12.0\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 82,
                  "Content": "  administrator_login          = \"missadministrator\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 83,
                  "Content": "  administrator_login_password = \"AdminPassword123!\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 84,
                  "Content": "  tags = {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 85,
                  "Content": "    git_commit           = \"c6f8caa51942284d02465518822685897ad90141\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 86,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "AVD-AZU-0027",
          "Title": "Auditing should be enabled on Azure SQL Databases",
          "Description": "Auditing helps you maintain regulatory compliance, understand database activity, and gain insight into discrepancies and anomalies that could indicate business concerns or suspected security violations.",
          "Message": "Server does not have an extended audit policy configured.",
          "Query": "data..",
          "Resolution": "Enable auditing on Azure SQL databases",
          "Severity": "MEDIUM",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-azu-0027",
          "References": [
            "https://docs.microsoft.com/en-us/azure/azure-sql/database/auditing-overview",
            "https://avd.aquasec.com/misconfig/avd-azu-0027"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "azurerm_mssql_server.mssql1",
            "Provider": "Azure",
            "Service": "database",
            "StartLine": 20,
            "EndLine": 37,
            "Code": {
              "Lines": [
                {
                  "Number": 20,
                  "Content": "resource \"azurerm_mssql_server\" \"mssql1\" {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 21,
                  "Content": "  name                         = \"terragoat-mssql1-${var.environment}${random_integer.rnd_int.result}\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 22,
                  "Content": "  resource_group_name          = azurerm_resource_group.example.name",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 23,
                  "Content": "  location                     = azurerm_resource_group.example.location",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 24,
                  "Content": "  version                      = \"12.0\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 25,
                  "Content": "  administrator_login          = \"missadministrator\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 26,
                  "Content": "  administrator_login_password = \"AdminPassword123!\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 27,
                  "Content": "  tags = {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 28,
                  "Content": "    git_commit           = \"c6f8caa51942284d02465518822685897ad90141\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 29,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "AVD-AZU-0027",
          "Title": "Auditing should be enabled on Azure SQL Databases",
          "Description": "Auditing helps you maintain regulatory compliance, understand database activity, and gain insight into discrepancies and anomalies that could indicate business concerns or suspected security violations.",
          "Message": "Server does not have an extended audit policy configured.",
          "Query": "data..",
          "Resolution": "Enable auditing on Azure SQL databases",
          "Severity": "MEDIUM",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-azu-0027",
          "References": [
            "https://docs.microsoft.com/en-us/azure/azure-sql/database/auditing-overview",
            "https://avd.aquasec.com/misconfig/avd-azu-0027"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "azurerm_mssql_server.mssql5",
            "Provider": "Azure",
            "Service": "database",
            "StartLine": 96,
            "EndLine": 113,
            "Code": {
              "Lines": [
                {
                  "Number": 96,
                  "Content": "resource \"azurerm_mssql_server\" \"mssql5\" {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 97,
                  "Content": "  name                         = \"mssql5-${var.environment}${random_integer.rnd_int.result}\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 98,
                  "Content": "  resource_group_name          = azurerm_resource_group.example.name",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 99,
                  "Content": "  location                     = azurerm_resource_group.example.location",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 100,
                  "Content": "  version                      = \"12.0\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 101,
                  "Content": "  administrator_login          = \"missadministrator\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 102,
                  "Content": "  administrator_login_password = \"AdminPassword123!\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 103,
                  "Content": "  tags = {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 104,
                  "Content": "    git_commit           = \"c6f8caa51942284d02465518822685897ad90141\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 105,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "AVD-AZU-0027",
          "Title": "Auditing should be enabled on Azure SQL Databases",
          "Description": "Auditing helps you maintain regulatory compliance, understand database activity, and gain insight into discrepancies and anomalies that could indicate business concerns or suspected security violations.",
          "Message": "Server does not have an extended audit policy configured.",
          "Query": "data..",
          "Resolution": "Enable auditing on Azure SQL databases",
          "Severity": "MEDIUM",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-azu-0027",
          "References": [
            "https://docs.microsoft.com/en-us/azure/azure-sql/database/auditing-overview",
            "https://avd.aquasec.com/misconfig/avd-azu-0027"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "azurerm_mssql_server.mssql2",
            "Provider": "Azure",
            "Service": "database",
            "StartLine": 39,
            "EndLine": 56,
            "Code": {
              "Lines": [
                {
                  "Number": 39,
                  "Content": "resource \"azurerm_mssql_server\" \"mssql2\" {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 40,
                  "Content": "  name                         = \"mssql2-${var.environment}${random_integer.rnd_int.result}\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 41,
                  "Content": "  resource_group_name          = azurerm_resource_group.example.name",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 42,
                  "Content": "  location                     = azurerm_resource_group.example.location",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 43,
                  "Content": "  version                      = \"12.0\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 44,
                  "Content": "  administrator_login          = \"missadministrator\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 45,
                  "Content": "  administrator_login_password = \"AdminPassword123!\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 46,
                  "Content": "  tags = {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 47,
                  "Content": "    git_commit           = \"c6f8caa51942284d02465518822685897ad90141\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 48,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "AVD-AZU-0028",
          "Title": "No threat detections are set",
          "Description": "SQL Server can alert for security issues including SQL Injection, vulnerabilities, access anomalies and data exfiltration. Ensure none of these are disabled to benefit from the best protection",
          "Message": "Server has a security alert policy which disables alerts.",
          "Query": "data..",
          "Resolution": "Use all provided threat alerts",
          "Severity": "MEDIUM",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-azu-0028",
          "References": [
            "https://avd.aquasec.com/misconfig/avd-azu-0028"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "azurerm_mssql_server_security_alert_policy.alertpolicy5",
            "Provider": "Azure",
            "Service": "database",
            "StartLine": 215,
            "EndLine": 218,
            "Code": {
              "Lines": [
                {
                  "Number": 209,
                  "Content": "resource \"azurerm_mssql_server_security_alert_policy\" \"alertpolicy5\" {",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 210,
                  "Content": "  resource_group_name        = azurerm_resource_group.example.name",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 211,
                  "Content": "  server_name                = azurerm_mssql_server.mssql5.name",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 212,
                  "Content": "  state                      = \"Enabled\"",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 213,
                  "Content": "  storage_endpoint           = azurerm_storage_account.security_storage_account.primary_blob_endpoint",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 214,
                  "Content": "  storage_account_access_key = azurerm_storage_account.security_storage_account.primary_access_key",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 215,
                  "Content": "  disabled_alerts = [",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 216,
                  "Content": "    \"Sql_Injection\",",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 217,
                  "Content": "    \"Data_Exfiltration\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 218,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "AVD-AZU-0028",
          "Title": "No threat detections are set",
          "Description": "SQL Server can alert for security issues including SQL Injection, vulnerabilities, access anomalies and data exfiltration. Ensure none of these are disabled to benefit from the best protection",
          "Message": "Server has a security alert policy which disables alerts.",
          "Query": "data..",
          "Resolution": "Use all provided threat alerts",
          "Severity": "MEDIUM",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-azu-0028",
          "References": [
            "https://avd.aquasec.com/misconfig/avd-azu-0028"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "azurerm_mssql_server_security_alert_policy.alertpolicy4",
            "Provider": "Azure",
            "Service": "database",
            "StartLine": 201,
            "EndLine": 204,
            "Code": {
              "Lines": [
                {
                  "Number": 195,
                  "Content": "resource \"azurerm_mssql_server_security_alert_policy\" \"alertpolicy4\" {",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 196,
                  "Content": "  resource_group_name        = azurerm_resource_group.example.name",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 197,
                  "Content": "  server_name                = azurerm_mssql_server.mssql4.name",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 198,
                  "Content": "  state                      = \"Enabled\"",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 199,
                  "Content": "  storage_endpoint           = azurerm_storage_account.security_storage_account.primary_blob_endpoint",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 200,
                  "Content": "  storage_account_access_key = azurerm_storage_account.security_storage_account.primary_access_key",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 201,
                  "Content": "  disabled_alerts = [",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 202,
                  "Content": "    \"Sql_Injection\",",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 203,
                  "Content": "    \"Data_Exfiltration\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 204,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "AVD-AZU-0028",
          "Title": "No threat detections are set",
          "Description": "SQL Server can alert for security issues including SQL Injection, vulnerabilities, access anomalies and data exfiltration. Ensure none of these are disabled to benefit from the best protection",
          "Message": "Server has a security alert policy which disables alerts.",
          "Query": "data..",
          "Resolution": "Use all provided threat alerts",
          "Severity": "MEDIUM",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-azu-0028",
          "References": [
            "https://avd.aquasec.com/misconfig/avd-azu-0028"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "azurerm_mssql_server_security_alert_policy.alertpolicy3",
            "Provider": "Azure",
            "Service": "database",
            "StartLine": 187,
            "EndLine": 190,
            "Code": {
              "Lines": [
                {
                  "Number": 181,
                  "Content": "resource \"azurerm_mssql_server_security_alert_policy\" \"alertpolicy3\" {",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 182,
                  "Content": "  resource_group_name        = azurerm_resource_group.example.name",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 183,
                  "Content": "  server_name                = azurerm_mssql_server.mssql3.name",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 184,
                  "Content": "  state                      = \"Enabled\"",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 185,
                  "Content": "  storage_endpoint           = azurerm_storage_account.security_storage_account.primary_blob_endpoint",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 186,
                  "Content": "  storage_account_access_key = azurerm_storage_account.security_storage_account.primary_access_key",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 187,
                  "Content": "  disabled_alerts = [",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 188,
                  "Content": "    \"Sql_Injection\",",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 189,
                  "Content": "    \"Data_Exfiltration\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 190,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "AVD-AZU-0028",
          "Title": "No threat detections are set",
          "Description": "SQL Server can alert for security issues including SQL Injection, vulnerabilities, access anomalies and data exfiltration. Ensure none of these are disabled to benefit from the best protection",
          "Message": "Server has a security alert policy which disables alerts.",
          "Query": "data..",
          "Resolution": "Use all provided threat alerts",
          "Severity": "MEDIUM",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-azu-0028",
          "References": [
            "https://avd.aquasec.com/misconfig/avd-azu-0028"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "azurerm_mssql_server_security_alert_policy.alertpolicy2",
            "Provider": "Azure",
            "Service": "database",
            "StartLine": 173,
            "EndLine": 176,
            "Code": {
              "Lines": [
                {
                  "Number": 167,
                  "Content": "resource \"azurerm_mssql_server_security_alert_policy\" \"alertpolicy2\" {",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 168,
                  "Content": "  resource_group_name        = azurerm_resource_group.example.name",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 169,
                  "Content": "  server_name                = azurerm_mssql_server.mssql2.name",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 170,
                  "Content": "  state                      = \"Enabled\"",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 171,
                  "Content": "  storage_endpoint           = azurerm_storage_account.security_storage_account.primary_blob_endpoint",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 172,
                  "Content": "  storage_account_access_key = azurerm_storage_account.security_storage_account.primary_access_key",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 173,
                  "Content": "  disabled_alerts = [",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 174,
                  "Content": "    \"Sql_Injection\",",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 175,
                  "Content": "    \"Data_Exfiltration\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 176,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "AVD-AZU-0028",
          "Title": "No threat detections are set",
          "Description": "SQL Server can alert for security issues including SQL Injection, vulnerabilities, access anomalies and data exfiltration. Ensure none of these are disabled to benefit from the best protection",
          "Message": "Server has a security alert policy which disables alerts.",
          "Query": "data..",
          "Resolution": "Use all provided threat alerts",
          "Severity": "MEDIUM",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-azu-0028",
          "References": [
            "https://avd.aquasec.com/misconfig/avd-azu-0028"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "azurerm_mssql_server_security_alert_policy.alertpolicy1",
            "Provider": "Azure",
            "Service": "database",
            "StartLine": 159,
            "EndLine": 162,
            "Code": {
              "Lines": [
                {
                  "Number": 153,
                  "Content": "resource \"azurerm_mssql_server_security_alert_policy\" \"alertpolicy1\" {",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 154,
                  "Content": "  resource_group_name        = azurerm_resource_group.example.name",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 155,
                  "Content": "  server_name                = azurerm_mssql_server.mssql1.name",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 156,
                  "Content": "  state                      = \"Enabled\"",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 157,
                  "Content": "  storage_endpoint           = azurerm_storage_account.security_storage_account.primary_blob_endpoint",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 158,
                  "Content": "  storage_account_access_key = azurerm_storage_account.security_storage_account.primary_access_key",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 159,
                  "Content": "  disabled_alerts = [",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 160,
                  "Content": "    \"Sql_Injection\",",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 161,
                  "Content": "    \"Data_Exfiltration\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 162,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "AVD-AZU-0028",
          "Title": "No threat detections are set",
          "Description": "SQL Server can alert for security issues including SQL Injection, vulnerabilities, access anomalies and data exfiltration. Ensure none of these are disabled to benefit from the best protection",
          "Message": "Server has a security alert policy which disables alerts.",
          "Query": "data..",
          "Resolution": "Use all provided threat alerts",
          "Severity": "MEDIUM",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-azu-0028",
          "References": [
            "https://avd.aquasec.com/misconfig/avd-azu-0028"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "azurerm_mssql_server_security_alert_policy.alertpolicy6",
            "Provider": "Azure",
            "Service": "database",
            "StartLine": 228,
            "EndLine": 231,
            "Code": {
              "Lines": [
                {
                  "Number": 222,
                  "Content": "resource \"azurerm_mssql_server_security_alert_policy\" \"alertpolicy6\" {",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 223,
                  "Content": "  resource_group_name        = azurerm_resource_group.example.name",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 224,
                  "Content": "  server_name                = azurerm_mssql_server.mssql6.name",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 225,
                  "Content": "  state                      = \"Enabled\"",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 226,
                  "Content": "  storage_endpoint           = azurerm_storage_account.security_storage_account.primary_blob_endpoint",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 227,
                  "Content": "  storage_account_access_key = azurerm_storage_account.security_storage_account.primary_access_key",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 228,
                  "Content": "  disabled_alerts = [",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 229,
                  "Content": "    \"Sql_Injection\",",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 230,
                  "Content": "    \"Data_Exfiltration\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 231,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "AVD-AZU-0028",
          "Title": "No threat detections are set",
          "Description": "SQL Server can alert for security issues including SQL Injection, vulnerabilities, access anomalies and data exfiltration. Ensure none of these are disabled to benefit from the best protection",
          "Message": "Server has a security alert policy which disables alerts.",
          "Query": "data..",
          "Resolution": "Use all provided threat alerts",
          "Severity": "MEDIUM",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-azu-0028",
          "References": [
            "https://avd.aquasec.com/misconfig/avd-azu-0028"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "azurerm_mssql_server_security_alert_policy.alertpolicy7",
            "Provider": "Azure",
            "Service": "database",
            "StartLine": 242,
            "EndLine": 245,
            "Code": {
              "Lines": [
                {
                  "Number": 236,
                  "Content": "resource \"azurerm_mssql_server_security_alert_policy\" \"alertpolicy7\" {",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 237,
                  "Content": "  resource_group_name        = azurerm_resource_group.example.name",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 238,
                  "Content": "  server_name                = azurerm_mssql_server.mssql7.name",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 239,
                  "Content": "  state                      = \"Enabled\"",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 240,
                  "Content": "  storage_endpoint           = azurerm_storage_account.security_storage_account.primary_blob_endpoint",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 241,
                  "Content": "  storage_account_access_key = azurerm_storage_account.security_storage_account.primary_access_key",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 242,
                  "Content": "  disabled_alerts = [",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 243,
                  "Content": "    \"Sql_Injection\",",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 244,
                  "Content": "    \"Data_Exfiltration\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 245,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        }
      ]
    },
    {
      "Target": "terraform/azure/networking.tf",
      "Class": "config",
      "Type": "terraform",
      "MisconfSummary": {
        "Successes": 2,
        "Failures": 5,
        "Exceptions": 0
      },
      "Misconfigurations": [
        {
          "Type": "Terraform Security Check",
          "ID": "AVD-AZU-0047",
          "Title": "An inbound network security rule allows traffic from /0.",
          "Description": "Network security rules should not use very broad subnets.\n\nWhere possible, segments should be broken into smaller subnets.",
          "Message": "Security group rule allows ingress from public internet.",
          "Query": "data..",
          "Resolution": "Set a more restrictive cidr range",
          "Severity": "CRITICAL",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-azu-0047",
          "References": [
            "https://docs.microsoft.com/en-us/azure/security/fundamentals/network-best-practices",
            "https://avd.aquasec.com/misconfig/avd-azu-0047"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "azurerm_network_security_group.bad_sg",
            "Provider": "Azure",
            "Service": "network",
            "StartLine": 92,
            "EndLine": 92,
            "Code": {
              "Lines": [
                {
                  "Number": 69,
                  "Content": "resource azurerm_network_security_group \"bad_sg\" {",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 70,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 92,
                  "Content": "    source_address_prefix      = \"*\"",
                  "IsCause": true,
                  "Annotation": "\"*\"",
                  "Truncated": false,
                  "FirstCause": true,
                  "LastCause": true
                },
                {
                  "Number": 106,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 107,
                  "Content": "}",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "AVD-AZU-0047",
          "Title": "An inbound network security rule allows traffic from /0.",
          "Description": "Network security rules should not use very broad subnets.\n\nWhere possible, segments should be broken into smaller subnets.",
          "Message": "Security group rule allows ingress from public internet.",
          "Query": "data..",
          "Resolution": "Set a more restrictive cidr range",
          "Severity": "CRITICAL",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-azu-0047",
          "References": [
            "https://docs.microsoft.com/en-us/azure/security/fundamentals/network-best-practices",
            "https://avd.aquasec.com/misconfig/avd-azu-0047"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "azurerm_network_security_group.bad_sg",
            "Provider": "Azure",
            "Service": "network",
            "StartLine": 80,
            "EndLine": 80,
            "Code": {
              "Lines": [
                {
                  "Number": 69,
                  "Content": "resource azurerm_network_security_group \"bad_sg\" {",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 70,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 80,
                  "Content": "    source_address_prefix      = \"*\"",
                  "IsCause": true,
                  "Annotation": "\"*\"",
                  "Truncated": false,
                  "FirstCause": true,
                  "LastCause": true
                },
                {
                  "Number": 106,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 107,
                  "Content": "}",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "AVD-AZU-0048",
          "Title": "RDP access should not be accessible from the Internet, should be blocked on port 3389",
          "Description": "RDP access can be configured on either the network security group or in the network security group rule.\n\nRDP access should not be permitted from the internet (*, 0.0.0.0, /0, internet, any). Consider using the Azure Bastion Service.",
          "Message": "Security group rule allows ingress to RDP port from multiple public internet addresses.",
          "Query": "data..",
          "Resolution": "Block RDP port from internet",
          "Severity": "CRITICAL",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-azu-0048",
          "References": [
            "https://docs.microsoft.com/en-us/azure/bastion/tutorial-create-host-portal",
            "https://avd.aquasec.com/misconfig/avd-azu-0048"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "azurerm_network_security_group.bad_sg",
            "Provider": "Azure",
            "Service": "network",
            "StartLine": 92,
            "EndLine": 92,
            "Code": {
              "Lines": [
                {
                  "Number": 69,
                  "Content": "resource azurerm_network_security_group \"bad_sg\" {",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 70,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 92,
                  "Content": "    source_address_prefix      = \"*\"",
                  "IsCause": true,
                  "Annotation": "\"*\"",
                  "Truncated": false,
                  "FirstCause": true,
                  "LastCause": true
                },
                {
                  "Number": 106,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 107,
                  "Content": "}",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "AVD-AZU-0049",
          "Title": "Retention policy for flow logs should be enabled and set to greater than 90 days",
          "Description": "Flow logs are the source of truth for all network activity in your cloud environment. \nTo enable analysis in security event that was detected late, you need to have the logs available. \n\t\t\t\nSetting an retention policy will help ensure as much information is available for review.",
          "Message": "Flow log does not enable the log retention policy.",
          "Query": "data..",
          "Resolution": "Ensure flow log retention is turned on with an expiry of \u003e90 days",
          "Severity": "LOW",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-azu-0049",
          "References": [
            "https://docs.microsoft.com/en-us/azure/network-watcher/network-watcher-monitoring-overview",
            "https://avd.aquasec.com/misconfig/avd-azu-0049"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "azurerm_network_watcher_flow_log.flow_log",
            "Provider": "Azure",
            "Service": "network",
            "StartLine": 132,
            "EndLine": 132,
            "Code": {
              "Lines": [
                {
                  "Number": 125,
                  "Content": "resource azurerm_network_watcher_flow_log \"flow_log\" {",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 126,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 132,
                  "Content": "    enabled = false",
                  "IsCause": true,
                  "Annotation": "false",
                  "Truncated": false,
                  "FirstCause": true,
                  "LastCause": true
                },
                {
                  "Number": 144,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 145,
                  "Content": "}",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "AVD-AZU-0050",
          "Title": "SSH access should not be accessible from the Internet, should be blocked on port 22",
          "Description": "SSH access can be configured on either the network security group or in the network security group rule. \n\nSSH access should not be permitted from the internet (*, 0.0.0.0, /0, internet, any)",
          "Message": "Security group rule allows ingress to SSH port from multiple public internet addresses.",
          "Query": "data..",
          "Resolution": "Block port 22 access from the internet",
          "Severity": "CRITICAL",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-azu-0050",
          "References": [
            "https://avd.aquasec.com/misconfig/avd-azu-0050"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "azurerm_network_security_group.bad_sg",
            "Provider": "Azure",
            "Service": "network",
            "StartLine": 80,
            "EndLine": 80,
            "Code": {
              "Lines": [
                {
                  "Number": 69,
                  "Content": "resource azurerm_network_security_group \"bad_sg\" {",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 70,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 80,
                  "Content": "    source_address_prefix      = \"*\"",
                  "IsCause": true,
                  "Annotation": "\"*\"",
                  "Truncated": false,
                  "FirstCause": true,
                  "LastCause": true
                },
                {
                  "Number": 106,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 107,
                  "Content": "}",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        }
      ]
    },
    {
      "Target": "terraform/azure/roles.tf",
      "Class": "config",
      "Type": "terraform",
      "MisconfSummary": {
        "Successes": 1,
        "Failures": 0,
        "Exceptions": 0
      }
    },
    {
      "Target": "terraform/azure/security_center.tf",
      "Class": "config",
      "Type": "terraform",
      "MisconfSummary": {
        "Successes": 0,
        "Failures": 3,
        "Exceptions": 0
      },
      "Misconfigurations": [
        {
          "Type": "Terraform Security Check",
          "ID": "AVD-AZU-0044",
          "Title": "Send notification emails for high severity alerts",
          "Description": "It is recommended that at least one valid contact is configured for the security center. \nMicrosoft will notify the security contact directly in the event of a security incident using email and require alerting to be turned on.",
          "Message": "Security contact has alert notifications disabled.",
          "Query": "data..",
          "Resolution": " Set alert notifications to be on",
          "Severity": "MEDIUM",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-azu-0044",
          "References": [
            "https://azure.microsoft.com/en-us/services/security-center/",
            "https://avd.aquasec.com/misconfig/avd-azu-0044"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "azurerm_security_center_contact.contact",
            "Provider": "Azure",
            "Service": "security-center",
            "StartLine": 6,
            "EndLine": 6,
            "Code": {
              "Lines": [
                {
                  "Number": 5,
                  "Content": "resource azurerm_security_center_contact \"contact\" {",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 6,
                  "Content": "  alert_notifications = false",
                  "IsCause": true,
                  "Annotation": "false",
                  "Truncated": false,
                  "FirstCause": true,
                  "LastCause": true
                },
                {
                  "Number": 7,
                  "Content": "  alerts_to_admins    = false",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 8,
                  "Content": "  email               = \"some@email.com\"",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 9,
                  "Content": "}",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "AVD-AZU-0045",
          "Title": "Enable the standard security center subscription tier",
          "Description": "To benefit from Azure Defender you should use the Standard subscription tier.\n\t\t\t\n\t\t\tEnabling Azure Defender extends the capabilities of the free mode to workloads running in private and other public clouds, providing unified security management and threat protection across your hybrid cloud workloads.",
          "Message": "Security center subscription uses the free tier.",
          "Query": "data..",
          "Resolution": "Enable standard subscription tier to benefit from Azure Defender",
          "Severity": "LOW",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-azu-0045",
          "References": [
            "https://docs.microsoft.com/en-us/azure/security-center/security-center-pricing",
            "https://avd.aquasec.com/misconfig/avd-azu-0045"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "azurerm_security_center_subscription_pricing.pricing",
            "Provider": "Azure",
            "Service": "security-center",
            "StartLine": 2,
            "EndLine": 2,
            "Code": {
              "Lines": [
                {
                  "Number": 1,
                  "Content": "resource azurerm_security_center_subscription_pricing \"pricing\" {",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 2,
                  "Content": "  tier = \"Free\"",
                  "IsCause": true,
                  "Annotation": "\"Free\"",
                  "Truncated": false,
                  "FirstCause": true,
                  "LastCause": true
                },
                {
                  "Number": 3,
                  "Content": "}",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "AVD-AZU-0046",
          "Title": "The required contact details should be set for security center",
          "Description": "It is recommended that at least one valid contact is configured for the security center. \nMicrosoft will notify the security contact directly in the event of a security incident and will look to use a telephone number in cases where a prompt response is required.",
          "Message": "Security contact does not have a phone number listed.",
          "Query": "data..",
          "Resolution": "Set a telephone number for security center contact",
          "Severity": "LOW",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-azu-0046",
          "References": [
            "https://azure.microsoft.com/en-us/services/security-center/",
            "https://avd.aquasec.com/misconfig/avd-azu-0046"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "azurerm_security_center_contact.contact",
            "Provider": "Azure",
            "Service": "security-center",
            "StartLine": 5,
            "EndLine": 9,
            "Code": {
              "Lines": [
                {
                  "Number": 5,
                  "Content": "resource azurerm_security_center_contact \"contact\" {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 6,
                  "Content": "  alert_notifications = false",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 7,
                  "Content": "  alerts_to_admins    = false",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 8,
                  "Content": "  email               = \"some@email.com\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 9,
                  "Content": "}",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": true
                }
              ]
            }
          }
        }
      ]
    },
    {
      "Target": "terraform/azure/sql.tf",
      "Class": "config",
      "Type": "terraform",
      "MisconfSummary": {
        "Successes": 1,
        "Failures": 15,
        "Exceptions": 0
      },
      "Misconfigurations": [
        {
          "Type": "Terraform Security Check",
          "ID": "AVD-AZU-0018",
          "Title": "At least one email address is set for threat alerts",
          "Description": "SQL Server sends alerts for threat detection via email, if there are no email addresses set then mitigation will be delayed.",
          "Message": "Security alert policy does not include any email addresses for notification.",
          "Query": "data..",
          "Resolution": "Provide at least one email address for threat alerts",
          "Severity": "MEDIUM",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-azu-0018",
          "References": [
            "https://avd.aquasec.com/misconfig/avd-azu-0018"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "azurerm_mssql_server_security_alert_policy.example",
            "Provider": "Azure",
            "Service": "database",
            "StartLine": 31,
            "EndLine": 42,
            "Code": {
              "Lines": [
                {
                  "Number": 31,
                  "Content": "resource \"azurerm_mssql_server_security_alert_policy\" \"example\" {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 32,
                  "Content": "  resource_group_name        = azurerm_resource_group.example.name",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 33,
                  "Content": "  server_name                = azurerm_sql_server.example.name",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 34,
                  "Content": "  state                      = \"Enabled\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 35,
                  "Content": "  storage_endpoint           = azurerm_storage_account.example.primary_blob_endpoint",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 36,
                  "Content": "  storage_account_access_key = azurerm_storage_account.example.primary_access_key",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 37,
                  "Content": "  disabled_alerts = [",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 38,
                  "Content": "    \"Sql_Injection\",",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 39,
                  "Content": "    \"Data_Exfiltration\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 40,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "AVD-AZU-0019",
          "Title": "Ensure server parameter 'log_connections' is set to 'ON' for PostgreSQL Database Server",
          "Description": "Postgresql can generate logs for successful connections to improve visibility for audit and configuration issue resolution.",
          "Message": "Database server is not configured to log connections.",
          "Query": "data..",
          "Resolution": "Enable connection logging",
          "Severity": "MEDIUM",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-azu-0019",
          "References": [
            "https://docs.microsoft.com/en-us/azure/postgresql/concepts-server-logs#configure-logging",
            "https://avd.aquasec.com/misconfig/avd-azu-0019"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "azurerm_postgresql_server.example",
            "Provider": "Azure",
            "Service": "database",
            "StartLine": 73,
            "EndLine": 96,
            "Code": {
              "Lines": [
                {
                  "Number": 73,
                  "Content": "resource \"azurerm_postgresql_server\" \"example\" {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 74,
                  "Content": "  name                         = \"terragoat-postgresql-${var.environment}${random_integer.rnd_int.result}\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 75,
                  "Content": "  location                     = azurerm_resource_group.example.location",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 76,
                  "Content": "  resource_group_name          = azurerm_resource_group.example.name",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 77,
                  "Content": "  sku_name                     = \"B_Gen5_2\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 78,
                  "Content": "  storage_mb                   = 5120",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 79,
                  "Content": "  backup_retention_days        = 7",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 80,
                  "Content": "  geo_redundant_backup_enabled = false",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 81,
                  "Content": "  auto_grow_enabled            = true",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 82,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "AVD-AZU-0020",
          "Title": "SSL should be enforced on database connections where applicable",
          "Description": "SSL connections should be enforced were available to ensure secure transfer and reduce the risk of compromising data in flight.",
          "Message": "Database server does not have enforce SSL.",
          "Query": "data..",
          "Resolution": "Enable SSL enforcement",
          "Severity": "MEDIUM",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-azu-0020",
          "References": [
            "https://avd.aquasec.com/misconfig/avd-azu-0020"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "azurerm_postgresql_server.example",
            "Provider": "Azure",
            "Service": "database",
            "StartLine": 85,
            "EndLine": 85,
            "Code": {
              "Lines": [
                {
                  "Number": 73,
                  "Content": "resource \"azurerm_postgresql_server\" \"example\" {",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 74,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 85,
                  "Content": "  ssl_enforcement_enabled      = false",
                  "IsCause": true,
                  "Annotation": "false",
                  "Truncated": false,
                  "FirstCause": true,
                  "LastCause": true
                },
                {
                  "Number": 95,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 96,
                  "Content": "}",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "AVD-AZU-0020",
          "Title": "SSL should be enforced on database connections where applicable",
          "Description": "SSL connections should be enforced were available to ensure secure transfer and reduce the risk of compromising data in flight.",
          "Message": "Database server does not have enforce SSL.",
          "Query": "data..",
          "Resolution": "Enable SSL enforcement",
          "Severity": "MEDIUM",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-azu-0020",
          "References": [
            "https://avd.aquasec.com/misconfig/avd-azu-0020"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "azurerm_mysql_server.example",
            "Provider": "Azure",
            "Service": "database",
            "StartLine": 60,
            "EndLine": 60,
            "Code": {
              "Lines": [
                {
                  "Number": 44,
                  "Content": "resource \"azurerm_mysql_server\" \"example\" {",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 45,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 60,
                  "Content": "  ssl_enforcement_enabled           = false",
                  "IsCause": true,
                  "Annotation": "false",
                  "Truncated": false,
                  "FirstCause": true,
                  "LastCause": true
                },
                {
                  "Number": 70,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 71,
                  "Content": "}",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "AVD-AZU-0021",
          "Title": "Ensure server parameter 'connection_throttling' is set to 'ON' for PostgreSQL Database Server",
          "Description": "Postgresql can generate logs for connection throttling to improve visibility for audit and configuration issue resolution.",
          "Message": "Database server is not configured to throttle connections.",
          "Query": "data..",
          "Resolution": "Enable connection throttling logging",
          "Severity": "MEDIUM",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-azu-0021",
          "References": [
            "https://docs.microsoft.com/en-us/azure/postgresql/concepts-server-logs#configure-logging",
            "https://avd.aquasec.com/misconfig/avd-azu-0021"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "azurerm_postgresql_configuration.thrtottling_config",
            "Provider": "Azure",
            "Service": "database",
            "StartLine": 102,
            "EndLine": 102,
            "Code": {
              "Lines": [
                {
                  "Number": 98,
                  "Content": "resource \"azurerm_postgresql_configuration\" \"thrtottling_config\" {",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 99,
                  "Content": "  name                = \"connection_throttling\"",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 100,
                  "Content": "  resource_group_name = azurerm_resource_group.example.name",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 101,
                  "Content": "  server_name         = azurerm_postgresql_server.example.name",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 102,
                  "Content": "  value               = \"off\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": true,
                  "LastCause": true
                },
                {
                  "Number": 103,
                  "Content": "}",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "AVD-AZU-0022",
          "Title": "Ensure databases are not publicly accessible",
          "Description": "Database resources should not publicly available. You should limit all access to the minimum that is required for your application to function.",
          "Message": "Database server has public network access enabled.",
          "Query": "data..",
          "Resolution": "Disable public access to database when not required",
          "Severity": "MEDIUM",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-azu-0022",
          "References": [
            "https://avd.aquasec.com/misconfig/avd-azu-0022"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "azurerm_sql_server.example",
            "Provider": "Azure",
            "Service": "database",
            "StartLine": 9,
            "EndLine": 29,
            "Code": {
              "Lines": [
                {
                  "Number": 9,
                  "Content": "resource \"azurerm_sql_server\" \"example\" {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 10,
                  "Content": "  name                         = \"terragoat-sqlserver-${var.environment}${random_integer.rnd_int.result}\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 11,
                  "Content": "  resource_group_name          = azurerm_resource_group.example.name",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 12,
                  "Content": "  location                     = azurerm_resource_group.example.location",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 13,
                  "Content": "  version                      = \"12.0\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 14,
                  "Content": "  administrator_login          = \"ariel\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 15,
                  "Content": "  administrator_login_password = \"Aa12345678\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 16,
                  "Content": "  tags = merge({",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 17,
                  "Content": "    environment = var.environment",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 18,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "AVD-AZU-0022",
          "Title": "Ensure databases are not publicly accessible",
          "Description": "Database resources should not publicly available. You should limit all access to the minimum that is required for your application to function.",
          "Message": "Database server has public network access enabled.",
          "Query": "data..",
          "Resolution": "Disable public access to database when not required",
          "Severity": "MEDIUM",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-azu-0022",
          "References": [
            "https://avd.aquasec.com/misconfig/avd-azu-0022"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "azurerm_postgresql_server.example",
            "Provider": "Azure",
            "Service": "database",
            "StartLine": 73,
            "EndLine": 96,
            "Code": {
              "Lines": [
                {
                  "Number": 73,
                  "Content": "resource \"azurerm_postgresql_server\" \"example\" {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 74,
                  "Content": "  name                         = \"terragoat-postgresql-${var.environment}${random_integer.rnd_int.result}\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 75,
                  "Content": "  location                     = azurerm_resource_group.example.location",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 76,
                  "Content": "  resource_group_name          = azurerm_resource_group.example.name",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 77,
                  "Content": "  sku_name                     = \"B_Gen5_2\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 78,
                  "Content": "  storage_mb                   = 5120",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 79,
                  "Content": "  backup_retention_days        = 7",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 80,
                  "Content": "  geo_redundant_backup_enabled = false",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 81,
                  "Content": "  auto_grow_enabled            = true",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 82,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "AVD-AZU-0022",
          "Title": "Ensure databases are not publicly accessible",
          "Description": "Database resources should not publicly available. You should limit all access to the minimum that is required for your application to function.",
          "Message": "Database server has public network access enabled.",
          "Query": "data..",
          "Resolution": "Disable public access to database when not required",
          "Severity": "MEDIUM",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-azu-0022",
          "References": [
            "https://avd.aquasec.com/misconfig/avd-azu-0022"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "azurerm_mysql_server.example",
            "Provider": "Azure",
            "Service": "database",
            "StartLine": 59,
            "EndLine": 59,
            "Code": {
              "Lines": [
                {
                  "Number": 44,
                  "Content": "resource \"azurerm_mysql_server\" \"example\" {",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 45,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 59,
                  "Content": "  public_network_access_enabled     = true",
                  "IsCause": true,
                  "Annotation": "true",
                  "Truncated": false,
                  "FirstCause": true,
                  "LastCause": true
                },
                {
                  "Number": 70,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 71,
                  "Content": "}",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "AVD-AZU-0023",
          "Title": "Security threat alerts go to subcription owners and co-administrators",
          "Description": "Subscription owners should be notified when there are security alerts. By ensuring the administrators of the account have been notified they can quickly assist in any required remediation",
          "Message": "Security alert policy does not alert account admins.",
          "Query": "data..",
          "Resolution": "Enable email to subscription owners",
          "Severity": "LOW",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-azu-0023",
          "References": [
            "https://avd.aquasec.com/misconfig/avd-azu-0023"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "azurerm_mssql_server_security_alert_policy.example",
            "Provider": "Azure",
            "Service": "database",
            "StartLine": 31,
            "EndLine": 42,
            "Code": {
              "Lines": [
                {
                  "Number": 31,
                  "Content": "resource \"azurerm_mssql_server_security_alert_policy\" \"example\" {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 32,
                  "Content": "  resource_group_name        = azurerm_resource_group.example.name",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 33,
                  "Content": "  server_name                = azurerm_sql_server.example.name",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 34,
                  "Content": "  state                      = \"Enabled\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 35,
                  "Content": "  storage_endpoint           = azurerm_storage_account.example.primary_blob_endpoint",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 36,
                  "Content": "  storage_account_access_key = azurerm_storage_account.example.primary_access_key",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 37,
                  "Content": "  disabled_alerts = [",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 38,
                  "Content": "    \"Sql_Injection\",",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 39,
                  "Content": "    \"Data_Exfiltration\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 40,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "AVD-AZU-0024",
          "Title": "Ensure server parameter 'log_checkpoints' is set to 'ON' for PostgreSQL Database Server",
          "Description": "Postgresql can generate logs for checkpoints to improve visibility for audit and configuration issue resolution.",
          "Message": "Database server is not configured to log checkpoints.",
          "Query": "data..",
          "Resolution": "Enable checkpoint logging",
          "Severity": "MEDIUM",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-azu-0024",
          "References": [
            "https://docs.microsoft.com/en-us/azure/postgresql/concepts-server-logs#configure-logging",
            "https://avd.aquasec.com/misconfig/avd-azu-0024"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "azurerm_postgresql_configuration.example",
            "Provider": "Azure",
            "Service": "database",
            "StartLine": 109,
            "EndLine": 109,
            "Code": {
              "Lines": [
                {
                  "Number": 105,
                  "Content": "resource \"azurerm_postgresql_configuration\" \"example\" {",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 106,
                  "Content": "  name                = \"log_checkpoints\"",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 107,
                  "Content": "  resource_group_name = azurerm_resource_group.example.name",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 108,
                  "Content": "  server_name         = azurerm_postgresql_server.example.name",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 109,
                  "Content": "  value               = \"off\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": true,
                  "LastCause": true
                },
                {
                  "Number": 110,
                  "Content": "}",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "AVD-AZU-0026",
          "Title": "Databases should have the minimum TLS set for connections",
          "Description": "You should not use outdated/insecure TLS versions for encryption. You should be using TLS v1.2+.",
          "Message": "Database server does not require a secure TLS version.",
          "Query": "data..",
          "Resolution": "Use the most modern TLS policies available",
          "Severity": "MEDIUM",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-azu-0026",
          "References": [
            "https://avd.aquasec.com/misconfig/avd-azu-0026"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "azurerm_sql_server.example",
            "Provider": "Azure",
            "Service": "database",
            "StartLine": 9,
            "EndLine": 29,
            "Code": {
              "Lines": [
                {
                  "Number": 9,
                  "Content": "resource \"azurerm_sql_server\" \"example\" {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 10,
                  "Content": "  name                         = \"terragoat-sqlserver-${var.environment}${random_integer.rnd_int.result}\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 11,
                  "Content": "  resource_group_name          = azurerm_resource_group.example.name",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 12,
                  "Content": "  location                     = azurerm_resource_group.example.location",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 13,
                  "Content": "  version                      = \"12.0\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 14,
                  "Content": "  administrator_login          = \"ariel\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 15,
                  "Content": "  administrator_login_password = \"Aa12345678\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 16,
                  "Content": "  tags = merge({",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 17,
                  "Content": "    environment = var.environment",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 18,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "AVD-AZU-0026",
          "Title": "Databases should have the minimum TLS set for connections",
          "Description": "You should not use outdated/insecure TLS versions for encryption. You should be using TLS v1.2+.",
          "Message": "Database server does not require a secure TLS version.",
          "Query": "data..",
          "Resolution": "Use the most modern TLS policies available",
          "Severity": "MEDIUM",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-azu-0026",
          "References": [
            "https://avd.aquasec.com/misconfig/avd-azu-0026"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "azurerm_postgresql_server.example",
            "Provider": "Azure",
            "Service": "database",
            "StartLine": 73,
            "EndLine": 96,
            "Code": {
              "Lines": [
                {
                  "Number": 73,
                  "Content": "resource \"azurerm_postgresql_server\" \"example\" {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 74,
                  "Content": "  name                         = \"terragoat-postgresql-${var.environment}${random_integer.rnd_int.result}\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 75,
                  "Content": "  location                     = azurerm_resource_group.example.location",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 76,
                  "Content": "  resource_group_name          = azurerm_resource_group.example.name",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 77,
                  "Content": "  sku_name                     = \"B_Gen5_2\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 78,
                  "Content": "  storage_mb                   = 5120",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 79,
                  "Content": "  backup_retention_days        = 7",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 80,
                  "Content": "  geo_redundant_backup_enabled = false",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 81,
                  "Content": "  auto_grow_enabled            = true",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 82,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "AVD-AZU-0026",
          "Title": "Databases should have the minimum TLS set for connections",
          "Description": "You should not use outdated/insecure TLS versions for encryption. You should be using TLS v1.2+.",
          "Message": "Database server does not require a secure TLS version.",
          "Query": "data..",
          "Resolution": "Use the most modern TLS policies available",
          "Severity": "MEDIUM",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-azu-0026",
          "References": [
            "https://avd.aquasec.com/misconfig/avd-azu-0026"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "azurerm_mysql_server.example",
            "Provider": "Azure",
            "Service": "database",
            "StartLine": 44,
            "EndLine": 71,
            "Code": {
              "Lines": [
                {
                  "Number": 44,
                  "Content": "resource \"azurerm_mysql_server\" \"example\" {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 45,
                  "Content": "  name                = \"terragoat-mysql-${var.environment}${random_integer.rnd_int.result}\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 46,
                  "Content": "  location            = azurerm_resource_group.example.location",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 47,
                  "Content": "  resource_group_name = azurerm_resource_group.example.name",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 48,
                  "Content": "",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 49,
                  "Content": "  administrator_login          = \"terragoat-${var.environment}\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 50,
                  "Content": "  administrator_login_password = random_string.password.result",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 51,
                  "Content": "",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 52,
                  "Content": "  sku_name   = \"B_Gen5_2\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 53,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "AVD-AZU-0027",
          "Title": "Auditing should be enabled on Azure SQL Databases",
          "Description": "Auditing helps you maintain regulatory compliance, understand database activity, and gain insight into discrepancies and anomalies that could indicate business concerns or suspected security violations.",
          "Message": "Server does not have an extended audit policy configured.",
          "Query": "data..",
          "Resolution": "Enable auditing on Azure SQL databases",
          "Severity": "MEDIUM",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-azu-0027",
          "References": [
            "https://docs.microsoft.com/en-us/azure/azure-sql/database/auditing-overview",
            "https://avd.aquasec.com/misconfig/avd-azu-0027"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "azurerm_sql_server.example",
            "Provider": "Azure",
            "Service": "database",
            "StartLine": 9,
            "EndLine": 29,
            "Code": {
              "Lines": [
                {
                  "Number": 9,
                  "Content": "resource \"azurerm_sql_server\" \"example\" {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 10,
                  "Content": "  name                         = \"terragoat-sqlserver-${var.environment}${random_integer.rnd_int.result}\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 11,
                  "Content": "  resource_group_name          = azurerm_resource_group.example.name",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 12,
                  "Content": "  location                     = azurerm_resource_group.example.location",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 13,
                  "Content": "  version                      = \"12.0\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 14,
                  "Content": "  administrator_login          = \"ariel\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 15,
                  "Content": "  administrator_login_password = \"Aa12345678\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 16,
                  "Content": "  tags = merge({",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 17,
                  "Content": "    environment = var.environment",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 18,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "AVD-AZU-0028",
          "Title": "No threat detections are set",
          "Description": "SQL Server can alert for security issues including SQL Injection, vulnerabilities, access anomalies and data exfiltration. Ensure none of these are disabled to benefit from the best protection",
          "Message": "Server has a security alert policy which disables alerts.",
          "Query": "data..",
          "Resolution": "Use all provided threat alerts",
          "Severity": "MEDIUM",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-azu-0028",
          "References": [
            "https://avd.aquasec.com/misconfig/avd-azu-0028"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "azurerm_mssql_server_security_alert_policy.example",
            "Provider": "Azure",
            "Service": "database",
            "StartLine": 37,
            "EndLine": 40,
            "Code": {
              "Lines": [
                {
                  "Number": 31,
                  "Content": "resource \"azurerm_mssql_server_security_alert_policy\" \"example\" {",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 32,
                  "Content": "  resource_group_name        = azurerm_resource_group.example.name",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 33,
                  "Content": "  server_name                = azurerm_sql_server.example.name",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 34,
                  "Content": "  state                      = \"Enabled\"",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 35,
                  "Content": "  storage_endpoint           = azurerm_storage_account.example.primary_blob_endpoint",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 36,
                  "Content": "  storage_account_access_key = azurerm_storage_account.example.primary_access_key",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 37,
                  "Content": "  disabled_alerts = [",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 38,
                  "Content": "    \"Sql_Injection\",",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 39,
                  "Content": "    \"Data_Exfiltration\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 40,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        }
      ]
    },
    {
      "Target": "terraform/azure/storage.tf",
      "Class": "config",
      "Type": "terraform",
      "MisconfSummary": {
        "Successes": 3,
        "Failures": 3,
        "Exceptions": 0
      },
      "Misconfigurations": [
        {
          "Type": "Terraform Security Check",
          "ID": "AVD-AZU-0010",
          "Title": "Trusted Microsoft Services should have bypass access to Storage accounts",
          "Description": "Some Microsoft services that interact with storage accounts operate from networks that can't be granted access through network rules. \n\nTo help this type of service work as intended, allow the set of trusted Microsoft services to bypass the network rules",
          "Message": "Network rules do not allow bypass for Microsoft Services.",
          "Query": "data..",
          "Resolution": "Allow Trusted Microsoft Services to bypass",
          "Severity": "HIGH",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-azu-0010",
          "References": [
            "https://docs.microsoft.com/en-us/azure/storage/common/storage-network-security#trusted-microsoft-services",
            "https://avd.aquasec.com/misconfig/avd-azu-0010"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "azurerm_storage_account_network_rules.test",
            "Provider": "Azure",
            "Service": "storage",
            "StartLine": 62,
            "EndLine": 69,
            "Code": {
              "Lines": [
                {
                  "Number": 62,
                  "Content": "resource \"azurerm_storage_account_network_rules\" \"test\" {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 63,
                  "Content": "  resource_group_name  = azurerm_resource_group.example.name",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 64,
                  "Content": "  storage_account_name = azurerm_storage_account.example.name",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 65,
                  "Content": "",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 66,
                  "Content": "  default_action = \"Deny\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 67,
                  "Content": "  ip_rules       = [\"127.0.0.1\"]",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 68,
                  "Content": "  bypass         = [\"Metrics\"]",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 69,
                  "Content": "}",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": true
                }
              ]
            }
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "AVD-AZU-0011",
          "Title": "The minimum TLS version for Storage Accounts should be TLS1_2",
          "Description": "Azure Storage currently supports three versions of the TLS protocol: 1.0, 1.1, and 1.2. \n\nAzure Storage uses TLS 1.2 on public HTTPS endpoints, but TLS 1.0 and TLS 1.1 are still supported for backward compatibility.\n\nThis check will warn if the minimum TLS is not set to TLS1_2.",
          "Message": "Storage account uses an insecure TLS version.",
          "Query": "data..",
          "Resolution": "Use a more recent TLS/SSL policy for the load balancer",
          "Severity": "CRITICAL",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-azu-0011",
          "References": [
            "https://docs.microsoft.com/en-us/azure/storage/common/transport-layer-security-configure-minimum-version",
            "https://avd.aquasec.com/misconfig/avd-azu-0011"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "azurerm_storage_account.example",
            "Provider": "Azure",
            "Service": "storage",
            "StartLine": 23,
            "EndLine": 60,
            "Code": {
              "Lines": [
                {
                  "Number": 23,
                  "Content": "resource \"azurerm_storage_account\" \"example\" {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 24,
                  "Content": "  name                     = \"tgsa${var.environment}${random_integer.rnd_int.result}\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 25,
                  "Content": "  resource_group_name      = azurerm_resource_group.example.name",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 26,
                  "Content": "  location                 = azurerm_resource_group.example.location",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 27,
                  "Content": "  account_tier             = \"Standard\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 28,
                  "Content": "  account_replication_type = \"GRS\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 29,
                  "Content": "  queue_properties {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 30,
                  "Content": "    logging {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 31,
                  "Content": "      delete                = false",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 32,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "AVD-AZU-0038",
          "Title": "Enable disk encryption on managed disk",
          "Description": "Manage disks should be encrypted at rest. When specifying the \u003ccode\u003eencryption_settings\u003c/code\u003e block, the enabled attribute should be set to \u003ccode\u003etrue\u003c/code\u003e.",
          "Message": "Managed disk is not encrypted.",
          "Query": "data..",
          "Resolution": "Enable encryption on managed disks",
          "Severity": "HIGH",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-azu-0038",
          "References": [
            "https://docs.microsoft.com/en-us/azure/virtual-machines/linux/disk-encryption",
            "https://avd.aquasec.com/misconfig/avd-azu-0038"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "azurerm_managed_disk.example",
            "Provider": "Azure",
            "Service": "compute",
            "StartLine": 9,
            "EndLine": 9,
            "Code": {
              "Lines": [
                {
                  "Number": 1,
                  "Content": "resource \"azurerm_managed_disk\" \"example\" {",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 2,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 9,
                  "Content": "    enabled = false",
                  "IsCause": true,
                  "Annotation": "false",
                  "Truncated": false,
                  "FirstCause": true,
                  "LastCause": true
                },
                {
                  "Number": 20,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 21,
                  "Content": "}",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        }
      ]
    },
    {
      "Target": "terraform/gcp/big_data.tf",
      "Class": "config",
      "Type": "terraform",
      "MisconfSummary": {
        "Successes": 2,
        "Failures": 10,
        "Exceptions": 0
      },
      "Misconfigurations": [
        {
          "Type": "Terraform Security Check",
          "ID": "AVD-GCP-0014",
          "Title": "Temporary file logging should be enabled for all temporary files.",
          "Description": "Temporary files are not logged by default. To log all temporary files, a value of `0` should set in the `log_temp_files` flag - as all files greater in size than the number of bytes set in this flag will be logged.",
          "Message": "Database instance has temporary file logging disabled.",
          "Query": "data..",
          "Resolution": "Enable temporary file logging for all files",
          "Severity": "MEDIUM",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-gcp-0014",
          "References": [
            "https://postgresqlco.nf/doc/en/param/log_temp_files/",
            "https://avd.aquasec.com/misconfig/avd-gcp-0014"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "google_sql_database_instance.master_instance",
            "Provider": "Google",
            "Service": "sql",
            "StartLine": 1,
            "EndLine": 19,
            "Code": {
              "Lines": [
                {
                  "Number": 1,
                  "Content": "resource \"google_sql_database_instance\" \"master_instance\" {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 2,
                  "Content": "  name             = \"terragoat-${var.environment}-master\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 3,
                  "Content": "  database_version = \"POSTGRES_11\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 4,
                  "Content": "  region           = var.region",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 5,
                  "Content": "",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 6,
                  "Content": "  settings {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 7,
                  "Content": "    tier = \"db-f1-micro\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 8,
                  "Content": "    ip_configuration {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 9,
                  "Content": "      ipv4_enabled = true",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 10,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "AVD-GCP-0015",
          "Title": "SSL connections to a SQL database instance should be enforced.",
          "Description": "In-transit data should be encrypted so that if traffic is intercepted data will not be exposed in plaintext to attackers.",
          "Message": "Database instance does not require TLS for all connections.",
          "Query": "data..",
          "Resolution": "Enforce SSL for all connections",
          "Severity": "HIGH",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-gcp-0015",
          "References": [
            "https://cloud.google.com/sql/docs/mysql/configure-ssl-instance",
            "https://avd.aquasec.com/misconfig/avd-gcp-0015"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "google_sql_database_instance.master_instance",
            "Provider": "Google",
            "Service": "sql",
            "StartLine": 8,
            "EndLine": 14,
            "Code": {
              "Lines": [
                {
                  "Number": 1,
                  "Content": "resource \"google_sql_database_instance\" \"master_instance\" {",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 2,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 8,
                  "Content": "    ip_configuration {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 9,
                  "Content": "      ipv4_enabled = true",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 10,
                  "Content": "      authorized_networks {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 11,
                  "Content": "        name  = \"WWW\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 12,
                  "Content": "        value = \"0.0.0.0/0\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 13,
                  "Content": "      }",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 14,
                  "Content": "    }",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 18,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "AVD-GCP-0016",
          "Title": "Ensure that logging of connections is enabled.",
          "Description": "Logging connections provides useful diagnostic data such as session length, which can identify performance issues in an application and potential DoS vectors.",
          "Message": "Database instance is not configured to log connections.",
          "Query": "data..",
          "Resolution": "Enable connection logging.",
          "Severity": "MEDIUM",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-gcp-0016",
          "References": [
            "https://www.postgresql.org/docs/13/runtime-config-logging.html#GUC-LOG-CONNECTIONS",
            "https://avd.aquasec.com/misconfig/avd-gcp-0016"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "google_sql_database_instance.master_instance",
            "Provider": "Google",
            "Service": "sql",
            "StartLine": 1,
            "EndLine": 19,
            "Code": {
              "Lines": [
                {
                  "Number": 1,
                  "Content": "resource \"google_sql_database_instance\" \"master_instance\" {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 2,
                  "Content": "  name             = \"terragoat-${var.environment}-master\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 3,
                  "Content": "  database_version = \"POSTGRES_11\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 4,
                  "Content": "  region           = var.region",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 5,
                  "Content": "",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 6,
                  "Content": "  settings {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 7,
                  "Content": "    tier = \"db-f1-micro\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 8,
                  "Content": "    ip_configuration {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 9,
                  "Content": "      ipv4_enabled = true",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 10,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "AVD-GCP-0017",
          "Title": "Ensure that Cloud SQL Database Instances are not publicly exposed",
          "Description": "Database instances should be configured so that they are not available over the public internet, but to internal compute resources which access them.",
          "Message": "Database instance allows access from the public internet.",
          "Query": "data..",
          "Resolution": "Remove public access from database instances",
          "Severity": "HIGH",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-gcp-0017",
          "References": [
            "https://www.cloudconformity.com/knowledge-base/gcp/CloudSQL/publicly-accessible-cloud-sql-instances.html",
            "https://avd.aquasec.com/misconfig/avd-gcp-0017"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "google_sql_database_instance.master_instance",
            "Provider": "Google",
            "Service": "sql",
            "StartLine": 12,
            "EndLine": 12,
            "Code": {
              "Lines": [
                {
                  "Number": 1,
                  "Content": "resource \"google_sql_database_instance\" \"master_instance\" {",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 2,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 12,
                  "Content": "        value = \"0.0.0.0/0\"",
                  "IsCause": true,
                  "Annotation": "\"0.0.0.0/0\"",
                  "Truncated": false,
                  "FirstCause": true,
                  "LastCause": true
                },
                {
                  "Number": 18,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 19,
                  "Content": "}",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "AVD-GCP-0017",
          "Title": "Ensure that Cloud SQL Database Instances are not publicly exposed",
          "Description": "Database instances should be configured so that they are not available over the public internet, but to internal compute resources which access them.",
          "Message": "Database instance is granted a public internet address.",
          "Query": "data..",
          "Resolution": "Remove public access from database instances",
          "Severity": "HIGH",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-gcp-0017",
          "References": [
            "https://www.cloudconformity.com/knowledge-base/gcp/CloudSQL/publicly-accessible-cloud-sql-instances.html",
            "https://avd.aquasec.com/misconfig/avd-gcp-0017"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "google_sql_database_instance.master_instance",
            "Provider": "Google",
            "Service": "sql",
            "StartLine": 9,
            "EndLine": 9,
            "Code": {
              "Lines": [
                {
                  "Number": 1,
                  "Content": "resource \"google_sql_database_instance\" \"master_instance\" {",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 2,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 9,
                  "Content": "      ipv4_enabled = true",
                  "IsCause": true,
                  "Annotation": "true",
                  "Truncated": false,
                  "FirstCause": true,
                  "LastCause": true
                },
                {
                  "Number": 18,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 19,
                  "Content": "}",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "AVD-GCP-0020",
          "Title": "Ensure that logging of lock waits is enabled.",
          "Description": "Lock waits are often an indication of poor performance and often an indicator of a potential denial of service vulnerability, therefore occurrences should be logged for analysis.",
          "Message": "Database instance is not configured to log lock waits.",
          "Query": "data..",
          "Resolution": "Enable lock wait logging.",
          "Severity": "MEDIUM",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-gcp-0020",
          "References": [
            "https://www.postgresql.org/docs/13/runtime-config-logging.html#GUC-LOG-LOCK-WAITS",
            "https://avd.aquasec.com/misconfig/avd-gcp-0020"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "google_sql_database_instance.master_instance",
            "Provider": "Google",
            "Service": "sql",
            "StartLine": 1,
            "EndLine": 19,
            "Code": {
              "Lines": [
                {
                  "Number": 1,
                  "Content": "resource \"google_sql_database_instance\" \"master_instance\" {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 2,
                  "Content": "  name             = \"terragoat-${var.environment}-master\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 3,
                  "Content": "  database_version = \"POSTGRES_11\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 4,
                  "Content": "  region           = var.region",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 5,
                  "Content": "",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 6,
                  "Content": "  settings {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 7,
                  "Content": "    tier = \"db-f1-micro\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 8,
                  "Content": "    ip_configuration {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 9,
                  "Content": "      ipv4_enabled = true",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 10,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "AVD-GCP-0022",
          "Title": "Ensure that logging of disconnections is enabled.",
          "Description": "Logging disconnections provides useful diagnostic data such as session length, which can identify performance issues in an application and potential DoS vectors.",
          "Message": "Database instance is not configured to log disconnections.",
          "Query": "data..",
          "Resolution": "Enable disconnection logging.",
          "Severity": "MEDIUM",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-gcp-0022",
          "References": [
            "https://www.postgresql.org/docs/13/runtime-config-logging.html#GUC-LOG-DISCONNECTIONS",
            "https://avd.aquasec.com/misconfig/avd-gcp-0022"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "google_sql_database_instance.master_instance",
            "Provider": "Google",
            "Service": "sql",
            "StartLine": 1,
            "EndLine": 19,
            "Code": {
              "Lines": [
                {
                  "Number": 1,
                  "Content": "resource \"google_sql_database_instance\" \"master_instance\" {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 2,
                  "Content": "  name             = \"terragoat-${var.environment}-master\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 3,
                  "Content": "  database_version = \"POSTGRES_11\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 4,
                  "Content": "  region           = var.region",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 5,
                  "Content": "",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 6,
                  "Content": "  settings {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 7,
                  "Content": "    tier = \"db-f1-micro\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 8,
                  "Content": "    ip_configuration {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 9,
                  "Content": "      ipv4_enabled = true",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 10,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "AVD-GCP-0024",
          "Title": "Enable automated backups to recover from data-loss",
          "Description": "Automated backups are not enabled by default. Backups are an easy way to restore data in a corruption or data-loss scenario.",
          "Message": "Database instance does not have backups enabled.",
          "Query": "data..",
          "Resolution": "Enable automated backups",
          "Severity": "MEDIUM",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-gcp-0024",
          "References": [
            "https://cloud.google.com/sql/docs/mysql/backup-recovery/backups",
            "https://avd.aquasec.com/misconfig/avd-gcp-0024"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "google_sql_database_instance.master_instance",
            "Provider": "Google",
            "Service": "sql",
            "StartLine": 16,
            "EndLine": 16,
            "Code": {
              "Lines": [
                {
                  "Number": 1,
                  "Content": "resource \"google_sql_database_instance\" \"master_instance\" {",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 2,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 16,
                  "Content": "      enabled = false",
                  "IsCause": true,
                  "Annotation": "false",
                  "Truncated": false,
                  "FirstCause": true,
                  "LastCause": true
                },
                {
                  "Number": 18,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 19,
                  "Content": "}",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "AVD-GCP-0025",
          "Title": "Ensure that logging of checkpoints is enabled.",
          "Description": "Logging checkpoints provides useful diagnostic data, which can identify performance issues in an application and potential DoS vectors.",
          "Message": "Database instance is not configured to log checkpoints.",
          "Query": "data..",
          "Resolution": "Enable checkpoints logging.",
          "Severity": "MEDIUM",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-gcp-0025",
          "References": [
            "https://www.postgresql.org/docs/13/runtime-config-logging.html#GUC-LOG-CHECKPOINTS",
            "https://avd.aquasec.com/misconfig/avd-gcp-0025"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "google_sql_database_instance.master_instance",
            "Provider": "Google",
            "Service": "sql",
            "StartLine": 1,
            "EndLine": 19,
            "Code": {
              "Lines": [
                {
                  "Number": 1,
                  "Content": "resource \"google_sql_database_instance\" \"master_instance\" {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 2,
                  "Content": "  name             = \"terragoat-${var.environment}-master\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 3,
                  "Content": "  database_version = \"POSTGRES_11\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 4,
                  "Content": "  region           = var.region",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 5,
                  "Content": "",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 6,
                  "Content": "  settings {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 7,
                  "Content": "    tier = \"db-f1-micro\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 8,
                  "Content": "    ip_configuration {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 9,
                  "Content": "      ipv4_enabled = true",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 10,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "AVD-GCP-0046",
          "Title": "BigQuery datasets should only be accessible within the organisation",
          "Description": "Using 'allAuthenticatedUsers' provides any GCP user - even those outside of your organisation - access to your BigQuery dataset.",
          "Message": "Dataset grants access to all authenticated GCP users.",
          "Query": "data..",
          "Resolution": "Configure access permissions with higher granularity",
          "Severity": "CRITICAL",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-gcp-0046",
          "References": [
            "https://avd.aquasec.com/misconfig/avd-gcp-0046"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "google_bigquery_dataset.dataset",
            "Provider": "Google",
            "Service": "bigquery",
            "StartLine": 24,
            "EndLine": 24,
            "Code": {
              "Lines": [
                {
                  "Number": 21,
                  "Content": "resource \"google_bigquery_dataset\" \"dataset\" {",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 22,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 24,
                  "Content": "    special_group = \"allAuthenticatedUsers\"",
                  "IsCause": true,
                  "Annotation": "\"allAuthenticatedUsers\"",
                  "Truncated": false,
                  "FirstCause": true,
                  "LastCause": true
                },
                {
                  "Number": 36,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 37,
                  "Content": "}",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        }
      ]
    },
    {
      "Target": "terraform/gcp/gcs.tf",
      "Class": "config",
      "Type": "terraform",
      "MisconfSummary": {
        "Successes": 3,
        "Failures": 2,
        "Exceptions": 0
      },
      "Misconfigurations": [
        {
          "Type": "Terraform Security Check",
          "ID": "AVD-GCP-0001",
          "Title": "Ensure that Cloud Storage bucket is not anonymously or publicly accessible.",
          "Description": "Using 'allUsers' or 'allAuthenticatedUsers' as members in an IAM member/binding causes data to be exposed outside of the organisation.",
          "Message": "Bucket allows public access.",
          "Query": "data..",
          "Resolution": "Restrict public access to the bucket.",
          "Severity": "HIGH",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-gcp-0001",
          "References": [
            "https://jbrojbrojbro.medium.com/you-make-the-rules-with-authentication-controls-for-cloud-storage-53c32543747b",
            "https://avd.aquasec.com/misconfig/avd-gcp-0001"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "google_storage_bucket_iam_binding.allow_public_read",
            "Provider": "Google",
            "Service": "storage",
            "StartLine": 19,
            "EndLine": 19,
            "Code": {
              "Lines": [
                {
                  "Number": 17,
                  "Content": "resource \"google_storage_bucket_iam_binding\" \"allow_public_read\" {",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 18,
                  "Content": "  bucket  = google_storage_bucket.terragoat_website.id",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 19,
                  "Content": "  members = [\"allUsers\"]",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": true,
                  "LastCause": true
                },
                {
                  "Number": 20,
                  "Content": "  role    = \"roles/storage.objectViewer\"",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 21,
                  "Content": "}",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "AVD-GCP-0002",
          "Title": "Ensure that Cloud Storage buckets have uniform bucket-level access enabled",
          "Description": "When you enable uniform bucket-level access on a bucket, Access Control Lists (ACLs) are disabled, and only bucket-level Identity and Access Management (IAM) permissions grant access to that bucket and the objects it contains. You revoke all access granted by object ACLs and the ability to administrate permissions using bucket ACLs.",
          "Message": "Bucket has uniform bucket level access disabled.",
          "Query": "data..",
          "Resolution": "Enable uniform bucket level access to provide a uniform permissioning system.",
          "Severity": "MEDIUM",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-gcp-0002",
          "References": [
            "https://cloud.google.com/storage/docs/uniform-bucket-level-access",
            "https://jbrojbrojbro.medium.com/you-make-the-rules-with-authentication-controls-for-cloud-storage-53c32543747b",
            "https://avd.aquasec.com/misconfig/avd-gcp-0002"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "google_storage_bucket.terragoat_website",
            "Provider": "Google",
            "Service": "storage",
            "StartLine": 1,
            "EndLine": 15,
            "Code": {
              "Lines": [
                {
                  "Number": 1,
                  "Content": "resource \"google_storage_bucket\" \"terragoat_website\" {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 2,
                  "Content": "  name          = \"terragot-${var.environment}\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 3,
                  "Content": "  location      = var.location",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 4,
                  "Content": "  force_destroy = true",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 5,
                  "Content": "  labels = {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 6,
                  "Content": "    git_commit           = \"2bdc0871a5f4505be58244029cc6485d45d7bb8e\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 7,
                  "Content": "    git_file             = \"terraform__gcp__gcs_tf\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 8,
                  "Content": "    git_last_modified_at = \"2022-01-19-17-02-27\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 9,
                  "Content": "    git_last_modified_by = \"jameswoolfenden\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 10,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        }
      ]
    },
    {
      "Target": "terraform/gcp/gke.tf",
      "Class": "config",
      "Type": "terraform",
      "MisconfSummary": {
        "Successes": 4,
        "Failures": 17,
        "Exceptions": 0
      },
      "Misconfigurations": [
        {
          "Type": "Terraform Security Check",
          "ID": "AVD-GCP-0047",
          "Title": "Pod security policy enforcement not defined.",
          "Description": "By default, Pods in Kubernetes can operate with capabilities beyond what they require. You should constrain the Pod's capabilities to only those required for that workload.\n\nKubernetes offers controls for restricting your Pods to execute with only explicitly granted capabilities. \n\nPod Security Policy allows you to set smart defaults for your Pods, and enforce controls you want to enable across your fleet. \n\nThe policies you define should be specific to the needs of your application",
          "Message": "Cluster pod security policy is not enforced.",
          "Query": "data..",
          "Resolution": "Use security policies for pods to restrict permissions to those needed to be effective",
          "Severity": "HIGH",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-gcp-0047",
          "References": [
            "https://cloud.google.com/kubernetes-engine/docs/how-to/hardening-your-cluster#admission_controllers",
            "https://avd.aquasec.com/misconfig/avd-gcp-0047"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "google_container_cluster.workload_cluster",
            "Provider": "Google",
            "Service": "gke",
            "StartLine": 6,
            "EndLine": 22,
            "Code": {
              "Lines": [
                {
                  "Number": 6,
                  "Content": "resource \"google_container_cluster\" \"workload_cluster\" {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 7,
                  "Content": "  name               = \"terragoat-${var.environment}-cluster\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 8,
                  "Content": "  logging_service    = \"none\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 9,
                  "Content": "  location           = var.region",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 10,
                  "Content": "  initial_node_count = 1",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 11,
                  "Content": "",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 12,
                  "Content": "  enable_legacy_abac       = true",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 13,
                  "Content": "  monitoring_service       = \"none\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 14,
                  "Content": "  remove_default_node_pool = true",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 15,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "AVD-GCP-0048",
          "Title": "Legacy metadata endpoints enabled.",
          "Description": "The Compute Engine instance metadata server exposes legacy v0.1 and v1beta1 endpoints, which do not enforce metadata query headers. \n\nThis is a feature in the v1 APIs that makes it more difficult for a potential attacker to retrieve instance metadata. \n\nUnless specifically required, we recommend you disable these legacy APIs.\n\nWhen setting the \u003ccode\u003emetadata\u003c/code\u003e block, the default value for \u003ccode\u003edisable-legacy-endpoints\u003c/code\u003e is set to true, they should not be explicitly enabled.",
          "Message": "Cluster has legacy metadata endpoints enabled.",
          "Query": "data..",
          "Resolution": "Disable legacy metadata endpoints",
          "Severity": "HIGH",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-gcp-0048",
          "References": [
            "https://cloud.google.com/kubernetes-engine/docs/how-to/hardening-your-cluster#protect_node_metadata_default_for_112",
            "https://avd.aquasec.com/misconfig/avd-gcp-0048"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "google_container_node_pool.custom_node_pool",
            "Provider": "Google",
            "Service": "gke",
            "StartLine": 28,
            "EndLine": 30,
            "Code": {
              "Lines": [
                {
                  "Number": 24,
                  "Content": "resource \"google_container_node_pool\" \"custom_node_pool\" {",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 25,
                  "Content": "  cluster  = google_container_cluster.workload_cluster.name",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 26,
                  "Content": "  location = var.region",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 27,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 28,
                  "Content": "  node_config {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 29,
                  "Content": "    image_type = \"Ubuntu\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 30,
                  "Content": "  }",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 31,
                  "Content": "}",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "AVD-GCP-0049",
          "Title": "Clusters should have IP aliasing enabled",
          "Description": "IP aliasing allows the reuse of public IPs internally, removing the need for a NAT gateway.",
          "Message": "Cluster has IP aliasing disabled.",
          "Query": "data..",
          "Resolution": "Enable IP aliasing",
          "Severity": "LOW",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-gcp-0049",
          "References": [
            "https://avd.aquasec.com/misconfig/avd-gcp-0049"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "google_container_cluster.workload_cluster",
            "Provider": "Google",
            "Service": "gke",
            "StartLine": 6,
            "EndLine": 22,
            "Code": {
              "Lines": [
                {
                  "Number": 6,
                  "Content": "resource \"google_container_cluster\" \"workload_cluster\" {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 7,
                  "Content": "  name               = \"terragoat-${var.environment}-cluster\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 8,
                  "Content": "  logging_service    = \"none\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 9,
                  "Content": "  location           = var.region",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 10,
                  "Content": "  initial_node_count = 1",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 11,
                  "Content": "",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 12,
                  "Content": "  enable_legacy_abac       = true",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 13,
                  "Content": "  monitoring_service       = \"none\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 14,
                  "Content": "  remove_default_node_pool = true",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 15,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "AVD-GCP-0050",
          "Title": "Checks for service account defined for GKE nodes",
          "Description": "You should create and use a minimally privileged service account to run your GKE cluster instead of using the Compute Engine default service account.",
          "Message": "Node pool does not override the default service account.",
          "Query": "data..",
          "Resolution": "Use limited permissions for service accounts to be effective",
          "Severity": "MEDIUM",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-gcp-0050",
          "References": [
            "https://cloud.google.com/kubernetes-engine/docs/how-to/hardening-your-cluster#use_least_privilege_sa",
            "https://avd.aquasec.com/misconfig/avd-gcp-0050"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "google_container_node_pool.custom_node_pool",
            "Provider": "Google",
            "Service": "gke",
            "StartLine": 28,
            "EndLine": 30,
            "Code": {
              "Lines": [
                {
                  "Number": 24,
                  "Content": "resource \"google_container_node_pool\" \"custom_node_pool\" {",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 25,
                  "Content": "  cluster  = google_container_cluster.workload_cluster.name",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 26,
                  "Content": "  location = var.region",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 27,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 28,
                  "Content": "  node_config {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 29,
                  "Content": "    image_type = \"Ubuntu\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 30,
                  "Content": "  }",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 31,
                  "Content": "}",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "AVD-GCP-0051",
          "Title": "Clusters should be configured with Labels",
          "Description": "Labels make it easier to manage assets and differentiate between clusters and environments, allowing the mapping of computational resources to the wider organisational structure.",
          "Message": "Cluster does not use GCE resource labels.",
          "Query": "data..",
          "Resolution": "Set cluster resource labels",
          "Severity": "LOW",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-gcp-0051",
          "References": [
            "https://avd.aquasec.com/misconfig/avd-gcp-0051"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "google_container_cluster.workload_cluster",
            "Provider": "Google",
            "Service": "gke",
            "StartLine": 6,
            "EndLine": 22,
            "Code": {
              "Lines": [
                {
                  "Number": 6,
                  "Content": "resource \"google_container_cluster\" \"workload_cluster\" {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 7,
                  "Content": "  name               = \"terragoat-${var.environment}-cluster\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 8,
                  "Content": "  logging_service    = \"none\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 9,
                  "Content": "  location           = var.region",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 10,
                  "Content": "  initial_node_count = 1",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 11,
                  "Content": "",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 12,
                  "Content": "  enable_legacy_abac       = true",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 13,
                  "Content": "  monitoring_service       = \"none\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 14,
                  "Content": "  remove_default_node_pool = true",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 15,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "AVD-GCP-0052",
          "Title": "Stackdriver Monitoring should be enabled",
          "Description": "StackDriver monitoring aggregates logs, events, and metrics from your Kubernetes environment on GKE to help you understand your application's behavior in production.",
          "Message": "Cluster does not use the monitoring.googleapis.com/kubernetes StackDriver monitoring service.",
          "Query": "data..",
          "Resolution": "Enable StackDriver monitoring",
          "Severity": "LOW",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-gcp-0052",
          "References": [
            "https://avd.aquasec.com/misconfig/avd-gcp-0052"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "google_container_cluster.workload_cluster",
            "Provider": "Google",
            "Service": "gke",
            "StartLine": 13,
            "EndLine": 13,
            "Code": {
              "Lines": [
                {
                  "Number": 6,
                  "Content": "resource \"google_container_cluster\" \"workload_cluster\" {",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 7,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 13,
                  "Content": "  monitoring_service       = \"none\"",
                  "IsCause": true,
                  "Annotation": "\"none\"",
                  "Truncated": false,
                  "FirstCause": true,
                  "LastCause": true
                },
                {
                  "Number": 21,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 22,
                  "Content": "}",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "AVD-GCP-0053",
          "Title": "GKE Control Plane should not be publicly accessible",
          "Description": "The GKE control plane is exposed to the public internet by default.",
          "Message": "Cluster exposes control plane to the public internet.",
          "Query": "data..",
          "Resolution": "Use private nodes and master authorised networks to prevent exposure",
          "Severity": "HIGH",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-gcp-0053",
          "References": [
            "https://avd.aquasec.com/misconfig/avd-gcp-0053"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "google_container_cluster.workload_cluster",
            "Provider": "Google",
            "Service": "gke",
            "StartLine": 19,
            "EndLine": 19,
            "Code": {
              "Lines": [
                {
                  "Number": 6,
                  "Content": "resource \"google_container_cluster\" \"workload_cluster\" {",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 7,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 19,
                  "Content": "      cidr_block = \"0.0.0.0/0\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": true,
                  "LastCause": true
                },
                {
                  "Number": 21,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 22,
                  "Content": "}",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "AVD-GCP-0054",
          "Title": "Ensure Container-Optimized OS (cos) is used for Kubernetes Engine Clusters Node image",
          "Description": "GKE supports several OS image types but COS is the recommended OS image to use on cluster nodes for enhanced security",
          "Message": "Cluster is not configuring node pools to use the COS containerd image type by default.",
          "Query": "data..",
          "Resolution": "Use the COS image type",
          "Severity": "LOW",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-gcp-0054",
          "References": [
            "https://avd.aquasec.com/misconfig/avd-gcp-0054"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "google_container_node_pool.custom_node_pool",
            "Provider": "Google",
            "Service": "gke",
            "StartLine": 29,
            "EndLine": 29,
            "Code": {
              "Lines": [
                {
                  "Number": 24,
                  "Content": "resource \"google_container_node_pool\" \"custom_node_pool\" {",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 25,
                  "Content": "  cluster  = google_container_cluster.workload_cluster.name",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 26,
                  "Content": "  location = var.region",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 27,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 28,
                  "Content": "  node_config {",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 29,
                  "Content": "    image_type = \"Ubuntu\"",
                  "IsCause": true,
                  "Annotation": "\"Ubuntu\"",
                  "Truncated": false,
                  "FirstCause": true,
                  "LastCause": true
                },
                {
                  "Number": 30,
                  "Content": "  }",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 31,
                  "Content": "}",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "AVD-GCP-0054",
          "Title": "Ensure Container-Optimized OS (cos) is used for Kubernetes Engine Clusters Node image",
          "Description": "GKE supports several OS image types but COS is the recommended OS image to use on cluster nodes for enhanced security",
          "Message": "Node pool is not using the COS containerd image type.",
          "Query": "data..",
          "Resolution": "Use the COS image type",
          "Severity": "LOW",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-gcp-0054",
          "References": [
            "https://avd.aquasec.com/misconfig/avd-gcp-0054"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "google_container_node_pool.custom_node_pool",
            "Provider": "Google",
            "Service": "gke",
            "StartLine": 29,
            "EndLine": 29,
            "Code": {
              "Lines": [
                {
                  "Number": 24,
                  "Content": "resource \"google_container_node_pool\" \"custom_node_pool\" {",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 25,
                  "Content": "  cluster  = google_container_cluster.workload_cluster.name",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 26,
                  "Content": "  location = var.region",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 27,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 28,
                  "Content": "  node_config {",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 29,
                  "Content": "    image_type = \"Ubuntu\"",
                  "IsCause": true,
                  "Annotation": "\"Ubuntu\"",
                  "Truncated": false,
                  "FirstCause": true,
                  "LastCause": true
                },
                {
                  "Number": 30,
                  "Content": "  }",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 31,
                  "Content": "}",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "AVD-GCP-0056",
          "Title": "Network Policy should be enabled on GKE clusters",
          "Description": "Enabling a network policy allows the segregation of network traffic by namespace",
          "Message": "Cluster does not have a network policy enabled.",
          "Query": "data..",
          "Resolution": "Enable network policy",
          "Severity": "MEDIUM",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-gcp-0056",
          "References": [
            "https://avd.aquasec.com/misconfig/avd-gcp-0056"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "google_container_cluster.workload_cluster",
            "Provider": "Google",
            "Service": "gke",
            "StartLine": 6,
            "EndLine": 22,
            "Code": {
              "Lines": [
                {
                  "Number": 6,
                  "Content": "resource \"google_container_cluster\" \"workload_cluster\" {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 7,
                  "Content": "  name               = \"terragoat-${var.environment}-cluster\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 8,
                  "Content": "  logging_service    = \"none\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 9,
                  "Content": "  location           = var.region",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 10,
                  "Content": "  initial_node_count = 1",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 11,
                  "Content": "",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 12,
                  "Content": "  enable_legacy_abac       = true",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 13,
                  "Content": "  monitoring_service       = \"none\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 14,
                  "Content": "  remove_default_node_pool = true",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 15,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "AVD-GCP-0057",
          "Title": "Node metadata value disables metadata concealment.",
          "Description": "If the \u003ccode\u003eworkload_metadata_config\u003c/code\u003e block within \u003ccode\u003enode_config\u003c/code\u003e is included, the \u003ccode\u003enode_metadata\u003c/code\u003e attribute should be configured securely.\n\nThe attribute should be set to \u003ccode\u003eSECURE\u003c/code\u003e to use metadata concealment, or \u003ccode\u003eGKE_METADATA_SERVER\u003c/code\u003e if workload identity is enabled. This ensures that the VM metadata is not unnecessarily exposed to pods.",
          "Message": "Cluster exposes node metadata of pools by default.",
          "Query": "data..",
          "Resolution": "Set node metadata to SECURE or GKE_METADATA_SERVER",
          "Severity": "HIGH",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-gcp-0057",
          "References": [
            "https://cloud.google.com/kubernetes-engine/docs/how-to/protecting-cluster-metadata#create-concealed",
            "https://avd.aquasec.com/misconfig/avd-gcp-0057"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "google_container_node_pool.custom_node_pool",
            "Provider": "Google",
            "Service": "gke",
            "StartLine": 28,
            "EndLine": 30,
            "Code": {
              "Lines": [
                {
                  "Number": 24,
                  "Content": "resource \"google_container_node_pool\" \"custom_node_pool\" {",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 25,
                  "Content": "  cluster  = google_container_cluster.workload_cluster.name",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 26,
                  "Content": "  location = var.region",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 27,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 28,
                  "Content": "  node_config {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 29,
                  "Content": "    image_type = \"Ubuntu\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 30,
                  "Content": "  }",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 31,
                  "Content": "}",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "AVD-GCP-0057",
          "Title": "Node metadata value disables metadata concealment.",
          "Description": "If the \u003ccode\u003eworkload_metadata_config\u003c/code\u003e block within \u003ccode\u003enode_config\u003c/code\u003e is included, the \u003ccode\u003enode_metadata\u003c/code\u003e attribute should be configured securely.\n\nThe attribute should be set to \u003ccode\u003eSECURE\u003c/code\u003e to use metadata concealment, or \u003ccode\u003eGKE_METADATA_SERVER\u003c/code\u003e if workload identity is enabled. This ensures that the VM metadata is not unnecessarily exposed to pods.",
          "Message": "Node pool exposes node metadata.",
          "Query": "data..",
          "Resolution": "Set node metadata to SECURE or GKE_METADATA_SERVER",
          "Severity": "HIGH",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-gcp-0057",
          "References": [
            "https://cloud.google.com/kubernetes-engine/docs/how-to/protecting-cluster-metadata#create-concealed",
            "https://avd.aquasec.com/misconfig/avd-gcp-0057"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "google_container_node_pool.custom_node_pool",
            "Provider": "Google",
            "Service": "gke",
            "StartLine": 28,
            "EndLine": 30,
            "Code": {
              "Lines": [
                {
                  "Number": 24,
                  "Content": "resource \"google_container_node_pool\" \"custom_node_pool\" {",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 25,
                  "Content": "  cluster  = google_container_cluster.workload_cluster.name",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 26,
                  "Content": "  location = var.region",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 27,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 28,
                  "Content": "  node_config {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 29,
                  "Content": "    image_type = \"Ubuntu\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 30,
                  "Content": "  }",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 31,
                  "Content": "}",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "AVD-GCP-0058",
          "Title": "Kubernetes should have 'Automatic upgrade' enabled",
          "Description": "Automatic updates keep nodes updated with the latest cluster master version.",
          "Message": "Node pool does not have auto-upgraade enabled.",
          "Query": "data..",
          "Resolution": "Enable automatic upgrades",
          "Severity": "LOW",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-gcp-0058",
          "References": [
            "https://avd.aquasec.com/misconfig/avd-gcp-0058"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "google_container_node_pool.custom_node_pool",
            "Provider": "Google",
            "Service": "gke",
            "StartLine": 24,
            "EndLine": 31,
            "Code": {
              "Lines": [
                {
                  "Number": 24,
                  "Content": "resource \"google_container_node_pool\" \"custom_node_pool\" {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 25,
                  "Content": "  cluster  = google_container_cluster.workload_cluster.name",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 26,
                  "Content": "  location = var.region",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 27,
                  "Content": "",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 28,
                  "Content": "  node_config {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 29,
                  "Content": "    image_type = \"Ubuntu\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 30,
                  "Content": "  }",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 31,
                  "Content": "}",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": true
                }
              ]
            }
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "AVD-GCP-0059",
          "Title": "Clusters should be set to private",
          "Description": "Enabling private nodes on a cluster ensures the nodes are only available internally as they will only be assigned internal addresses.",
          "Message": "Cluster does not have private nodes.",
          "Query": "data..",
          "Resolution": "Enable private cluster",
          "Severity": "MEDIUM",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-gcp-0059",
          "References": [
            "https://avd.aquasec.com/misconfig/avd-gcp-0059"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "google_container_cluster.workload_cluster",
            "Provider": "Google",
            "Service": "gke",
            "StartLine": 6,
            "EndLine": 22,
            "Code": {
              "Lines": [
                {
                  "Number": 6,
                  "Content": "resource \"google_container_cluster\" \"workload_cluster\" {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 7,
                  "Content": "  name               = \"terragoat-${var.environment}-cluster\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 8,
                  "Content": "  logging_service    = \"none\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 9,
                  "Content": "  location           = var.region",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 10,
                  "Content": "  initial_node_count = 1",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 11,
                  "Content": "",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 12,
                  "Content": "  enable_legacy_abac       = true",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 13,
                  "Content": "  monitoring_service       = \"none\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 14,
                  "Content": "  remove_default_node_pool = true",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 15,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "AVD-GCP-0060",
          "Title": "Stackdriver Logging should be enabled",
          "Description": "StackDriver logging provides a useful interface to all of stdout/stderr for each container and should be enabled for moitoring, debugging, etc.",
          "Message": "Cluster does not use the logging.googleapis.com/kubernetes StackDriver logging service.",
          "Query": "data..",
          "Resolution": "Enable StackDriver logging",
          "Severity": "LOW",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-gcp-0060",
          "References": [
            "https://avd.aquasec.com/misconfig/avd-gcp-0060"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "google_container_cluster.workload_cluster",
            "Provider": "Google",
            "Service": "gke",
            "StartLine": 8,
            "EndLine": 8,
            "Code": {
              "Lines": [
                {
                  "Number": 6,
                  "Content": "resource \"google_container_cluster\" \"workload_cluster\" {",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 7,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 8,
                  "Content": "  logging_service    = \"none\"",
                  "IsCause": true,
                  "Annotation": "\"none\"",
                  "Truncated": false,
                  "FirstCause": true,
                  "LastCause": true
                },
                {
                  "Number": 21,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 22,
                  "Content": "}",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "AVD-GCP-0062",
          "Title": "Legacy ABAC permissions are enabled.",
          "Description": "You should disable Attribute-Based Access Control (ABAC), and instead use Role-Based Access Control (RBAC) in GKE.\n\nRBAC has significant security advantages and is now stable in Kubernetes, so it’s time to disable ABAC.",
          "Message": "Cluster has legacy ABAC enabled.",
          "Query": "data..",
          "Resolution": "Switch to using RBAC permissions",
          "Severity": "HIGH",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-gcp-0062",
          "References": [
            "https://cloud.google.com/kubernetes-engine/docs/how-to/hardening-your-cluster#leave_abac_disabled_default_for_110",
            "https://avd.aquasec.com/misconfig/avd-gcp-0062"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "google_container_cluster.workload_cluster",
            "Provider": "Google",
            "Service": "gke",
            "StartLine": 12,
            "EndLine": 12,
            "Code": {
              "Lines": [
                {
                  "Number": 6,
                  "Content": "resource \"google_container_cluster\" \"workload_cluster\" {",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 7,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 12,
                  "Content": "  enable_legacy_abac       = true",
                  "IsCause": true,
                  "Annotation": "true",
                  "Truncated": false,
                  "FirstCause": true,
                  "LastCause": true
                },
                {
                  "Number": 21,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 22,
                  "Content": "}",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "AVD-GCP-0063",
          "Title": "Kubernetes should have 'Automatic repair' enabled",
          "Description": "Automatic repair will monitor nodes and attempt repair when a node fails multiple subsequent health checks",
          "Message": "Node pool does not have auto-repair enabled.",
          "Query": "data..",
          "Resolution": "Enable automatic repair",
          "Severity": "LOW",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-gcp-0063",
          "References": [
            "https://avd.aquasec.com/misconfig/avd-gcp-0063"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "google_container_node_pool.custom_node_pool",
            "Provider": "Google",
            "Service": "gke",
            "StartLine": 24,
            "EndLine": 31,
            "Code": {
              "Lines": [
                {
                  "Number": 24,
                  "Content": "resource \"google_container_node_pool\" \"custom_node_pool\" {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 25,
                  "Content": "  cluster  = google_container_cluster.workload_cluster.name",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 26,
                  "Content": "  location = var.region",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 27,
                  "Content": "",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 28,
                  "Content": "  node_config {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 29,
                  "Content": "    image_type = \"Ubuntu\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 30,
                  "Content": "  }",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 31,
                  "Content": "}",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": true
                }
              ]
            }
          }
        }
      ]
    },
    {
      "Target": "terraform/gcp/instances.tf",
      "Class": "config",
      "Type": "terraform",
      "MisconfSummary": {
        "Successes": 1,
        "Failures": 10,
        "Exceptions": 0
      },
      "Misconfigurations": [
        {
          "Type": "Terraform Security Check",
          "ID": "AVD-GCP-0030",
          "Title": "Disable project-wide SSH keys for all instances",
          "Description": "Use of project-wide SSH keys means that a compromise of any one of these key pairs can result in all instances being compromised. It is recommended to use instance-level keys.",
          "Message": "Instance allows use of project-level SSH keys.",
          "Query": "data..",
          "Resolution": "Disable project-wide SSH keys",
          "Severity": "MEDIUM",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-gcp-0030",
          "References": [
            "https://avd.aquasec.com/misconfig/avd-gcp-0030"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "google_compute_instance.server",
            "Provider": "Google",
            "Service": "compute",
            "StartLine": 19,
            "EndLine": 23,
            "Code": {
              "Lines": [
                {
                  "Number": 3,
                  "Content": "resource \"google_compute_instance\" \"server\" {",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 4,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 19,
                  "Content": "  metadata = {",
                  "IsCause": true,
                  "Annotation": "false",
                  "Truncated": false,
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 20,
                  "Content": "    block-project-ssh-keys = false",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 21,
                  "Content": "    enable-oslogin         = false",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 22,
                  "Content": "    serial-port-enable     = true",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 23,
                  "Content": "  }",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 33,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 34,
                  "Content": "}",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "AVD-GCP-0031",
          "Title": "Instances should not have public IP addresses",
          "Description": "Instances should not be publicly exposed to the internet",
          "Message": "Instance has a public IP allocated.",
          "Query": "data..",
          "Resolution": "Remove public IP",
          "Severity": "HIGH",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-gcp-0031",
          "References": [
            "https://cloud.google.com/compute/docs/ip-addresses#externaladdresses",
            "https://avd.aquasec.com/misconfig/avd-gcp-0031"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "google_compute_instance.server",
            "Provider": "Google",
            "Service": "compute",
            "StartLine": 15,
            "EndLine": 15,
            "Code": {
              "Lines": [
                {
                  "Number": 3,
                  "Content": "resource \"google_compute_instance\" \"server\" {",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 4,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 15,
                  "Content": "    access_config {}",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": true,
                  "LastCause": true
                },
                {
                  "Number": 33,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 34,
                  "Content": "}",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "AVD-GCP-0032",
          "Title": "Disable serial port connectivity for all instances",
          "Description": "When serial port access is enabled, the access is not governed by network security rules meaning the port can be exposed publicly.",
          "Message": "Instance has serial port enabled.",
          "Query": "data..",
          "Resolution": "Disable serial port access",
          "Severity": "MEDIUM",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-gcp-0032",
          "References": [
            "https://avd.aquasec.com/misconfig/avd-gcp-0032"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "google_compute_instance.server",
            "Provider": "Google",
            "Service": "compute",
            "StartLine": 19,
            "EndLine": 23,
            "Code": {
              "Lines": [
                {
                  "Number": 3,
                  "Content": "resource \"google_compute_instance\" \"server\" {",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 4,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 19,
                  "Content": "  metadata = {",
                  "IsCause": true,
                  "Annotation": "true",
                  "Truncated": false,
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 20,
                  "Content": "    block-project-ssh-keys = false",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 21,
                  "Content": "    enable-oslogin         = false",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 22,
                  "Content": "    serial-port-enable     = true",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 23,
                  "Content": "  }",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 33,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 34,
                  "Content": "}",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "AVD-GCP-0033",
          "Title": "VM disks should be encrypted with Customer Supplied Encryption Keys",
          "Description": "Using unmanaged keys makes rotation and general management difficult.",
          "Message": "Instance disk encryption does not use a customer managed key.",
          "Query": "data..",
          "Resolution": "Use managed keys ",
          "Severity": "LOW",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-gcp-0033",
          "References": [
            "https://avd.aquasec.com/misconfig/avd-gcp-0033"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "google_compute_instance.server",
            "Provider": "Google",
            "Service": "compute",
            "StartLine": 7,
            "EndLine": 12,
            "Code": {
              "Lines": [
                {
                  "Number": 3,
                  "Content": "resource \"google_compute_instance\" \"server\" {",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 4,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 7,
                  "Content": "  boot_disk {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 8,
                  "Content": "    initialize_params {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 9,
                  "Content": "      image = \"debian-cloud/debian-9\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 10,
                  "Content": "    }",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 11,
                  "Content": "    auto_delete = true",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 12,
                  "Content": "  }",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 33,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 34,
                  "Content": "}",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "AVD-GCP-0034",
          "Title": "Disks should be encrypted with customer managed encryption keys",
          "Description": "Using unmanaged keys makes rotation and general management difficult.",
          "Message": "Disk is not encrypted with a customer managed key.",
          "Query": "data..",
          "Resolution": "Use managed keys to encrypt disks.",
          "Severity": "LOW",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-gcp-0034",
          "References": [
            "https://avd.aquasec.com/misconfig/avd-gcp-0034"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "google_compute_disk.unencrypted_disk",
            "Provider": "Google",
            "Service": "compute",
            "StartLine": 36,
            "EndLine": 48,
            "Code": {
              "Lines": [
                {
                  "Number": 36,
                  "Content": "resource \"google_compute_disk\" \"unencrypted_disk\" {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 37,
                  "Content": "  name = \"terragoat-${var.environment}-disk\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 38,
                  "Content": "  labels = {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 39,
                  "Content": "    git_commit           = \"2bdc0871a5f4505be58244029cc6485d45d7bb8e\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 40,
                  "Content": "    git_file             = \"terraform__gcp__instances_tf\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 41,
                  "Content": "    git_last_modified_at = \"2022-01-19-17-02-27\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 42,
                  "Content": "    git_last_modified_by = \"jameswoolfenden\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 43,
                  "Content": "    git_modifiers        = \"jameswoolfenden__nimrodkor\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 44,
                  "Content": "    git_org              = \"bridgecrewio\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 45,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "AVD-GCP-0036",
          "Title": "Instances should not override the project setting for OS Login",
          "Description": "OS Login automatically revokes the relevant SSH keys when an IAM user has their access revoked.",
          "Message": "Instance has OS Login disabled.",
          "Query": "data..",
          "Resolution": "Enable OS Login at project level and remove instance-level overrides",
          "Severity": "MEDIUM",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-gcp-0036",
          "References": [
            "https://avd.aquasec.com/misconfig/avd-gcp-0036"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "google_compute_instance.server",
            "Provider": "Google",
            "Service": "compute",
            "StartLine": 19,
            "EndLine": 23,
            "Code": {
              "Lines": [
                {
                  "Number": 3,
                  "Content": "resource \"google_compute_instance\" \"server\" {",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 4,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 19,
                  "Content": "  metadata = {",
                  "IsCause": true,
                  "Annotation": "false",
                  "Truncated": false,
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 20,
                  "Content": "    block-project-ssh-keys = false",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 21,
                  "Content": "    enable-oslogin         = false",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 22,
                  "Content": "    serial-port-enable     = true",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 23,
                  "Content": "  }",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 33,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 34,
                  "Content": "}",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "AVD-GCP-0041",
          "Title": "Instances should have Shielded VM VTPM enabled",
          "Description": "The virtual TPM provides numerous security measures to your VM.",
          "Message": "Instance does not have VTPM for shielded VMs enabled.",
          "Query": "data..",
          "Resolution": "Enable Shielded VM VTPM",
          "Severity": "MEDIUM",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-gcp-0041",
          "References": [
            "https://cloud.google.com/blog/products/identity-security/virtual-trusted-platform-module-for-shielded-vms-security-in-plaintext",
            "https://avd.aquasec.com/misconfig/avd-gcp-0041"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "google_compute_instance.server",
            "Provider": "Google",
            "Service": "compute",
            "StartLine": 3,
            "EndLine": 34,
            "Code": {
              "Lines": [
                {
                  "Number": 3,
                  "Content": "resource \"google_compute_instance\" \"server\" {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 4,
                  "Content": "  machine_type = \"n1-standard-1\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 5,
                  "Content": "  name         = \"terragoat-${var.environment}-machine\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 6,
                  "Content": "  zone         = data.google_compute_zones.zones.names[0]",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 7,
                  "Content": "  boot_disk {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 8,
                  "Content": "    initialize_params {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 9,
                  "Content": "      image = \"debian-cloud/debian-9\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 10,
                  "Content": "    }",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 11,
                  "Content": "    auto_delete = true",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 12,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "AVD-GCP-0043",
          "Title": "Instances should not have IP forwarding enabled",
          "Description": "Disabling IP forwarding ensures the instance can only receive packets addressed to the instance and can only send packets with a source address of the instance.",
          "Message": "Instance has IP forwarding allowed.",
          "Query": "data..",
          "Resolution": "Disable IP forwarding",
          "Severity": "HIGH",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-gcp-0043",
          "References": [
            "https://avd.aquasec.com/misconfig/avd-gcp-0043"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "google_compute_instance.server",
            "Provider": "Google",
            "Service": "compute",
            "StartLine": 17,
            "EndLine": 17,
            "Code": {
              "Lines": [
                {
                  "Number": 3,
                  "Content": "resource \"google_compute_instance\" \"server\" {",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 4,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 17,
                  "Content": "  can_ip_forward = true",
                  "IsCause": true,
                  "Annotation": "true",
                  "Truncated": false,
                  "FirstCause": true,
                  "LastCause": true
                },
                {
                  "Number": 33,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 34,
                  "Content": "}",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "AVD-GCP-0044",
          "Title": "Instances should not use the default service account",
          "Description": "The default service account has full project access. Instances should instead be assigned the minimal access they need.",
          "Message": "Instance uses the default service account.",
          "Query": "data..",
          "Resolution": "Remove use of default service account",
          "Severity": "CRITICAL",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-gcp-0044",
          "References": [
            "https://avd.aquasec.com/misconfig/avd-gcp-0044"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "google_compute_instance.server",
            "Provider": "Google",
            "Service": "compute",
            "StartLine": 3,
            "EndLine": 34,
            "Code": {
              "Lines": [
                {
                  "Number": 3,
                  "Content": "resource \"google_compute_instance\" \"server\" {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 4,
                  "Content": "  machine_type = \"n1-standard-1\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 5,
                  "Content": "  name         = \"terragoat-${var.environment}-machine\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 6,
                  "Content": "  zone         = data.google_compute_zones.zones.names[0]",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 7,
                  "Content": "  boot_disk {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 8,
                  "Content": "    initialize_params {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 9,
                  "Content": "      image = \"debian-cloud/debian-9\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 10,
                  "Content": "    }",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 11,
                  "Content": "    auto_delete = true",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 12,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "AVD-GCP-0045",
          "Title": "Instances should have Shielded VM integrity monitoring enabled",
          "Description": "Integrity monitoring helps you understand and make decisions about the state of your VM instances.",
          "Message": "Instance does not have shielded VM integrity monitoring enabled.",
          "Query": "data..",
          "Resolution": "Enable Shielded VM Integrity Monitoring",
          "Severity": "MEDIUM",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-gcp-0045",
          "References": [
            "https://cloud.google.com/security/shielded-cloud/shielded-vm#integrity-monitoring",
            "https://avd.aquasec.com/misconfig/avd-gcp-0045"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "google_compute_instance.server",
            "Provider": "Google",
            "Service": "compute",
            "StartLine": 3,
            "EndLine": 34,
            "Code": {
              "Lines": [
                {
                  "Number": 3,
                  "Content": "resource \"google_compute_instance\" \"server\" {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 4,
                  "Content": "  machine_type = \"n1-standard-1\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 5,
                  "Content": "  name         = \"terragoat-${var.environment}-machine\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 6,
                  "Content": "  zone         = data.google_compute_zones.zones.names[0]",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 7,
                  "Content": "  boot_disk {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 8,
                  "Content": "    initialize_params {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 9,
                  "Content": "      image = \"debian-cloud/debian-9\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 10,
                  "Content": "    }",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 11,
                  "Content": "    auto_delete = true",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 12,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        }
      ]
    },
    {
      "Target": "terraform/gcp/networks.tf",
      "Class": "config",
      "Type": "terraform",
      "MisconfSummary": {
        "Successes": 0,
        "Failures": 2,
        "Exceptions": 0
      },
      "Misconfigurations": [
        {
          "Type": "Terraform Security Check",
          "ID": "AVD-GCP-0027",
          "Title": "An inbound firewall rule allows traffic from /0.",
          "Description": "Network security rules should not use very broad subnets.\n\nWhere possible, segments should be broken into smaller subnets and avoid using the \u003ccode\u003e/0\u003c/code\u003e subnet.",
          "Message": "Firewall rule allows ingress traffic from multiple addresses on the public internet.",
          "Query": "data..",
          "Resolution": "Set a more restrictive cidr range",
          "Severity": "CRITICAL",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-gcp-0027",
          "References": [
            "https://cloud.google.com/vpc/docs/using-firewalls",
            "https://avd.aquasec.com/misconfig/avd-gcp-0027"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "google_compute_firewall.allow_all",
            "Provider": "Google",
            "Service": "compute",
            "StartLine": 22,
            "EndLine": 22,
            "Code": {
              "Lines": [
                {
                  "Number": 19,
                  "Content": "resource \"google_compute_firewall\" \"allow_all\" {",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 20,
                  "Content": "  name          = \"terragoat-${var.environment}-firewall\"",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 21,
                  "Content": "  network       = google_compute_network.vpc.id",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 22,
                  "Content": "  source_ranges = [\"0.0.0.0/0\"]",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": true,
                  "LastCause": true
                },
                {
                  "Number": 23,
                  "Content": "  allow {",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 24,
                  "Content": "    protocol = \"tcp\"",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 25,
                  "Content": "    ports    = [\"0-65535\"]",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 26,
                  "Content": "  }",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 27,
                  "Content": "}",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "AVD-GCP-0029",
          "Title": "VPC flow logs should be enabled for all subnetworks",
          "Description": "VPC flow logs record information about all traffic, which is a vital tool in reviewing anomalous traffic.",
          "Message": "Subnetwork does not have VPC flow logs enabled.",
          "Query": "data..",
          "Resolution": "Enable VPC flow logs",
          "Severity": "LOW",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-gcp-0029",
          "References": [
            "https://avd.aquasec.com/misconfig/avd-gcp-0029"
          ],
          "Status": "FAIL",
          "Layer": {},
          "CauseMetadata": {
            "Resource": "google_compute_subnetwork.public-subnetwork",
            "Provider": "Google",
            "Service": "compute",
            "StartLine": 7,
            "EndLine": 17,
            "Code": {
              "Lines": [
                {
                  "Number": 7,
                  "Content": "resource \"google_compute_subnetwork\" \"public-subnetwork\" {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 8,
                  "Content": "  name          = \"terragoat-${var.environment}-public-subnetwork\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 9,
                  "Content": "  ip_cidr_range = \"10.0.0.0/24\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 10,
                  "Content": "  region        = var.region",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 11,
                  "Content": "  network       = google_compute_network.vpc.id",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 12,
                  "Content": "",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 13,
                  "Content": "  secondary_ip_range {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 14,
                  "Content": "    range_name    = \"tf-test-secondary-range-update1\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 15,
                  "Content": "    ip_cidr_range = \"192.168.10.0/24\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 16,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        }
      ]
    }
  ]
}
